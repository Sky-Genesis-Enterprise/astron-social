import{j as e}from"./client-wT6vtYO_.js";import{u as D,r as i,d as R}from"./index-BdTwX--g.js";import{H as U}from"./Helmet-ZVWnGmbg.js";import{a as b,u as B,o as G,bg as I,bH as z,bJ as K,A as W,ae as Y,cF as $,bX as J,dK as X,cG as Q,cY as S,dL as V}from"./useSelectableClick-DeaJbL2_.js";import{S as Z}from"./group-Xgbn5g1L.js";import{C as ee}from"./column-B4vwzadM.js";import{C as se}from"./column_header-FN7GyEAs.js";import{L as te}from"./load_more-qGthrhsi.js";import{L as ae}from"./loading_indicator-7xMB1U6D.js";import{R as v}from"./radio_button-BeENtbrA.js";import{S as oe}from"./scroll_container-Bq73vRM7.js";import{u as F}from"./useSearchParam-CCVsk9qx.js";import{c as le}from"./index-DizoKcfL.js";import{L as re,S as C}from"./short_number-WomMu2iV.js";import{B as p}from"./index-BZWHsOPk.js";import{ak as ie,D as ce}from"./content_warning-DZ8mar1O.js";import{l as w,e as ne}from"./initial_state-BP3UcUr4.js";import{M as y}from"./message-UFwkQlnu.js";import"./api-B2m7efUy.js";import"./index-lj9VQs0f.js";import"./ready-DpOgoWSg.js";import"./index-CAH5FfLP.js";import"./load_locale-tOpKhmcM.js";import"./scroll-BygYx8ga.js";import"./add-D8GR9P00.js";import"./chevron_left-CnYIoVsW.js";import"./close-BsPe8EbX.js";import"./react-router-scroll-4.es-CU7ja20b.js";import"./interopRequireDefault-CdiRfGvq.js";import"./numbers-CGZQWBYL.js";import"./skeleton-D9NbTYr9.js";const f=R({unfollow:{id:"account.unfollow",defaultMessage:"Unfollow"},follow:{id:"account.follow",defaultMessage:"Follow"},cancel_follow_request:{id:"account.cancel_follow_request",defaultMessage:"Withdraw follow request"},requested:{id:"account.requested",defaultMessage:"Awaiting approval. Click to cancel follow request"},unblock:{id:"account.unblock_short",defaultMessage:"Unblock"},unmute:{id:"account.unmute_short",defaultMessage:"Unmute"},edit_profile:{id:"account.edit_profile",defaultMessage:"Edit profile"}}),de=ie(),ue=({accountId:r})=>{var c;const n=D(),s=b(t=>de(t,r)),o=B(),l=i.useCallback(({currentTarget:t})=>{if(w)return;t.querySelectorAll(".custom-emoji").forEach(m=>{const u=m.getAttribute("data-original");u&&(m.src=u)})},[]),_=i.useCallback(({currentTarget:t})=>{if(w)return;t.querySelectorAll(".custom-emoji").forEach(m=>{const u=m.getAttribute("data-static");u&&(m.src=u)})},[]),x=i.useCallback(()=>{s&&(s.getIn(["relationship","following"])||s.getIn(["relationship","requested"])?o(G({modalType:"CONFIRM_UNFOLLOW",modalProps:{account:s}})):o(I(s.get("id"))))},[s,o]),j=i.useCallback(()=>{var t;(t=s==null?void 0:s.relationship)!=null&&t.blocking&&o(z(s.get("id")))},[s,o]),M=i.useCallback(()=>{var t;(t=s==null?void 0:s.relationship)!=null&&t.muting&&o(K(s.get("id")))},[s,o]),h=i.useCallback(()=>{window.open("/settings/profile","_blank")},[]);if(!s)return null;let d;return ne!==s.get("id")?s.get("relationship")?s.getIn(["relationship","requested"])?d=e.jsx(p,{text:n.formatMessage(f.cancel_follow_request),title:n.formatMessage(f.requested),onClick:x}):s.getIn(["relationship","muting"])?d=e.jsx(p,{text:n.formatMessage(f.unmute),onClick:M}):s.getIn(["relationship","blocking"])?s.getIn(["relationship","blocking"])&&(d=e.jsx(p,{text:n.formatMessage(f.unblock),onClick:j})):d=e.jsx(p,{disabled:(c=s.relationship)==null?void 0:c.blocked_by,className:le({"button--destructive":s.getIn(["relationship","following"])}),text:n.formatMessage(s.getIn(["relationship","following"])?f.unfollow:f.follow),onClick:x}):d="":d=e.jsx(p,{text:n.formatMessage(f.edit_profile),onClick:h}),e.jsxs("div",{className:"account-card",children:[e.jsxs(re,{to:`/@${s.get("acct")}`,className:"account-card__permalink",children:[e.jsx("div",{className:"account-card__header",children:e.jsx("img",{src:w?s.get("header"):s.get("header_static"),alt:""})}),e.jsxs("div",{className:"account-card__title",children:[e.jsx("div",{className:"account-card__title__avatar",children:e.jsx(W,{account:s,size:56})}),e.jsx(ce,{account:s})]})]}),s.get("note").length>0&&e.jsx("div",{className:"account-card__bio translate",onMouseEnter:l,onMouseLeave:_,dangerouslySetInnerHTML:{__html:s.get("note_emojified")}}),e.jsxs("div",{className:"account-card__actions",children:[e.jsxs("div",{className:"account-card__counters",children:[e.jsxs("div",{className:"account-card__counters__item",children:[e.jsx(C,{value:s.get("statuses_count")}),e.jsx("small",{children:e.jsx(y,{id:"account.posts",defaultMessage:"Posts"})})]}),e.jsxs("div",{className:"account-card__counters__item",children:[e.jsx(C,{value:s.get("followers_count")})," ",e.jsx("small",{children:e.jsx(y,{id:"account.followers",defaultMessage:"Followers"})})]}),e.jsxs("div",{className:"account-card__counters__item",children:[e.jsx(C,{value:s.get("following_count")})," ",e.jsx("small",{children:e.jsx(y,{id:"account.following",defaultMessage:"Following"})})]})]}),e.jsx("div",{className:"account-card__actions__button",children:d})]})]})},g=R({title:{id:"column.directory",defaultMessage:"Browse profiles"},recentlyActive:{id:"directory.recently_active",defaultMessage:"Recently active"},newArrivals:{id:"directory.new_arrivals",defaultMessage:"New arrivals"},local:{id:"directory.local",defaultMessage:"From {domain} only"},federated:{id:"directory.federated",defaultMessage:"From known fediverse"}}),Ie=({columnId:r,multiColumn:n,params:s})=>{const o=D(),l=B(),_=i.useRef(null),[x,j]=F("order"),[M,h]=F("local");let d;M==="false"&&(d=!1);const c=x??(s==null?void 0:s.order)??"active",t=d??(s==null?void 0:s.local)??!0,k=i.useCallback(()=>{l(r?Y(r):$("DIRECTORY",{order:c,local:t}))},[l,r,c,t]),m=b(a=>a.meta.get("domain")),u=b(a=>a.user_lists.getIn(["directory","items"],J())),N=b(a=>a.user_lists.getIn(["directory","isLoading"],!0));i.useEffect(()=>{l(X({order:c,local:t}))},[l,c,t]);const H=i.useCallback(a=>{l(Q(r,a))},[l,r]),O=i.useCallback(()=>{var a;(a=_.current)==null||a.scrollTop()},[]),A=i.useCallback(a=>{r?l(S(r,["order"],a.target.value)):j(a.target.value)},[l,r,j]),L=i.useCallback(a=>{r?l(S(r,["local"],a.target.value==="1")):a.target.value==="1"?h("true"):h("false")},[l,r,h]),T=i.useCallback(()=>{l(V({order:c,local:t}))},[l,c,t]),P=!!r,q=N&&u.size===0,E=e.jsxs("div",{className:"scrollable",children:[e.jsxs("div",{className:"filter-form",children:[e.jsxs("div",{className:"filter-form__column",role:"group",children:[e.jsx(v,{name:"order",value:"active",label:o.formatMessage(g.recentlyActive),checked:c==="active",onChange:A}),e.jsx(v,{name:"order",value:"new",label:o.formatMessage(g.newArrivals),checked:c==="new",onChange:A})]}),e.jsxs("div",{className:"filter-form__column",role:"group",children:[e.jsx(v,{name:"local",value:"1",label:o.formatMessage(g.local,{domain:m}),checked:t,onChange:L}),e.jsx(v,{name:"local",value:"0",label:o.formatMessage(g.federated),checked:!t,onChange:L})]})]}),e.jsx("div",{className:"directory__list",children:q?e.jsx(ae,{}):u.map(a=>e.jsx(ue,{accountId:a},a))}),e.jsx(te,{onClick:T,visible:!q,loading:N})]});return e.jsxs(ee,{bindToDocument:!n,ref:_,label:o.formatMessage(g.title),children:[e.jsx(se,{icon:"address-book-o",iconComponent:Z,title:o.formatMessage(g.title),onPin:k,onMove:H,onClick:O,pinned:P,multiColumn:n}),n&&!P?e.jsx(oe,{scrollKey:"directory",children:E}):E,e.jsxs(U,{children:[e.jsx("title",{children:o.formatMessage(g.title)}),e.jsx("meta",{name:"robots",content:"noindex"})]})]})};export{Ie as Directory,Ie as default};
//# sourceMappingURL=directory-index-JlYBw_gY.js.map
