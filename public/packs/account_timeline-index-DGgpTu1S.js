var q=Object.defineProperty;var K=(o,r,t)=>r in o?q(o,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[r]=t;var M=(o,r,t)=>K(o,typeof r!="symbol"?r+"":r,t);import{j as s}from"./client-wT6vtYO_.js";import{P as n}from"./short_number-WomMu2iV.js";import{r as l,u as O,d as Q}from"./index-BdTwX--g.js";import{u as W,dc as R,a as X,bX as N,g as G,I as J,b as P,aQ as V,i as B,j as Y,dd as Z,y as ee,z as te,f as se,de as S,aF as oe,df as T,aE as E}from"./useSelectableClick-DeaJbL2_.js";import{B as ie}from"./bundle_column_error-Cn2E6aKL.js";import{e as h}from"./initial_state-BP3UcUr4.js";import{g as re}from"./content_warning-DZ8mar1O.js";import{C as ae,A as ne,L as ce}from"./limited_account_hint-Dq-fgEQD.js";import{L as le}from"./loading_indicator-7xMB1U6D.js";import{S as de}from"./status_list-DPL_DhlK.js";import{C as z}from"./column-Cq3LGCyF.js";import{R as H}from"./remote_hint-C4PyUXsc.js";import{u as ue}from"./use-gesture-react.esm-PiBFdzIE.js";import{a as pe}from"./status_quoted-COu-QToA.js";import{S as me}from"./chevron_left-CnYIoVsW.js";import{S as fe}from"./push_pin-7dJeX9Rz.js";import{M as j}from"./message-UFwkQlnu.js";import"./numbers-CGZQWBYL.js";import"./api-B2m7efUy.js";import"./index-lj9VQs0f.js";import"./ready-DpOgoWSg.js";import"./index-CAH5FfLP.js";import"./load_locale-tOpKhmcM.js";import"./index-DizoKcfL.js";import"./Helmet-ZVWnGmbg.js";import"./index-BZWHsOPk.js";import"./column-B4vwzadM.js";import"./scroll-BygYx8ga.js";import"./gif-BtN1axMk.js";import"./skeleton-D9NbTYr9.js";import"./column_header-FN7GyEAs.js";import"./add-D8GR9P00.js";import"./close-BsPe8EbX.js";import"./notifications-CKA6ESoP.js";import"./notifications_active-fill-Bd5B72X1.js";import"./domain_blocks-CYnp0hav.js";import"./reports-DBOcsYZF.js";import"./group-Xgbn5g1L.js";import"./person-DcoiY4fW.js";import"./content_copy-CD6CbhEl.js";import"./counters-BJ0cOeaq.js";import"./follow_button-BdqDKUmA.js";import"./formatted_date-jZOhBAMt.js";import"./react-textarea-autosize.browser.esm-GiEI5riT.js";import"./use-isomorphic-layout-effect.browser.esm-D-sFEUJ5.js";import"./permissions-Djze7cmB.js";import"./avatar_group-PUipFlog.js";import"./avatar_overlay-BeG39OK4.js";import"./info-HtHaDKcq.js";import"./verified_badge-CtK79Pb7.js";import"./load_gap-6rwcZCuh.js";import"./scrollable_list-lNykmhKA.js";import"./scroll_container-Bq73vRM7.js";import"./react-router-scroll-4.es-CU7ja20b.js";import"./interopRequireDefault-CdiRfGvq.js";import"./schedule_idle_task-Co3Ydhdu.js";import"./load_more-qGthrhsi.js";import"./timeline_hint-0fHjsenK.js";import"./status-CiF0hsk4.js";import"./index.es-B0ZBMj49.js";import"./card-CttmBekj.js";import"./toString-Cy1Ecq9L.js";import"./status_content-CaIN8-0B.js";import"./poll-CjurB963.js";import"./visibility_icon-DbVVvHFb.js";import"./index-OwtqmxAM.js";function he(o){const r=l.useRef();return l.useEffect(()=>{r.current=o},[o]),r.current}const L=Q({previous:{id:"featured_carousel.previous",defaultMessage:"Previous"},next:{id:"featured_carousel.next",defaultMessage:"Next"},slide:{id:"featured_carousel.slide",defaultMessage:"{index} of {total}"}}),ge=({accountId:o,tagged:r})=>{var $;const t=O(),i=l.useId(),a=W();l.useEffect(()=>{o&&a(R(o,{tagged:r}))},[o,a,r]);const e=X(u=>u.timelines.getIn([`account:${o}:pinned${r?`:${r}`:""}`,"items"],N())),[c,p]=l.useState(0),I=l.useRef(null),d=l.useCallback(u=>{p(b=>{var w;const A=e.size-1;let x=b+u;x<0?x=A:x>A&&(x=0);const k=(w=I.current)==null?void 0:w.children[x];return k&&v(k.scrollHeight),x})},[e.size]),[f,v]=l.useState((($=I.current)==null?void 0:$.scrollHeight)??0),C=he(f),y=l.useRef(new ResizeObserver(()=>{d(0)})),m=G({x:`-${c*100}%`,height:f,immediate:!C});l.useLayoutEffect(()=>{f===0&&d(0)},[f,d]);const g=ue(({swipe:[u]})=>{d(u*-1)}),D=l.useCallback(()=>{d(-1)},[d]),U=l.useCallback(()=>{d(1)},[d]);return!o||e.isEmpty()?null:s.jsxs("div",{className:"featured-carousel",...g(),"aria-roledescription":"carousel","aria-labelledby":`${i}-title`,role:"region",children:[s.jsxs("div",{className:"featured-carousel__header",children:[s.jsxs("h4",{className:"featured-carousel__title",id:`${i}-title`,children:[s.jsx(J,{id:"thumb-tack",icon:fe}),s.jsx(j,{id:"featured_carousel.header",defaultMessage:"{count, plural, one {Pinned Post} other {Pinned Posts}}",values:{count:e.size}})]}),e.size>1&&s.jsxs(s.Fragment,{children:[s.jsx(P,{title:t.formatMessage(L.previous),icon:"chevron-left",iconComponent:me,onClick:D}),s.jsxs("span",{"aria-live":"polite",children:[s.jsx(j,{id:"featured_carousel.post",defaultMessage:"Post",children:u=>s.jsx("span",{className:"sr-only",children:u})}),c+1," / ",e.size]}),s.jsx(P,{title:t.formatMessage(L.next),icon:"chevron-right",iconComponent:V,onClick:U})]})]}),s.jsx(B.div,{className:"featured-carousel__slides",ref:I,style:m,"aria-atomic":"false","aria-live":"polite",children:e.map((u,b)=>s.jsx(xe,{"data-index":b,"aria-label":t.formatMessage(L.slide,{index:b+1,total:e.size}),statusId:u,observer:y.current,active:b===c},`f-${u}`))})]})},xe=({statusId:o,active:r,observer:t,...i})=>{const a=l.useCallback(e=>{e&&t.observe(e)},[t]);return s.jsx(B.div,{className:"featured-carousel__slide",inert:r?void 0:"true","aria-roledescription":"slide",role:"group",ref:a,...i,children:s.jsx(pe,{id:o,contextType:"account",withCounters:!0})})},_=N(),Ie=(o,{params:{acct:r,id:t,tagged:i},withReplies:a=!1})=>{const e=t||o.accounts_map[Z(r)];if(e===null)return{isLoading:!1,isAccount:!1,statusIds:_};if(!e)return{isLoading:!0,statusIds:_};const c=a?`${e}:with_replies`:`${e}${i?`:${i}`:""}`;return{accountId:e,isAccount:!!o.getIn(["accounts",e]),statusIds:o.getIn(["timelines",`account:${c}`,"items"],_),isLoading:o.getIn(["timelines",`account:${c}`,"isLoading"]),hasMore:o.getIn(["timelines",`account:${c}`,"hasMore"]),suspended:o.getIn(["accounts",e,"suspended"],!1),hidden:re(o,e),blockedBy:o.getIn(["relationships",e,"blocked_by"],!1)}};class F extends ee{constructor(){super(...arguments);M(this,"handleLoadMore",t=>{this.props.dispatch(S(this.props.accountId,{maxId:t,withReplies:this.props.withReplies,tagged:this.props.params.tagged}))})}_load(){const{accountId:t,withReplies:i,params:{tagged:a},dispatch:e}=this.props;e(se(t)),i||e(R(t,{tagged:a})),e(S(t,{withReplies:i,tagged:a})),t===h&&e(oe(`account:${h}`))}componentDidMount(){const{params:{acct:t},accountId:i,dispatch:a}=this.props;i?this._load():a(T(t))}componentDidUpdate(t){const{params:{acct:i,tagged:a},accountId:e,withReplies:c,dispatch:p}=this.props;t.accountId!==e&&e?this._load():t.params.acct!==i?p(T(i)):t.params.tagged!==a&&(c||p(R(e,{tagged:a})),p(S(e,{withReplies:c,tagged:a}))),t.accountId===h&&e!==h&&p(E({timeline:`account:${h}`}))}componentWillUnmount(){const{dispatch:t,accountId:i}=this.props;i===h&&t(E({timeline:`account:${h}`}))}render(){const{accountId:t,statusIds:i,isLoading:a,hasMore:e,blockedBy:c,suspended:p,isAccount:I,hidden:d,multiColumn:f,remote:v,remoteUrl:C,params:{tagged:y}}=this.props;if(a&&i.isEmpty())return s.jsx(z,{children:s.jsx(le,{})});if(!a&&!I)return s.jsx(ie,{multiColumn:f,errorType:"routing"});let m;const g=p||c||d;return p?m=s.jsx(j,{id:"empty_column.account_suspended",defaultMessage:"Account suspended"}):d?m=s.jsx(ce,{accountId:t}):c?m=s.jsx(j,{id:"empty_column.account_unavailable",defaultMessage:"Profile unavailable"}):v&&i.isEmpty()?m=s.jsx(H,{accountId:t,url:C}):m=s.jsx(j,{id:"empty_column.account_timeline",defaultMessage:"No posts found"}),s.jsxs(z,{children:[s.jsx(ae,{}),s.jsx(de,{prepend:s.jsxs(s.Fragment,{children:[s.jsx(ne,{accountId:this.props.accountId,hideTabs:g,tagged:y}),!g&&s.jsx(ge,{accountId:this.props.accountId,tagged:y})]}),alwaysPrepend:!0,append:s.jsx(H,{accountId:t}),scrollKey:"account_timeline",statusIds:g?_:i,isLoading:a,hasMore:!g&&e,onLoadMore:this.handleLoadMore,emptyMessage:m,bindToDocument:!f,timelineId:"account",withCounters:!0})]})}}M(F,"propTypes",{params:n.shape({acct:n.string,id:n.string,tagged:n.string}).isRequired,accountId:n.string,dispatch:n.func.isRequired,statusIds:te.list,isLoading:n.bool,hasMore:n.bool,withReplies:n.bool,blockedBy:n.bool,isAccount:n.bool,suspended:n.bool,hidden:n.bool,multiColumn:n.bool});const wt=Y(Ie)(F);export{wt as default};
//# sourceMappingURL=account_timeline-index-DGgpTu1S.js.map
