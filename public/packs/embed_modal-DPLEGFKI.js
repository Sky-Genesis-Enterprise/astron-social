import{j as e}from"./client-wT6vtYO_.js";import{r as t}from"./index-BdTwX--g.js";import{I as g,u as j,a9 as y}from"./useSelectableClick-DeaJbL2_.js";import{a as C}from"./api-B2m7efUy.js";import{B as b}from"./index-BZWHsOPk.js";import{c as w}from"./index-DizoKcfL.js";import{S as _}from"./content_copy-CD6CbhEl.js";import{u as k}from"./useTimeout-F7jeHEBA.js";import{M as l}from"./message-UFwkQlnu.js";import"./short_number-WomMu2iV.js";import"./numbers-CGZQWBYL.js";import"./index-CAH5FfLP.js";import"./ready-DpOgoWSg.js";import"./initial_state-BP3UcUr4.js";import"./load_locale-tOpKhmcM.js";import"./index-lj9VQs0f.js";const M=({value:o})=>{const a=t.useRef(null),[i,s]=t.useState(!1),[u,n]=t.useState(!1),[c]=k(),d=t.useCallback(()=>{s(!1),a.current&&(a.current.focus(),a.current.select(),a.current.setSelectionRange(0,o.length))},[s,o]),m=t.useCallback(x=>{var h;x.stopPropagation(),navigator.clipboard.writeText(o),(h=a.current)==null||h.blur(),s(!0),c(()=>{s(!1)},700)},[s,c,o]),r=t.useCallback(x=>{x.key===" "&&(navigator.clipboard.writeText(o),s(!0),c(()=>{s(!1)},700))},[s,c,o]),p=t.useCallback(()=>{n(!0)},[n]),f=t.useCallback(()=>{n(!1)},[n]);return e.jsxs("div",{className:w("copy-paste-text",{copied:i,focused:u}),tabIndex:0,role:"button",onClick:d,onKeyUp:r,children:[e.jsx("textarea",{readOnly:!0,value:o,ref:a,onClick:d,onFocus:p,onBlur:f}),e.jsxs("button",{className:"button",onClick:m,children:[e.jsx(g,{id:"copy",icon:_})," ",i?e.jsx(l,{id:"copypaste.copied",defaultMessage:"Copied"}):e.jsx(l,{id:"copypaste.copy_to_clipboard",defaultMessage:"Copy to clipboard"})]})]})},U=({id:o,onClose:a})=>{const i=t.useRef(null),s=t.useRef(),[u,n]=t.useState(null),c=j();return t.useEffect(()=>{C().get(`/api/web/embeds/${o}`).then(d=>{var p,f;const m=d.data;n(m);const r=(f=(p=i.current)==null?void 0:p.contentWindow)==null?void 0:f.document;return r&&(r.open(),r.write(m.html),r.close(),r.body.style.margin="0px",s.current=setInterval(()=>window.requestAnimationFrame(()=>{i.current&&(i.current.width=`${r.body.scrollWidth}px`,i.current.height=`${r.body.scrollHeight}px`)}),100)),""}).catch(d=>{c(y(d))})},[c,o,n]),t.useEffect(()=>()=>{s.current&&clearInterval(s.current)},[]),e.jsxs("div",{className:"modal-root__modal dialog-modal",children:[e.jsxs("div",{className:"dialog-modal__header",children:[e.jsx(b,{onClick:a,children:e.jsx(l,{id:"report.close",defaultMessage:"Done"})}),e.jsx("span",{className:"dialog-modal__header__title",children:e.jsx(l,{id:"status.embed",defaultMessage:"Get embed code"})}),e.jsx(b,{secondary:!0,onClick:a,children:e.jsx(l,{id:"confirmation_modal.cancel",defaultMessage:"Cancel"})})]}),e.jsx("div",{className:"dialog-modal__content",children:e.jsxs("div",{className:"dialog-modal__content__form",children:[e.jsx(l,{id:"embed.instructions",defaultMessage:"Embed this status on your website by copying the code below."}),e.jsx(M,{value:(u==null?void 0:u.html)??""}),e.jsx(l,{id:"embed.preview",defaultMessage:"Here is what it will look like:"}),e.jsx("iframe",{frameBorder:"0",ref:i,sandbox:"allow-scripts allow-same-origin",title:"Preview"})]})})]})};export{U as default};
//# sourceMappingURL=embed_modal-DPLEGFKI.js.map
