{"version":3,"file":"account_featured-index-BD5nOZY3.js","sources":["../../app/javascript/mastodon/features/account_featured/components/empty_message.tsx","../../app/javascript/mastodon/features/account_featured/components/featured_tag.tsx","../../app/javascript/mastodon/features/account_featured/index.tsx"],"sourcesContent":["import { FormattedMessage } from 'react-intl';\n\nimport { useParams } from 'react-router';\n\nimport { LimitedAccountHint } from 'mastodon/features/account_timeline/components/limited_account_hint';\nimport { me } from 'mastodon/initial_state';\n\ninterface EmptyMessageProps {\n  suspended: boolean;\n  hidden: boolean;\n  blockedBy: boolean;\n  accountId?: string;\n}\n\nexport const EmptyMessage: React.FC<EmptyMessageProps> = ({\n  accountId,\n  suspended,\n  hidden,\n  blockedBy,\n}) => {\n  const { acct } = useParams<{ acct?: string }>();\n  if (!accountId) {\n    return null;\n  }\n\n  let message: React.ReactNode = null;\n\n  if (me === accountId) {\n    message = (\n      <FormattedMessage\n        id='empty_column.account_featured.me'\n        defaultMessage='You have not featured anything yet. Did you know that you can feature your hashtags you use the most, and even your friend’s accounts on your profile?'\n      />\n    );\n  } else if (suspended) {\n    message = (\n      <FormattedMessage\n        id='empty_column.account_suspended'\n        defaultMessage='Account suspended'\n      />\n    );\n  } else if (hidden) {\n    message = <LimitedAccountHint accountId={accountId} />;\n  } else if (blockedBy) {\n    message = (\n      <FormattedMessage\n        id='empty_column.account_unavailable'\n        defaultMessage='Profile unavailable'\n      />\n    );\n  } else if (acct) {\n    message = (\n      <FormattedMessage\n        id='empty_column.account_featured.other'\n        defaultMessage='{acct} has not featured anything yet. Did you know that you can feature your hashtags you use the most, and even your friend’s accounts on your profile?'\n        values={{ acct }}\n      />\n    );\n  } else {\n    message = (\n      <FormattedMessage\n        id='empty_column.account_featured_other.unknown'\n        defaultMessage='This account has not featured anything yet.'\n      />\n    );\n  }\n\n  return <div className='empty-column-indicator'>{message}</div>;\n};\n","import { defineMessages, useIntl } from 'react-intl';\n\nimport type { Map as ImmutableMap } from 'immutable';\n\nimport { Hashtag } from 'mastodon/components/hashtag';\n\nexport type TagMap = ImmutableMap<\n  'id' | 'name' | 'url' | 'statuses_count' | 'last_status_at' | 'accountId',\n  string | null\n>;\n\ninterface FeaturedTagProps {\n  tag: TagMap;\n  account: string;\n}\n\nconst messages = defineMessages({\n  lastStatusAt: {\n    id: 'account.featured_tags.last_status_at',\n    defaultMessage: 'Last post on {date}',\n  },\n  empty: {\n    id: 'account.featured_tags.last_status_never',\n    defaultMessage: 'No posts',\n  },\n});\n\nexport const FeaturedTag: React.FC<FeaturedTagProps> = ({ tag, account }) => {\n  const intl = useIntl();\n  const name = tag.get('name') ?? '';\n  const count = Number.parseInt(tag.get('statuses_count') ?? '');\n  return (\n    <Hashtag\n      key={name}\n      name={name}\n      to={`/@${account}/tagged/${name}`}\n      uses={count}\n      withGraph={false}\n      description={\n        count > 0\n          ? intl.formatMessage(messages.lastStatusAt, {\n              date: intl.formatDate(tag.get('last_status_at') ?? '', {\n                month: 'short',\n                day: '2-digit',\n                year: 'numeric',\n              }),\n            })\n          : intl.formatMessage(messages.empty)\n      }\n    />\n  );\n};\n","import { useEffect } from 'react';\n\nimport { FormattedMessage } from 'react-intl';\n\nimport { useParams } from 'react-router';\n\nimport { List as ImmutableList } from 'immutable';\n\nimport { fetchEndorsedAccounts } from 'mastodon/actions/accounts';\nimport { fetchFeaturedTags } from 'mastodon/actions/featured_tags';\nimport { Account } from 'mastodon/components/account';\nimport { ColumnBackButton } from 'mastodon/components/column_back_button';\nimport { LoadingIndicator } from 'mastodon/components/loading_indicator';\nimport { RemoteHint } from 'mastodon/components/remote_hint';\nimport { AccountHeader } from 'mastodon/features/account_timeline/components/account_header';\nimport BundleColumnError from 'mastodon/features/ui/components/bundle_column_error';\nimport Column from 'mastodon/features/ui/components/column';\nimport { useAccountId } from 'mastodon/hooks/useAccountId';\nimport { useAccountVisibility } from 'mastodon/hooks/useAccountVisibility';\nimport { useAppDispatch, useAppSelector } from 'mastodon/store';\n\nimport { EmptyMessage } from './components/empty_message';\nimport { FeaturedTag } from './components/featured_tag';\nimport type { TagMap } from './components/featured_tag';\n\ninterface Params {\n  acct?: string;\n  id?: string;\n}\n\nconst AccountFeatured: React.FC<{ multiColumn: boolean }> = ({\n  multiColumn,\n}) => {\n  const accountId = useAccountId();\n  const { suspended, blockedBy, hidden } = useAccountVisibility(accountId);\n  const forceEmptyState = suspended || blockedBy || hidden;\n  const { acct = '' } = useParams<Params>();\n\n  const dispatch = useAppDispatch();\n\n  useEffect(() => {\n    if (accountId) {\n      void dispatch(fetchFeaturedTags({ accountId }));\n      void dispatch(fetchEndorsedAccounts({ accountId }));\n    }\n  }, [accountId, dispatch]);\n\n  const isLoading = useAppSelector(\n    (state) =>\n      !accountId ||\n      !!state.user_lists.getIn(['featured_tags', accountId, 'isLoading']),\n  );\n  const featuredTags = useAppSelector(\n    (state) =>\n      state.user_lists.getIn(\n        ['featured_tags', accountId, 'items'],\n        ImmutableList(),\n      ) as ImmutableList<TagMap>,\n  );\n  const featuredAccountIds = useAppSelector(\n    (state) =>\n      state.user_lists.getIn(\n        ['featured_accounts', accountId, 'items'],\n        ImmutableList(),\n      ) as ImmutableList<string>,\n  );\n\n  if (accountId === null) {\n    return <BundleColumnError multiColumn={multiColumn} errorType='routing' />;\n  }\n\n  if (isLoading) {\n    return (\n      <AccountFeaturedWrapper accountId={accountId}>\n        <div className='scrollable__append'>\n          <LoadingIndicator />\n        </div>\n      </AccountFeaturedWrapper>\n    );\n  }\n\n  if (featuredTags.isEmpty() && featuredAccountIds.isEmpty()) {\n    return (\n      <AccountFeaturedWrapper accountId={accountId}>\n        <EmptyMessage\n          blockedBy={blockedBy}\n          hidden={hidden}\n          suspended={suspended}\n          accountId={accountId}\n        />\n        <RemoteHint accountId={accountId} />\n      </AccountFeaturedWrapper>\n    );\n  }\n\n  return (\n    <Column>\n      <ColumnBackButton />\n\n      <div className='scrollable scrollable--flex'>\n        {accountId && (\n          <AccountHeader accountId={accountId} hideTabs={forceEmptyState} />\n        )}\n        {!featuredTags.isEmpty() && (\n          <>\n            <h4 className='column-subheading'>\n              <FormattedMessage\n                id='account.featured.hashtags'\n                defaultMessage='Hashtags'\n              />\n            </h4>\n            {featuredTags.map((tag) => (\n              <FeaturedTag key={tag.get('id')} tag={tag} account={acct} />\n            ))}\n          </>\n        )}\n        {!featuredAccountIds.isEmpty() && (\n          <>\n            <h4 className='column-subheading'>\n              <FormattedMessage\n                id='account.featured.accounts'\n                defaultMessage='Profiles'\n              />\n            </h4>\n            {featuredAccountIds.map((featuredAccountId) => (\n              <Account key={featuredAccountId} id={featuredAccountId} />\n            ))}\n          </>\n        )}\n        <RemoteHint accountId={accountId} />\n      </div>\n    </Column>\n  );\n};\n\nconst AccountFeaturedWrapper = ({\n  children,\n  accountId,\n}: React.PropsWithChildren<{ accountId?: string }>) => {\n  return (\n    <Column>\n      <ColumnBackButton />\n      <div className='scrollable scrollable--flex'>\n        {accountId && <AccountHeader accountId={accountId} />}\n        {children}\n      </div>\n    </Column>\n  );\n};\n\n// eslint-disable-next-line import/no-default-export\nexport default AccountFeatured;\n"],"names":["EmptyMessage","accountId","suspended","hidden","blockedBy","acct","useParams","message","me","jsx","FormattedMessage","LimitedAccountHint","messages","defineMessages","lastStatusAt","id","defaultMessage","empty","FeaturedTag","tag","account","intl","useIntl","name","get","count","Number","parseInt","Hashtag","formatMessage","date","formatDate","month","day","year","AccountFeatured","multiColumn","useAccountId","useAccountVisibility","forceEmptyState","dispatch","useAppDispatch","useEffect","fetchFeaturedTags","fetchEndorsedAccounts","isLoading","useAppSelector","state","user_lists","getIn","featuredTags","ImmutableList","featuredAccountIds","BundleColumnError","AccountFeaturedWrapper","LoadingIndicator","isEmpty","jsxs","RemoteHint","Column","ColumnBackButton","AccountHeader","Fragment","map","featuredAccountId","Account","children"],"mappings":"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"}