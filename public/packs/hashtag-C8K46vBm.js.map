{"version":3,"file":"hashtag-C8K46vBm.js","sources":["../../app/javascript/mastodon/components/hashtag.tsx"],"sourcesContent":["import type { JSX } from 'react';\nimport { Component } from 'react';\n\nimport { FormattedMessage } from 'react-intl';\n\nimport classNames from 'classnames';\nimport { Link } from 'react-router-dom';\n\nimport type Immutable from 'immutable';\n\nimport { Sparklines, SparklinesCurve } from 'react-sparklines';\n\nimport { ShortNumber } from 'mastodon/components/short_number';\nimport { Skeleton } from 'mastodon/components/skeleton';\nimport type { Hashtag as HashtagType } from 'mastodon/models/tags';\n\ninterface SilentErrorBoundaryProps {\n  children: React.ReactNode;\n}\n\nclass SilentErrorBoundary extends Component<SilentErrorBoundaryProps> {\n  state = {\n    error: false,\n  };\n\n  componentDidCatch() {\n    this.setState({ error: true });\n  }\n\n  render() {\n    if (this.state.error) {\n      return null;\n    }\n\n    return this.props.children;\n  }\n}\n\n/**\n * Used to render counter of how much people are talking about hashtag\n * @param displayNumber Counter number to display\n * @param pluralReady Whether the count is plural\n * @returns Formatted counter of how much people are talking about hashtag\n */\nexport const accountsCountRenderer = (\n  displayNumber: JSX.Element,\n  pluralReady: number,\n) => (\n  <FormattedMessage\n    id='trends.counter_by_accounts'\n    defaultMessage='{count, plural, one {{counter} person} other {{counter} people}} in the past {days, plural, one {day} other {# days}}'\n    values={{\n      count: pluralReady,\n      counter: <strong>{displayNumber}</strong>,\n      days: 2,\n    }}\n  />\n);\n\ninterface ImmutableHashtagProps {\n  hashtag: Immutable.Map<string, unknown>;\n}\n\nexport const ImmutableHashtag = ({ hashtag }: ImmutableHashtagProps) => (\n  <Hashtag\n    name={hashtag.get('name') as string}\n    to={`/tags/${hashtag.get('name') as string}`}\n    people={\n      (hashtag.getIn(['history', 0, 'accounts']) as number) * 1 +\n      (hashtag.getIn(['history', 1, 'accounts']) as number) * 1\n    }\n    history={(\n      hashtag.get('history') as Immutable.Collection.Indexed<\n        Immutable.Map<string, number>\n      >\n    )\n      .reverse()\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      .map((day) => day.get('uses')!)\n      .toArray()}\n  />\n);\n\nexport const CompatibilityHashtag: React.FC<{\n  hashtag: HashtagType;\n}> = ({ hashtag }) => (\n  <Hashtag\n    name={hashtag.name}\n    to={`/tags/${hashtag.name}`}\n    people={\n      (hashtag.history[0].accounts as unknown as number) * 1 +\n      ((hashtag.history[1]?.accounts ?? 0) as unknown as number) * 1\n    }\n    history={hashtag.history\n      .map((day) => (day.uses as unknown as number) * 1)\n      .reverse()}\n  />\n);\n\nexport interface HashtagProps {\n  className?: string;\n  description?: React.ReactNode;\n  history?: number[];\n  name: string;\n  people?: number;\n  to: string;\n  uses?: number;\n  withGraph?: boolean;\n  children?: React.ReactNode;\n}\n\nexport const Hashtag: React.FC<HashtagProps> = ({\n  name,\n  to,\n  people,\n  uses,\n  history,\n  className,\n  description,\n  withGraph = true,\n  children,\n}) => (\n  <div className={classNames('trends__item', className)}>\n    <div className='trends__item__name'>\n      <Link to={to}>\n        {name ? (\n          <>\n            #<span>{name}</span>\n          </>\n        ) : (\n          <Skeleton width={50} />\n        )}\n      </Link>\n\n      {description ? (\n        <span>{description}</span>\n      ) : typeof people !== 'undefined' ? (\n        <ShortNumber value={people} renderer={accountsCountRenderer} />\n      ) : (\n        <Skeleton width={100} />\n      )}\n    </div>\n\n    {typeof uses !== 'undefined' && (\n      <div className='trends__item__current'>\n        <ShortNumber value={uses} />\n      </div>\n    )}\n\n    {withGraph && (\n      <div className='trends__item__sparkline'>\n        <SilentErrorBoundary>\n          <Sparklines\n            width={50}\n            height={28}\n            data={history ?? Array.from(Array(7)).map(() => 0)}\n          >\n            <SparklinesCurve style={{ fill: 'none' }} />\n          </Sparklines>\n        </SilentErrorBoundary>\n      </div>\n    )}\n\n    {children && <div className='trends__item__buttons'>{children}</div>}\n  </div>\n);\n"],"names":["SilentErrorBoundary","Component","state","error","componentDidCatch","setState","render","props","children","accountsCountRenderer","displayNumber","pluralReady","jsx","FormattedMessage","count","counter","days","ImmutableHashtag","hashtag","Hashtag","get","getIn","reverse","map","day","toArray","CompatibilityHashtag","name","history","accounts","uses","to","people","className","description","withGraph","classNames","jsxs","Link","Fragment","Skeleton","ShortNumber","Sparklines","Array","from","SparklinesCurve","fill"],"mappings":"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"}