{"version":3,"file":"bundle_column_error-Cn2E6aKL.js","sources":["../../app/javascript/mastodon/features/ui/components/bundle_column_error.jsx"],"sourcesContent":["import PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\n\nimport { injectIntl, FormattedMessage } from 'react-intl';\n\nimport classNames from 'classnames';\nimport { Helmet } from 'react-helmet';\nimport { Link } from 'react-router-dom';\n\nimport { Button } from 'mastodon/components/button';\nimport Column from 'mastodon/components/column';\nimport { GIF } from 'mastodon/components/gif';\n\nclass CopyButton extends PureComponent {\n\n  static propTypes = {\n    children: PropTypes.node.isRequired,\n    value: PropTypes.string.isRequired,\n  };\n\n  state = {\n    copied: false,\n  };\n\n  handleClick = () => {\n    const { value } = this.props;\n    navigator.clipboard.writeText(value);\n    this.setState({ copied: true });\n    this.timeout = setTimeout(() => this.setState({ copied: false }), 700);\n  };\n\n  componentWillUnmount () {\n    if (this.timeout) clearTimeout(this.timeout);\n  }\n\n  render () {\n    const { children } = this.props;\n    const { copied } = this.state;\n\n    return (\n      <Button onClick={this.handleClick} className={copied ? 'copied' : 'copyable'}>{copied ? <FormattedMessage id='copypaste.copied' defaultMessage='Copied' /> : children}</Button>\n    );\n  }\n\n}\n\nclass BundleColumnError extends PureComponent {\n\n  static propTypes = {\n    errorType: PropTypes.oneOf(['routing', 'network', 'error']),\n    onRetry: PropTypes.func,\n    intl: PropTypes.object.isRequired,\n    multiColumn: PropTypes.bool,\n    stacktrace: PropTypes.string,\n  };\n\n  static defaultProps = {\n    errorType: 'routing',\n  };\n\n  handleRetry = () => {\n    const { onRetry } = this.props;\n\n    if (onRetry) {\n      onRetry();\n    }\n  };\n\n  render () {\n    const { errorType, multiColumn, stacktrace } = this.props;\n\n    let title, body;\n\n    switch(errorType) {\n    case 'routing':\n      title = <FormattedMessage id='bundle_column_error.routing.title' defaultMessage='404' />;\n      body = <FormattedMessage id='bundle_column_error.routing.body' defaultMessage='The requested page could not be found. Are you sure the URL in the address bar is correct?' />;\n      break;\n    case 'network':\n      title = <FormattedMessage id='bundle_column_error.network.title' defaultMessage='Network error' />;\n      body = <FormattedMessage id='bundle_column_error.network.body' defaultMessage='There was an error when trying to load this page. This could be due to a temporary problem with your internet connection or this server.' />;\n      break;\n    case 'error':\n      title = <FormattedMessage id='bundle_column_error.error.title' defaultMessage='Oh, no!' />;\n      body = <FormattedMessage id='bundle_column_error.error.body' defaultMessage='The requested page could not be rendered. It could be due to a bug in our code, or a browser compatibility issue.' />;\n      break;\n    }\n\n    return (\n      <Column bindToDocument={!multiColumn}>\n        <div className='error-column'>\n          <GIF src='/oops.gif' staticSrc='/oops.png' className='error-column__image' />\n\n          <div className='error-column__message'>\n            <h1>{title}</h1>\n            <p>{body}</p>\n\n            <div className='error-column__message__actions'>\n              {errorType === 'network' && <Button onClick={this.handleRetry}><FormattedMessage id='bundle_column_error.retry' defaultMessage='Try again' /></Button>}\n              {errorType === 'error' && <CopyButton value={stacktrace}><FormattedMessage id='bundle_column_error.copy_stacktrace' defaultMessage='Copy error report' /></CopyButton>}\n              <Link to='/' className={classNames('button', { 'button-tertiary': errorType !== 'routing' })}><FormattedMessage id='bundle_column_error.return' defaultMessage='Go back home' /></Link>\n            </div>\n          </div>\n        </div>\n\n        <Helmet>\n          <meta name='robots' content='noindex' />\n        </Helmet>\n      </Column>\n    );\n  }\n\n}\n\nexport default injectIntl(BundleColumnError);\n"],"names":["CopyButton","PureComponent","state","copied","handleClick","value","props","navigator","clipboard","writeText","setState","timeout","setTimeout","componentWillUnmount","clearTimeout","render","children","Button","FormattedMessage","BundleColumnError","handleRetry","onRetry","errorType","multiColumn","stacktrace","title","body","jsx","jsxs","Column","GIF","Link","classNames","Helmet","__publicField","defaultProps","BundleColumnError$1","injectIntl"],"mappings":"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"}