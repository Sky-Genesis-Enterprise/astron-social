var b=Object.defineProperty;var C=(n,i,t)=>i in n?b(n,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[i]=t;var l=(n,i,t)=>C(n,typeof i!="symbol"?i+"":i,t);import{j as r}from"./client-wT6vtYO_.js";import{i as f,r as y,d as j}from"./index-BdTwX--g.js";import{H as I}from"./Helmet-ZVWnGmbg.js";import{j as M,cY as R,aM as P,B as S,ae as _,cF as v,cG as T,cZ as d}from"./useSelectableClick-DeaJbL2_.js";import{c as D}from"./content_warning-DZ8mar1O.js";import{D as $}from"./dismissable_banner-DYkkvrn4.js";import{d as E}from"./initial_state-BP3UcUr4.js";import{a as h}from"./streaming-BaFGIdWo.js";import{C as H}from"./column-B4vwzadM.js";import{C as L}from"./column_header-FN7GyEAs.js";import{S as U}from"./status_list_container-7VQVJmu6.js";import{S as g}from"./setting_toggle-56grnhBH.js";import{M as c}from"./message-UFwkQlnu.js";import"./short_number-WomMu2iV.js";import"./numbers-CGZQWBYL.js";import"./api-B2m7efUy.js";import"./index-lj9VQs0f.js";import"./ready-DpOgoWSg.js";import"./index-CAH5FfLP.js";import"./load_locale-tOpKhmcM.js";import"./index-DizoKcfL.js";import"./skeleton-D9NbTYr9.js";import"./close-BsPe8EbX.js";import"./scroll-BygYx8ga.js";import"./add-D8GR9P00.js";import"./chevron_left-CnYIoVsW.js";import"./status_list-DPL_DhlK.js";import"./gif-BtN1axMk.js";import"./info-HtHaDKcq.js";import"./follow_button-BdqDKUmA.js";import"./index-BZWHsOPk.js";import"./loading_indicator-7xMB1U6D.js";import"./verified_badge-CtK79Pb7.js";import"./status_quoted-COu-QToA.js";import"./domain_blocks-CYnp0hav.js";import"./reports-DBOcsYZF.js";import"./status-CiF0hsk4.js";import"./index.es-B0ZBMj49.js";import"./card-CttmBekj.js";import"./avatar_overlay-BeG39OK4.js";import"./toString-Cy1Ecq9L.js";import"./status_content-CaIN8-0B.js";import"./poll-CjurB963.js";import"./permissions-Djze7cmB.js";import"./visibility_icon-DbVVvHFb.js";import"./index-OwtqmxAM.js";import"./load_gap-6rwcZCuh.js";import"./scrollable_list-lNykmhKA.js";import"./scroll_container-Bq73vRM7.js";import"./react-router-scroll-4.es-CU7ja20b.js";import"./interopRequireDefault-CdiRfGvq.js";import"./schedule_idle_task-Co3Ydhdu.js";import"./load_more-qGthrhsi.js";import"./index-Dk6IJ02w.js";class w extends y.PureComponent{render(){const{settings:i,onChange:t}=this.props;return r.jsx("div",{className:"column-settings",children:r.jsx("section",{children:r.jsxs("div",{className:"column-settings__row",children:[r.jsx(g,{settings:i,settingPath:["other","onlyMedia"],onChange:t,label:r.jsx(c,{id:"community.column_settings.media_only",defaultMessage:"Media only"})}),r.jsx(g,{settings:i,settingPath:["other","onlyRemote"],onChange:t,label:r.jsx(c,{id:"community.column_settings.remote_only",defaultMessage:"Remote only"})})]})})})}}const B=f(w),F=(n,{columnId:i})=>{const t=i,e=n.getIn(["settings","columns"]),o=e.findIndex(s=>s.get("uuid")===t);return{settings:t&&o>=0?e.get(o).get("params"):n.getIn(["settings","public"])}},k=(n,{columnId:i})=>({onChange(t,e){n(i?R(i,t,e):P(["public",...t],e))}}),N=M(F,k)(B),u=j({title:{id:"column.public",defaultMessage:"Federated timeline"}}),W=(n,{columnId:i})=>{const t=i,e=n.getIn(["settings","columns"]),o=e.findIndex(p=>p.get("uuid")===t),s=i&&o>=0?e.get(o).getIn(["params","other","onlyMedia"]):n.getIn(["settings","public","other","onlyMedia"]),m=i&&o>=0?e.get(o).getIn(["params","other","onlyRemote"]):n.getIn(["settings","public","other","onlyRemote"]),a=n.getIn(["timelines",`public${m?":remote":""}${s?":media":""}`]);return{hasUnread:!!a&&a.get("unread")>0,onlyMedia:s,onlyRemote:m}};class x extends y.PureComponent{constructor(){super(...arguments);l(this,"handlePin",()=>{const{columnId:t,dispatch:e,onlyMedia:o,onlyRemote:s}=this.props;e(t?_(t):v(s?"REMOTE":"PUBLIC",{other:{onlyMedia:o,onlyRemote:s}}))});l(this,"handleMove",t=>{const{columnId:e,dispatch:o}=this.props;o(T(e,t))});l(this,"handleHeaderClick",()=>{this.column.scrollTop()});l(this,"setRef",t=>{this.column=t});l(this,"handleLoadMore",t=>{const{dispatch:e,onlyMedia:o,onlyRemote:s}=this.props;e(d({maxId:t,onlyMedia:o,onlyRemote:s}))})}componentDidMount(){const{dispatch:t,onlyMedia:e,onlyRemote:o}=this.props,{signedIn:s}=this.props.identity;t(d({onlyMedia:e,onlyRemote:o})),s&&(this.disconnect=t(h({onlyMedia:e,onlyRemote:o})))}componentDidUpdate(t){const{signedIn:e}=this.props.identity;if(t.onlyMedia!==this.props.onlyMedia||t.onlyRemote!==this.props.onlyRemote){const{dispatch:o,onlyMedia:s,onlyRemote:m}=this.props;this.disconnect&&this.disconnect(),o(d({onlyMedia:s,onlyRemote:m})),e&&(this.disconnect=o(h({onlyMedia:s,onlyRemote:m})))}}componentWillUnmount(){this.disconnect&&(this.disconnect(),this.disconnect=null)}render(){const{intl:t,columnId:e,hasUnread:o,multiColumn:s,onlyMedia:m,onlyRemote:a}=this.props,p=!!e;return r.jsxs(H,{bindToDocument:!s,ref:this.setRef,label:t.formatMessage(u.title),children:[r.jsx(L,{icon:"globe",iconComponent:D,active:o,title:t.formatMessage(u.title),onPin:this.handlePin,onMove:this.handleMove,onClick:this.handleHeaderClick,pinned:p,multiColumn:s,children:r.jsx(N,{columnId:e})}),r.jsx(U,{prepend:r.jsx($,{id:"public_timeline",children:r.jsx(c,{id:"dismissable_banner.public_timeline",defaultMessage:"These are the most recent public posts from people on the fediverse that people on {domain} follow.",values:{domain:E}})}),timelineId:`public${a?":remote":""}${m?":media":""}`,onLoadMore:this.handleLoadMore,trackScroll:!p,scrollKey:`public_timeline-${e}`,emptyMessage:r.jsx(c,{id:"empty_column.public",defaultMessage:"There is nothing here! Write something publicly, or manually follow users from other servers to fill it up"}),bindToDocument:!s}),r.jsxs(I,{children:[r.jsx("title",{children:t.formatMessage(u.title)}),r.jsx("meta",{name:"robots",content:"noindex"})]})]})}}l(x,"defaultProps",{onlyMedia:!1});const Gt=M(W)(S(f(x)));export{Gt as default};
//# sourceMappingURL=public_timeline-index-CSX2yHU1.js.map
