var G=Object.defineProperty;var Z=(l,d,e)=>d in l?G(l,d,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[d]=e;var a=(l,d,e)=>Z(l,typeof d!="symbol"?d+"":d,e);import{j as n}from"./client-wT6vtYO_.js";import{w as J,P as u}from"./short_number-WomMu2iV.js";import{r as w,i as F,d as q}from"./index-BdTwX--g.js";import{c as D}from"./index-DizoKcfL.js";import{H as Y}from"./Helmet-ZVWnGmbg.js";import{bS as V,j as $,B as L,b as S,aT as B,v as Q,w as X,aU as ee,aV as te,aW as se,ab as ae,aX as oe,aY as ie,y as ne,aR as le,z as E,aS as re,a2 as j,cJ as de,a$ as ce,o as f,c8 as pe,c9 as he,af as ue,b0 as me,ca as ge,cb as fe,ac as ke,ag as Me,c5 as be,c4 as Ce,bK as ve,c0 as ye,c1 as Ie,d9 as H,da as U,c6 as _e,c7 as Te,c3 as Se,bJ as xe,bH as Re,cK as De,cL as we,I as Be}from"./useSelectableClick-DeaJbL2_.js";import{i as Ee}from"./index.es-B0ZBMj49.js";import{S as je}from"./visibility_off-CFNdrvj5.js";import{L as He}from"./loading_indicator-7xMB1U6D.js";import{T as Ue}from"./timeline_hint-0fHjsenK.js";import{S as Ae}from"./scroll_container-Bq73vRM7.js";import{B as Pe}from"./bundle_column_error-Cn2E6aKL.js";import{i as Oe,u as Ne}from"./domain_blocks-CYnp0hav.js";import{i as Fe}from"./reports-DBOcsYZF.js";import{C as qe}from"./column_header-FN7GyEAs.js";import{a as Ve,b as $e,d as A,t as Le}from"./status-CiF0hsk4.js";import{S as Ke}from"./status_quoted-COu-QToA.js";import{e as P,I as We}from"./initial_state-BP3UcUr4.js";import{m as ze,a as Ge}from"./index-OwtqmxAM.js";import{C as O}from"./column-Cq3LGCyF.js";import{b as Ze,S as Je}from"./content_warning-DZ8mar1O.js";import{P as x,b as R}from"./permissions-Djze7cmB.js";import{D as Ye}from"./detailed_status-BXIq3on5.js";import{M as N}from"./message-UFwkQlnu.js";import"./numbers-CGZQWBYL.js";import"./api-B2m7efUy.js";import"./index-lj9VQs0f.js";import"./ready-DpOgoWSg.js";import"./index-CAH5FfLP.js";import"./load_locale-tOpKhmcM.js";import"./react-router-scroll-4.es-CU7ja20b.js";import"./interopRequireDefault-CdiRfGvq.js";import"./index-BZWHsOPk.js";import"./column-B4vwzadM.js";import"./scroll-BygYx8ga.js";import"./gif-BtN1axMk.js";import"./add-D8GR9P00.js";import"./chevron_left-CnYIoVsW.js";import"./close-BsPe8EbX.js";import"./card-CttmBekj.js";import"./avatar_overlay-BeG39OK4.js";import"./toString-Cy1Ecq9L.js";import"./status_content-CaIN8-0B.js";import"./poll-CjurB963.js";import"./visibility_icon-DbVVvHFb.js";import"./skeleton-D9NbTYr9.js";import"./formatted_date-jZOhBAMt.js";import"./inline_account-Dg3-UMsJ.js";import"./media_gallery-DTAKF-fT.js";import"./alt_text_badge-CwO3PXb3.js";import"./schedule_idle_task-Co3Ydhdu.js";const Qe=l=>w.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:24,viewBox:"0 -960 960 960",width:24,...l},w.createElement("path",{d:"M480-320q75 0 127.5-52.5T660-500q0-75-52.5-127.5T480-680q-75 0-127.5 52.5T300-500q0 75 52.5 127.5T480-320Zm0-72q-45 0-76.5-31.5T372-500q0-45 31.5-76.5T480-608q45 0 76.5 31.5T588-500q0 45-31.5 76.5T480-392Zm0 192q-146 0-266-81.5T40-500q54-137 174-218.5T480-800q146 0 266 81.5T920-500q-54 137-174 218.5T480-200Zm0-300Zm0 220q113 0 207.5-59.5T832-500q-50-101-144.5-160.5T480-720q-113 0-207.5 59.5T128-500q50 101 144.5 160.5T480-280Z"})),Xe=V([(l,d)=>d,l=>l.contexts.inReplyTos],(l,d)=>{const e=[];let s=l;for(;s&&!e.includes(s);)e.unshift(s),s=d[s];return e}),et=V([(l,d)=>d,l=>l.contexts.replies,l=>l.statuses],(l,d,e)=>{const s=[],t=[l];for(;t.length>0;){const o=t.pop();if(!o)break;const p=d[o];l!==o&&s.push(o),p&&p.toReversed().forEach(h=>{!t.includes(h)&&!s.includes(h)&&l!==h&&t.push(h)})}let i=s.findIndex(o=>{const p=e.get(o);if(!p)return!1;const h=p.get("in_reply_to_account_id"),g=p.get("account");return h!==g});return i!==-1&&s.forEach((o,p)=>{const h=e.get(o);if(!h)return;const g=h.get("in_reply_to_account_id"),m=h.get("account");p>i&&g===m&&(s.splice(p,1),s.splice(i,0,o),i+=1)}),s}),r=q({delete:{id:"status.delete",defaultMessage:"Delete"},redraft:{id:"status.redraft",defaultMessage:"Delete & re-draft"},edit:{id:"status.edit",defaultMessage:"Edit"},direct:{id:"status.direct",defaultMessage:"Privately mention @{name}"},mention:{id:"status.mention",defaultMessage:"Mention @{name}"},reply:{id:"status.reply",defaultMessage:"Reply"},reblog:{id:"status.reblog",defaultMessage:"Boost"},reblog_private:{id:"status.reblog_private",defaultMessage:"Boost with original visibility"},cancel_reblog_private:{id:"status.cancel_reblog_private",defaultMessage:"Unboost"},cannot_reblog:{id:"status.cannot_reblog",defaultMessage:"This post cannot be boosted"},favourite:{id:"status.favourite",defaultMessage:"Favorite"},removeFavourite:{id:"status.remove_favourite",defaultMessage:"Remove from favorites"},bookmark:{id:"status.bookmark",defaultMessage:"Bookmark"},removeBookmark:{id:"status.remove_bookmark",defaultMessage:"Remove bookmark"},more:{id:"status.more",defaultMessage:"More"},mute:{id:"status.mute",defaultMessage:"Mute @{name}"},muteConversation:{id:"status.mute_conversation",defaultMessage:"Mute conversation"},unmuteConversation:{id:"status.unmute_conversation",defaultMessage:"Unmute conversation"},block:{id:"status.block",defaultMessage:"Block @{name}"},report:{id:"status.report",defaultMessage:"Report @{name}"},share:{id:"status.share",defaultMessage:"Share"},pin:{id:"status.pin",defaultMessage:"Pin on profile"},unpin:{id:"status.unpin",defaultMessage:"Unpin from profile"},embed:{id:"status.embed",defaultMessage:"Get embed code"},admin_account:{id:"status.admin_account",defaultMessage:"Open moderation interface for @{name}"},admin_status:{id:"status.admin_status",defaultMessage:"Open this post in the moderation interface"},admin_domain:{id:"status.admin_domain",defaultMessage:"Open moderation interface for {domain}"},copy:{id:"status.copy",defaultMessage:"Copy link to post"},blockDomain:{id:"account.block_domain",defaultMessage:"Block domain {domain}"},unblockDomain:{id:"account.unblock_domain",defaultMessage:"Unblock domain {domain}"},unmute:{id:"account.unmute",defaultMessage:"Unmute @{name}"},unblock:{id:"account.unblock",defaultMessage:"Unblock @{name}"},openOriginalPage:{id:"account.open_original_page",defaultMessage:"Open original page"}}),tt=(l,{status:d})=>({relationship:l.getIn(["relationships",d.getIn(["account","id"])])});class st extends w.PureComponent{constructor(){super(...arguments);a(this,"handleReplyClick",()=>{this.props.onReply(this.props.status)});a(this,"handleReblogClick",e=>{this.props.onReblog(this.props.status,e)});a(this,"handleFavouriteClick",()=>{this.props.onFavourite(this.props.status)});a(this,"handleBookmarkClick",e=>{this.props.onBookmark(this.props.status,e)});a(this,"handleDeleteClick",()=>{this.props.onDelete(this.props.status)});a(this,"handleRedraftClick",()=>{this.props.onDelete(this.props.status,!0)});a(this,"handleEditClick",()=>{this.props.onEdit(this.props.status)});a(this,"handleDirectClick",()=>{this.props.onDirect(this.props.status.get("account"))});a(this,"handleMentionClick",()=>{this.props.onMention(this.props.status.get("account"))});a(this,"handleMuteClick",()=>{const{status:e,relationship:s,onMute:t,onUnmute:i}=this.props,o=e.get("account");s&&s.get("muting")?i(o):t(o)});a(this,"handleBlockClick",()=>{const{status:e,relationship:s,onBlock:t,onUnblock:i}=this.props,o=e.get("account");s&&s.get("blocking")?i(o):t(e)});a(this,"handleBlockDomain",()=>{const{status:e,onBlockDomain:s}=this.props,t=e.get("account");s(t)});a(this,"handleUnblockDomain",()=>{const{status:e,onUnblockDomain:s}=this.props,t=e.get("account");s(t.get("acct").split("@")[1])});a(this,"handleConversationMuteClick",()=>{this.props.onMuteConversation(this.props.status)});a(this,"handleReport",()=>{this.props.onReport(this.props.status)});a(this,"handlePinClick",()=>{this.props.onPin(this.props.status)});a(this,"handleShare",()=>{navigator.share({url:this.props.status.get("url")})});a(this,"handleEmbed",()=>{this.props.onEmbed(this.props.status)});a(this,"handleCopy",()=>{const e=this.props.status.get("url");navigator.clipboard.writeText(e)})}render(){const{status:e,relationship:s,intl:t}=this.props,{signedIn:i,permissions:o}=this.props.identity,p=["public","unlisted"].includes(e.get("visibility")),h=["public","unlisted","private"].includes(e.get("visibility")),g=e.get("muted"),m=e.get("account"),C=e.getIn(["account","id"])===P,k=e.getIn(["account","username"])!==e.getIn(["account","acct"]);let c=[];if(p&&k&&c.push({text:t.formatMessage(r.openOriginalPage),href:e.get("url")}),c.push({text:t.formatMessage(r.copy),action:this.handleCopy}),p&&"share"in navigator&&c.push({text:t.formatMessage(r.share),action:this.handleShare}),p&&(i||!k)&&c.push({text:t.formatMessage(r.embed),action:this.handleEmbed}),i)if(c.push(null),C)h&&(c.push({text:t.formatMessage(e.get("pinned")?r.unpin:r.pin),action:this.handlePinClick}),c.push(null)),c.push({text:t.formatMessage(g?r.unmuteConversation:r.muteConversation),action:this.handleConversationMuteClick}),c.push(null),c.push({text:t.formatMessage(r.edit),action:this.handleEditClick}),c.push({text:t.formatMessage(r.delete),action:this.handleDeleteClick,dangerous:!0}),c.push({text:t.formatMessage(r.redraft),action:this.handleRedraftClick,dangerous:!0});else{if(c.push({text:t.formatMessage(r.mention,{name:e.getIn(["account","username"])}),action:this.handleMentionClick}),c.push(null),s&&s.get("muting")?c.push({text:t.formatMessage(r.unmute,{name:m.get("username")}),action:this.handleMuteClick}):c.push({text:t.formatMessage(r.mute,{name:m.get("username")}),action:this.handleMuteClick,dangerous:!0}),s&&s.get("blocking")?c.push({text:t.formatMessage(r.unblock,{name:m.get("username")}),action:this.handleBlockClick}):c.push({text:t.formatMessage(r.block,{name:m.get("username")}),action:this.handleBlockClick,dangerous:!0}),c.push({text:t.formatMessage(r.report,{name:e.getIn(["account","username"])}),action:this.handleReport,dangerous:!0}),m.get("acct")!==m.get("username")){const T=m.get("acct").split("@")[1];c.push(null),s&&s.get("domain_blocking")?c.push({text:t.formatMessage(r.unblockDomain,{domain:T}),action:this.handleUnblockDomain}):c.push({text:t.formatMessage(r.blockDomain,{domain:T}),action:this.handleBlockDomain,dangerous:!0})}if(((o&x)===x||k&&(o&R)===R)&&(c.push(null),(o&x)===x&&(c.push({text:t.formatMessage(r.admin_account,{name:e.getIn(["account","username"])}),href:`/admin/accounts/${e.getIn(["account","id"])}`}),c.push({text:t.formatMessage(r.admin_status),href:`/admin/accounts/${e.getIn(["account","id"])}/statuses/${e.get("id")}`})),k&&(o&R)===R)){const T=m.get("acct").split("@")[1];c.push({text:t.formatMessage(r.admin_domain,{domain:T}),href:`/admin/instances/${T}`})}}let M,v;e.get("in_reply_to_id",null)===null?(M="reply",v=B):(M="reply-all",v=ee);const y=e.getIn(["account","id"])===P&&e.get("visibility")==="private";let I,_;e.get("reblogged")?(I=t.formatMessage(r.cancel_reblog_private),_=p?te:se):p?(I=t.formatMessage(r.reblog),_=ae):y?(I=t.formatMessage(r.reblog_private),_=oe):(I=t.formatMessage(r.cannot_reblog),_=ie);const W=t.formatMessage(e.get("bookmarked")?r.removeBookmark:r.bookmark),z=t.formatMessage(e.get("favourited")?r.removeFavourite:r.favourite);return n.jsxs("div",{className:"detailed-status__action-bar",children:[n.jsx("div",{className:"detailed-status__button",children:n.jsx(S,{title:t.formatMessage(r.reply),icon:e.get("in_reply_to_account_id")===e.getIn(["account","id"])?"reply":M,iconComponent:e.get("in_reply_to_account_id")===e.getIn(["account","id"])?B:v,onClick:this.handleReplyClick})}),n.jsx("div",{className:"detailed-status__button",children:n.jsx(S,{className:D({reblogPrivate:y}),disabled:!p&&!y,active:e.get("reblogged"),title:I,icon:"retweet",iconComponent:_,onClick:this.handleReblogClick})}),n.jsx("div",{className:"detailed-status__button",children:n.jsx(S,{className:"star-icon",animate:!0,active:e.get("favourited"),title:z,icon:"star",iconComponent:e.get("favourited")?Q:X,onClick:this.handleFavouriteClick})}),n.jsx("div",{className:"detailed-status__button",children:n.jsx(S,{className:"bookmark-icon",disabled:!i,active:e.get("bookmarked"),title:W,icon:"bookmark",iconComponent:e.get("bookmarked")?Ve:$e,onClick:this.handleBookmarkClick})}),n.jsx("div",{className:"detailed-status__action-bar-dropdown",children:n.jsx(Ze,{icon:"ellipsis-h",iconComponent:Je,status:e,items:c,direction:"left",title:t.formatMessage(r.more)})})]})}}const at=$(tt)(L(F(st))),b=q({revealAll:{id:"status.show_more_all",defaultMessage:"Show more for all"},hideAll:{id:"status.show_less_all",defaultMessage:"Show less for all"},statusTitleWithAttachments:{id:"status.title.with_attachments",defaultMessage:"{user} posted {attachmentCount, plural, one {an attachment} other {# attachments}}"},detailedStatus:{id:"status.detailed_status",defaultMessage:"Detailed conversation view"}}),ot=()=>{const l=ze(),d=Ge();return(s,t)=>{const i=l(s,{id:t.params.statusId,contextType:"detailed"});let o=[],p=[];return i&&(o=Xe(s,i.get("in_reply_to_id")),p=et(s,i.get("id"))),{isLoading:s.getIn(["statuses",t.params.statusId,"isLoading"]),status:i,ancestorsIds:o,descendantsIds:p,askReplyConfirmation:s.getIn(["compose","text"]).trim().length!==0,domain:s.getIn(["meta","domain"]),pictureInPicture:d(s,{id:t.params.statusId})}}},it=(l,d)=>{const e=Array.from(l);return e.length>d?e.slice(0,d).join("")+"â€¦":l},nt=(l,d)=>{const e=d.getIn(["account","display_name"]),s=d.getIn(["account","username"]),t=e.trim().length===0?s:e,i=d.get("search_index"),o=d.get("media_attachments").size;return i?`${t}: "${it(i,30)}"`:l.formatMessage(b.statusTitleWithAttachments,{user:t,attachmentCount:o})};class K extends ne{constructor(){super(...arguments);a(this,"state",{fullscreen:!1,showMedia:A(this.props.status),loadedStatusId:void 0});a(this,"handleToggleMediaVisibility",()=>{this.setState({showMedia:!this.state.showMedia})});a(this,"handleFavouriteClick",e=>{const{dispatch:s}=this.props,{signedIn:t}=this.props.identity;s(t?ce(e.get("id")):f({modalType:"INTERACTION",modalProps:{type:"favourite",accountId:e.getIn(["account","id"]),url:e.get("uri")}}))});a(this,"handlePin",e=>{e.get("pinned")?this.props.dispatch(pe(e)):this.props.dispatch(he(e))});a(this,"handleReplyClick",e=>{const{askReplyConfirmation:s,dispatch:t}=this.props,{signedIn:i}=this.props.identity;t(i?s?f({modalType:"CONFIRM_REPLY",modalProps:{status:e}}):ue(e):f({modalType:"INTERACTION",modalProps:{type:"reply",accountId:e.getIn(["account","id"]),url:e.get("uri")}}))});a(this,"handleReblogClick",(e,s)=>{const{dispatch:t}=this.props,{signedIn:i}=this.props.identity;t(i?me(e.get("id"),s&&s.shiftKey):f({modalType:"INTERACTION",modalProps:{type:"reblog",accountId:e.getIn(["account","id"]),url:e.get("uri")}}))});a(this,"handleBookmarkClick",e=>{e.get("bookmarked")?this.props.dispatch(ge(e)):this.props.dispatch(fe(e))});a(this,"handleDeleteClick",(e,s=!1)=>{const{dispatch:t}=this.props;t(We?f({modalType:"CONFIRM_DELETE_STATUS",modalProps:{statusId:e.get("id"),withRedraft:s}}):ke(e.get("id"),s))});a(this,"handleEditClick",e=>{const{dispatch:s,askReplyConfirmation:t}=this.props;s(t?f({modalType:"CONFIRM_EDIT_STATUS",modalProps:{statusId:e.get("id")}}):Me(e.get("id")))});a(this,"handleDirectClick",e=>{this.props.dispatch(be(e))});a(this,"handleMentionClick",e=>{this.props.dispatch(Ce(e))});a(this,"handleOpenMedia",(e,s,t)=>{this.props.dispatch(f({modalType:"MEDIA",modalProps:{statusId:this.props.status.get("id"),media:e,index:s,lang:t}}))});a(this,"handleOpenVideo",(e,s,t)=>{this.props.dispatch(f({modalType:"VIDEO",modalProps:{statusId:this.props.status.get("id"),media:e,lang:s,options:t}}))});a(this,"handleHotkeyOpenMedia",e=>{const{status:s}=this.props;e.preventDefault(),s.get("media_attachments").size>0&&(s.getIn(["media_attachments",0,"type"])==="video"?this.handleOpenVideo(s.getIn(["media_attachments",0]),{startTime:0}):this.handleOpenMedia(s.get("media_attachments"),0))});a(this,"handleMuteClick",e=>{this.props.dispatch(ve(e))});a(this,"handleConversationMuteClick",e=>{e.get("muted")?this.props.dispatch(ye(e.get("id"))):this.props.dispatch(Ie(e.get("id")))});a(this,"handleToggleHidden",e=>{e.get("hidden")?this.props.dispatch(H(e.get("id"))):this.props.dispatch(U(e.get("id")))});a(this,"handleToggleAll",()=>{const{status:e,ancestorsIds:s,descendantsIds:t}=this.props,i=[e.get("id")].concat(s,t);e.get("hidden")?this.props.dispatch(H(i)):this.props.dispatch(U(i))});a(this,"handleTranslate",e=>{const{dispatch:s}=this.props;e.get("translation")?s(_e(e.get("id"),e.get("poll"))):s(Te(e.get("id")))});a(this,"handleBlockClick",e=>{const{dispatch:s}=this.props,t=e.get("account");s(Se(t))});a(this,"handleReport",e=>{this.props.dispatch(Fe(e.get("account"),e))});a(this,"handleEmbed",e=>{this.props.dispatch(f({modalType:"EMBED",modalProps:{id:e.get("id")}}))});a(this,"handleUnmuteClick",e=>{this.props.dispatch(xe(e.get("id")))});a(this,"handleUnblockClick",e=>{this.props.dispatch(Re(e.get("id")))});a(this,"handleBlockDomainClick",e=>{this.props.dispatch(Oe(e))});a(this,"handleUnblockDomainClick",e=>{this.props.dispatch(Ne(e))});a(this,"handleHotkeyMoveUp",()=>{this.handleMoveUp(this.props.status.get("id"))});a(this,"handleHotkeyMoveDown",()=>{this.handleMoveDown(this.props.status.get("id"))});a(this,"handleHotkeyReply",e=>{e.preventDefault(),this.handleReplyClick(this.props.status)});a(this,"handleHotkeyFavourite",()=>{this.handleFavouriteClick(this.props.status)});a(this,"handleHotkeyBoost",()=>{this.handleReblogClick(this.props.status)});a(this,"handleHotkeyMention",e=>{e.preventDefault(),this.handleMentionClick(this.props.status.get("account"))});a(this,"handleHotkeyOpenProfile",()=>{this.props.history.push(`/@${this.props.status.getIn(["account","acct"])}`)});a(this,"handleHotkeyToggleHidden",()=>{this.handleToggleHidden(this.props.status)});a(this,"handleHotkeyToggleSensitive",()=>{this.handleToggleMediaVisibility()});a(this,"handleHotkeyTranslate",()=>{this.handleTranslate(this.props.status)});a(this,"handleMoveUp",e=>{const{status:s,ancestorsIds:t,descendantsIds:i}=this.props;if(e===s.get("id"))this._selectChild(t.length-1,!0);else{let o=t.indexOf(e);o===-1?(o=i.indexOf(e),this._selectChild(t.length+o,!0)):this._selectChild(o-1,!0)}});a(this,"handleMoveDown",e=>{const{status:s,ancestorsIds:t,descendantsIds:i}=this.props;if(e===s.get("id"))this._selectChild(t.length+1,!1);else{let o=t.indexOf(e);o===-1?(o=i.indexOf(e),this._selectChild(t.length+o+2,!1)):this._selectChild(o+1,!1)}});a(this,"setContainerRef",e=>{this.node=e});a(this,"setStatusRef",e=>{this.statusNode=e});a(this,"onFullScreenChange",()=>{this.setState({fullscreen:we()})});a(this,"shouldUpdateScroll",(e,{location:s})=>{var t,i,o;return((t=s.state)==null?void 0:t.mastodonModalKey)!==((o=(i=e==null?void 0:e.location)==null?void 0:i.state)==null?void 0:o.mastodonModalKey)?!1:this.statusNode?[0,this.statusNode.offsetTop]:!1})}UNSAFE_componentWillMount(){this.props.dispatch(j(this.props.params.statusId))}componentDidMount(){de(this.onFullScreenChange),this._scrollStatusIntoView()}UNSAFE_componentWillReceiveProps(e){e.params.statusId!==this.props.params.statusId&&e.params.statusId&&this.props.dispatch(j(e.params.statusId)),e.status&&e.status.get("id")!==this.state.loadedStatusId&&this.setState({showMedia:A(e.status),loadedStatusId:e.status.get("id")})}_selectChild(e,s){const t=this.node,i=t.querySelectorAll(".focusable")[e];i&&(s&&t.scrollTop>i.offsetTop?i.scrollIntoView(!0):!s&&t.scrollTop+t.clientHeight<i.offsetTop+i.offsetHeight&&i.scrollIntoView(!1),i.focus())}renderChildren(e,s){const{params:{statusId:t}}=this.props;return e.map((i,o)=>n.jsx(Ke,{id:i,onMoveUp:this.handleMoveUp,onMoveDown:this.handleMoveDown,contextType:"thread",previousId:o>0?e[o-1]:void 0,nextId:e[o+1]||s&&t,rootId:t},i))}_scrollStatusIntoView(){const{status:e,multiColumn:s}=this.props;e&&requestIdleCallback(()=>{var t,i,o;if((t=this.statusNode)==null||t.scrollIntoView(!0),!s){const p=(o=(i=document.querySelector(".column-header__wrapper"))==null?void 0:i.getBoundingClientRect())==null?void 0:o.bottom;p&&(document.scrollingElement||document.body).scrollBy(0,-p)}})}componentDidUpdate(e){var i;const{status:s,ancestorsIds:t}=this.props;s&&(t.length>e.ancestorsIds.length||((i=e.status)==null?void 0:i.get("id"))!==s.get("id"))&&this._scrollStatusIntoView()}componentWillUnmount(){De(this.onFullScreenChange)}render(){let e,s,t;const{isLoading:i,status:o,ancestorsIds:p,descendantsIds:h,intl:g,domain:m,multiColumn:C,pictureInPicture:k}=this.props,{fullscreen:c}=this.state;if(i)return n.jsx(O,{children:n.jsx(He,{})});if(o===null)return n.jsx(Pe,{multiColumn:C,errorType:"routing"});p&&p.length>0&&(e=n.jsx(n.Fragment,{children:this.renderChildren(p,!0)})),h&&h.length>0&&(s=n.jsx(n.Fragment,{children:this.renderChildren(h)}));const M=o.getIn(["account","acct"],"").indexOf("@")===-1,v=!o.getIn(["account","noindex"]);M||(t=n.jsx(Ue,{className:D(!!s&&"timeline-hint--with-descendants"),url:o.get("url"),message:n.jsx(N,{id:"hints.threads.replies_may_be_missing",defaultMessage:"Replies from other servers may be missing."}),label:n.jsx(N,{id:"hints.threads.see_more",defaultMessage:"See more replies on {domain}",values:{domain:n.jsx("strong",{children:o.getIn(["account","acct"]).split("@")[1]})}})}));const y={moveUp:this.handleHotkeyMoveUp,moveDown:this.handleHotkeyMoveDown,reply:this.handleHotkeyReply,favourite:this.handleHotkeyFavourite,boost:this.handleHotkeyBoost,mention:this.handleHotkeyMention,openProfile:this.handleHotkeyOpenProfile,toggleHidden:this.handleHotkeyToggleHidden,toggleSensitive:this.handleHotkeyToggleSensitive,openMedia:this.handleHotkeyOpenMedia,onTranslate:this.handleHotkeyTranslate};return n.jsxs(O,{bindToDocument:!C,label:g.formatMessage(b.detailedStatus),children:[n.jsx(qe,{showBackButton:!0,multiColumn:C,extraButton:n.jsx("button",{type:"button",className:"column-header__button",title:g.formatMessage(o.get("hidden")?b.revealAll:b.hideAll),"aria-label":g.formatMessage(o.get("hidden")?b.revealAll:b.hideAll),onClick:this.handleToggleAll,children:n.jsx(Be,{id:o.get("hidden")?"eye-slash":"eye",icon:o.get("hidden")?je:Qe})})}),n.jsx(Ae,{scrollKey:"thread",shouldUpdateScroll:this.shouldUpdateScroll,children:n.jsxs("div",{className:D("scrollable",{fullscreen:c}),ref:this.setContainerRef,children:[e,n.jsx(Ee.HotKeys,{handlers:y,children:n.jsxs("div",{className:D("focusable","detailed-status__wrapper",`detailed-status__wrapper-${o.get("visibility")}`),tabIndex:0,"aria-label":Le(g,o,!1),ref:this.setStatusRef,children:[n.jsx(Ye,{status:o,onOpenVideo:this.handleOpenVideo,onOpenMedia:this.handleOpenMedia,onToggleHidden:this.handleToggleHidden,onTranslate:this.handleTranslate,domain:m,showMedia:this.state.showMedia,onToggleMediaVisibility:this.handleToggleMediaVisibility,pictureInPicture:k},`details-${o.get("id")}`),n.jsx(at,{status:o,onReply:this.handleReplyClick,onFavourite:this.handleFavouriteClick,onReblog:this.handleReblogClick,onBookmark:this.handleBookmarkClick,onDelete:this.handleDeleteClick,onEdit:this.handleEditClick,onDirect:this.handleDirectClick,onMention:this.handleMentionClick,onMute:this.handleMuteClick,onUnmute:this.handleUnmuteClick,onMuteConversation:this.handleConversationMuteClick,onBlock:this.handleBlockClick,onUnblock:this.handleUnblockClick,onBlockDomain:this.handleBlockDomainClick,onUnblockDomain:this.handleUnblockDomainClick,onReport:this.handleReport,onPin:this.handlePin,onEmbed:this.handleEmbed},`action-bar-${o.get("id")}`)]})}),s,t]})}),n.jsxs(Y,{children:[n.jsx("title",{children:nt(g,o)}),n.jsx("meta",{name:"robots",content:M&&v?"all":"noindex"}),n.jsx("link",{rel:"canonical",href:o.get("url")})]})]})}}a(K,"propTypes",{identity:re,params:u.object.isRequired,dispatch:u.func.isRequired,status:E.map,isLoading:u.bool,ancestorsIds:u.arrayOf(u.string).isRequired,descendantsIds:u.arrayOf(u.string).isRequired,intl:u.object.isRequired,askReplyConfirmation:u.bool,multiColumn:u.bool,domain:u.string.isRequired,pictureInPicture:E.contains({inUse:u.bool,available:u.bool}),...le});const is=J(F($(ot)(L(K))));export{is as default};
//# sourceMappingURL=status-index-CoorrJYP.js.map
