import{j as e}from"./client-wT6vtYO_.js";import{F as h,r as u}from"./index-BdTwX--g.js";import{u as g,a as c,a3 as y,e9 as f,dP as b}from"./useSelectableClick-DeaJbL2_.js";import{b as v,c as w}from"./api-B2m7efUy.js";import{L as N}from"./loading_indicator-7xMB1U6D.js";import{e as d,d as M}from"./initial_state-BP3UcUr4.js";import{M as r}from"./message-UFwkQlnu.js";import{b as x}from"./index-DwQAxx91.js";import{S as k}from"./short_number-WomMu2iV.js";import{D as S}from"./detailed_status-BXIq3on5.js";import{m as T,a as L}from"./index-OwtqmxAM.js";import"./index-CAH5FfLP.js";import"./ready-DpOgoWSg.js";import"./load_locale-tOpKhmcM.js";import"./index-lj9VQs0f.js";import"./index-DizoKcfL.js";import"./numbers-CGZQWBYL.js";import"./content_warning-DZ8mar1O.js";import"./skeleton-D9NbTYr9.js";import"./formatted_date-jZOhBAMt.js";import"./inline_account-Dg3-UMsJ.js";import"./status-CiF0hsk4.js";import"./index.es-B0ZBMj49.js";import"./card-CttmBekj.js";import"./avatar_overlay-BeG39OK4.js";import"./toString-Cy1Ecq9L.js";import"./status_content-CaIN8-0B.js";import"./poll-CjurB963.js";import"./permissions-Djze7cmB.js";import"./visibility_icon-DbVVvHFb.js";import"./media_gallery-DTAKF-fT.js";import"./alt_text_badge-CwO3PXb3.js";import"./status_quoted-COu-QToA.js";import"./domain_blocks-CYnp0hav.js";import"./reports-DBOcsYZF.js";import"./schedule_idle_task-Co3Ydhdu.js";const P="/packs/assets/booster-D4MlHOpG.png",F="/packs/assets/lurker-B6QPjXAC.png",H="/packs/assets/oracle-FU_DivV9.png",D="/packs/assets/pollster-DcMg7jZv.png",E="/packs/assets/replier-DRa-Lscp.png",R=({data:t})=>{let s,a;switch(t){case"booster":s=P,a=e.jsx(r,{id:"annual_report.summary.archetype.booster",defaultMessage:"The cool-hunter"});break;case"replier":s=E,a=e.jsx(r,{id:"annual_report.summary.archetype.replier",defaultMessage:"The social butterfly"});break;case"pollster":s=D,a=e.jsx(r,{id:"annual_report.summary.archetype.pollster",defaultMessage:"The pollster"});break;case"lurker":s=F,a=e.jsx(r,{id:"annual_report.summary.archetype.lurker",defaultMessage:"The lurker"});break;case"oracle":s=H,a=e.jsx(r,{id:"annual_report.summary.archetype.oracle",defaultMessage:"The oracle"});break}return e.jsxs("div",{className:"annual-report__bento__box annual-report__summary__archetype",children:[e.jsx("div",{className:"annual-report__summary__archetype__label",children:a}),e.jsx("img",{src:s,alt:""})]})},A=({data:t,total:s})=>{const a=t.reduce((o,n)=>o+n.followers,0),i=t.reduce((o,n)=>[...o,n.followers+(o[o.length-1]??0)],[0]);return e.jsxs("div",{className:"annual-report__bento__box annual-report__summary__followers",children:[e.jsxs(x.Sparklines,{data:i,margin:0,children:[e.jsx("svg",{children:e.jsx("defs",{children:e.jsxs("linearGradient",{id:"gradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"var(--sparkline-gradient-top)",stopOpacity:"1"}),e.jsx("stop",{offset:"100%",stopColor:"var(--sparkline-gradient-bottom)",stopOpacity:"0"})]})})}),e.jsx(x.SparklinesCurve,{style:{fill:"none"}})]}),e.jsxs("div",{className:"annual-report__summary__followers__foreground",children:[e.jsxs("div",{className:"annual-report__summary__followers__number",children:[a>-1?"+":"-",e.jsx(h,{value:a})]}),e.jsxs("div",{className:"annual-report__summary__followers__label",children:[e.jsx("span",{children:e.jsx(r,{id:"annual_report.summary.followers.followers",defaultMessage:"followers"})}),e.jsx("div",{className:"annual-report__summary__followers__footnote",children:e.jsx(r,{id:"annual_report.summary.followers.total",defaultMessage:"{count} total",values:{count:e.jsx(k,{value:s??0})}})})]})]})]})},G=T(),I=L(),q=({data:t})=>{let s,a;t.by_reblogs?(s=t.by_reblogs,a=e.jsx(r,{id:"annual_report.summary.highlighted_post.by_reblogs",defaultMessage:"most boosted post"})):t.by_favourites?(s=t.by_favourites,a=e.jsx(r,{id:"annual_report.summary.highlighted_post.by_favourites",defaultMessage:"most favourited post"})):(s=t.by_replies,a=e.jsx(r,{id:"annual_report.summary.highlighted_post.by_replies",defaultMessage:"post with the most replies"}));const i=g(),o=c(p=>p.meta.get("domain")),n=c(p=>s?G(p,{id:s}):void 0),_=c(p=>s?I(p,{id:s}):void 0),l=c(p=>d?p.accounts.get(d):void 0),m=u.useCallback(()=>{i(y(s))},[i,s]);if(!n)return e.jsx("div",{className:"annual-report__bento__box annual-report__summary__most-boosted-post"});const j=e.jsxs("span",{className:"display-name",children:[e.jsx("strong",{className:"display-name__html",children:e.jsx(r,{id:"annual_report.summary.highlighted_post.possessive",defaultMessage:"{name}'s",values:{name:l&&e.jsx("bdi",{dangerouslySetInnerHTML:{__html:l.display_name_html}})}})}),e.jsx("span",{className:"display-name__account",children:a})]});return e.jsx("div",{className:"annual-report__bento__box annual-report__summary__most-boosted-post",children:e.jsx(S,{status:n,pictureInPicture:_,domain:o,onToggleHidden:m,overrideDisplayName:j})})},C=({data:t})=>{const s=t[0];return e.jsxs("div",{className:"annual-report__bento__box annual-report__summary__most-used-hashtag",children:[e.jsx("div",{className:"annual-report__summary__most-used-hashtag__hashtag",children:s?e.jsxs(e.Fragment,{children:["#",s.name]}):e.jsx(r,{id:"annual_report.summary.most_used_hashtag.none",defaultMessage:"None"})}),e.jsx("div",{className:"annual-report__summary__most-used-hashtag__label",children:e.jsx(r,{id:"annual_report.summary.most_used_hashtag.most_used_hashtag",defaultMessage:"most used hashtag"})})]})},O=t=>u.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:24,viewBox:"0 -960 960 960",width:24,...t},u.createElement("path",{d:"M80-80v-720q0-33 23.5-56.5T160-880h640q33 0 56.5 23.5T880-800v480q0 33-23.5 56.5T800-240H240L80-80Zm126-240h594v-480H160v525l46-45Zm-46 0v-480 480Z"})),U=({data:t})=>{const s=t.reduce((a,i)=>a+i.statuses,0);return e.jsxs("div",{className:"annual-report__bento__box annual-report__summary__new-posts",children:[e.jsxs("svg",{width:500,height:500,children:[e.jsx("defs",{children:e.jsxs("pattern",{id:"posts",x:"0",y:"0",width:"32",height:"35",patternUnits:"userSpaceOnUse",children:[e.jsx("circle",{cx:"12",cy:"12",r:"12",fill:"var(--lime)"}),e.jsx(O,{fill:"var(--indigo-1)",x:"4",y:"4",width:"16",height:"16"})]})}),e.jsx("rect",{width:500,height:500,fill:"url(#posts)",style:{opacity:.2}})]}),e.jsx("div",{className:"annual-report__summary__new-posts__number",children:e.jsx(h,{value:s})}),e.jsx("div",{className:"annual-report__summary__new-posts__label",children:e.jsx(r,{id:"annual_report.summary.new_posts.new_posts",defaultMessage:"new posts"})})]})},Z=({data:t})=>{const s=t.statuses;return e.jsx("div",{className:"annual-report__bento__box annual-report__summary__percentile",children:e.jsx(r,{id:"annual_report.summary.percentile.text",defaultMessage:"<topLabel>That puts you in the top</topLabel><percentage></percentage><bottomLabel>of {domain} users.</bottomLabel>",values:{topLabel:a=>e.jsx("div",{className:"annual-report__summary__percentile__label",children:a}),percentage:()=>e.jsx("div",{className:"annual-report__summary__percentile__number",children:e.jsx(h,{value:Math.min(s,99)/100,style:"percent",maximumFractionDigits:s<1?1:0})}),bottomLabel:a=>e.jsxs("div",{children:[e.jsx("div",{className:"annual-report__summary__percentile__label",children:a}),s<6&&e.jsx("div",{className:"annual-report__summary__percentile__footnote",children:e.jsx(r,{id:"annual_report.summary.percentile.we_wont_tell_bernie",defaultMessage:"We won't tell Bernie."})})]}),domain:M},children:a=>e.jsx(e.Fragment,{children:a})})})},B=({year:t})=>{const[s,a]=u.useState(null),[i,o]=u.useState(!1),n=c(m=>d?m.accounts.get(d):void 0),_=g();if(u.useEffect(()=>{o(!0),v(`v1/annual_reports/${t}`).then(m=>(_(f(m.statuses)),_(b(m.accounts)),a(m),o(!1),w(`v1/annual_reports/${t}/read`))).catch(()=>{o(!1)})},[_,t,a,o]),i)return e.jsx(N,{});const l=s==null?void 0:s.annual_reports[0];return l?e.jsxs("div",{className:"annual-report",children:[e.jsxs("div",{className:"annual-report__header",children:[e.jsx("h1",{children:e.jsx(r,{id:"annual_report.summary.thanks",defaultMessage:"Thanks for being part of Mastodon!"})}),e.jsx("p",{children:e.jsx(r,{id:"annual_report.summary.here_it_is",defaultMessage:"Here is your {year} in review:",values:{year:l.year}})})]}),e.jsxs("div",{className:"annual-report__bento annual-report__summary",children:[e.jsx(R,{data:l.data.archetype}),e.jsx(q,{data:l.data.top_statuses}),e.jsx(A,{data:l.data.time_series,total:n==null?void 0:n.followers_count}),e.jsx(C,{data:l.data.top_hashtags}),e.jsx(Z,{data:l.data.percentiles}),e.jsx(U,{data:l.data.time_series})]})]}):null},Se=({year:t,onChangeBackgroundColor:s})=>(u.useEffect(()=>{s("var(--indigo-1)")},[s]),e.jsx("div",{className:"modal-root__modal annual-report-modal",children:e.jsx(B,{year:t})}));export{Se as default};
//# sourceMappingURL=annual_report_modal-6WwTpkZX.js.map
