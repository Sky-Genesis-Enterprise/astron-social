var v=Object.defineProperty;var f=(s,t,r)=>t in s?v(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r;var j=(s,t,r)=>f(s,typeof t!="symbol"?t+"":t,r);import{j as e}from"./client-wT6vtYO_.js";import{r as y,F as _,b}from"./index-BdTwX--g.js";import{c as u}from"./index-DizoKcfL.js";import{a as N}from"./api-B2m7efUy.js";import{r as p}from"./numbers-CGZQWBYL.js";import{M as l}from"./message-UFwkQlnu.js";import"./index-lj9VQs0f.js";import"./initial_state-BP3UcUr4.js";import"./ready-DpOgoWSg.js";const M=s=>{const t="UTC";switch(s.frequency){case"day":return e.jsx(b,{value:s.period,month:"long",day:"2-digit",timeZone:t});default:return e.jsx(b,{value:s.period,month:"long",year:"numeric",timeZone:t})}};class T extends y.PureComponent{constructor(){super(...arguments);j(this,"state",{loading:!0,data:null})}componentDidMount(){const{start_at:r,end_at:i,frequency:c}=this.props;N(!1).post("/api/v1/admin/retention",{start_at:r,end_at:i,frequency:c}).then(d=>{this.setState({loading:!1,data:d.data})}).catch(d=>{console.error(d)})}render(){const{loading:r,data:i}=this.state,{frequency:c}=this.props;let d;r?d=e.jsx(l,{id:"loading_indicator.label",defaultMessage:"Loadingâ€¦"}):d=e.jsxs("table",{className:"retention__table",children:[e.jsxs("thead",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("div",{className:"retention__table__date retention__table__label",children:e.jsx(l,{id:"admin.dashboard.retention.cohort",defaultMessage:"Sign-up month"})})}),e.jsx("th",{children:e.jsx("div",{className:"retention__table__number retention__table__label",children:e.jsx(l,{id:"admin.dashboard.retention.cohort_size",defaultMessage:"New users"})})}),i[0].data.slice(1).map((a,n)=>e.jsx("th",{children:e.jsx("div",{className:"retention__table__number retention__table__label",children:n+1})},a.date))]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("div",{className:"retention__table__date retention__table__average",children:e.jsx(l,{id:"admin.dashboard.retention.average",defaultMessage:"Average"})})}),e.jsx("td",{children:e.jsx("div",{className:"retention__table__size",children:e.jsx(_,{value:i.reduce((a,n,o)=>a+(n.data[0].value*1-a)/(o+1),0),maximumFractionDigits:0})})}),i[0].data.slice(1).map((a,n)=>{const o=i.reduce((x,h,g)=>h.data[n+1]?x+(h.data[n+1].rate-x)/(g+1):x,0);return e.jsx("td",{children:e.jsx("div",{className:u("retention__table__box","retention__table__average",`retention__table__box--${p(o*100)}`),children:e.jsx(_,{value:o,style:"percent"})})},a.date)})]})]}),e.jsx("tbody",{children:i.slice(0,-1).map(a=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("div",{className:"retention__table__date",children:M(a)})}),e.jsx("td",{children:e.jsx("div",{className:"retention__table__size",children:e.jsx(_,{value:a.data[0].value})})}),a.data.slice(1).map(n=>e.jsx("td",{children:e.jsx("div",{className:u("retention__table__box",`retention__table__box--${p(n.rate*100)}`),children:e.jsx(_,{value:n.rate,style:"percent"})})},n.date))]},a.period))})]});let m=null;switch(c){case"day":m=e.jsx(l,{id:"admin.dashboard.daily_retention",defaultMessage:"User retention rate by day after sign-up"});break;default:m=e.jsx(l,{id:"admin.dashboard.monthly_retention",defaultMessage:"User retention rate by month after sign-up"})}return e.jsxs("div",{className:"retention",children:[e.jsx("h4",{children:m}),d]})}}export{T as default};
//# sourceMappingURL=Retention-DkRq0bhb.js.map
