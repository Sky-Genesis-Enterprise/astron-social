{"version":3,"file":"Dimension-Dva9I8Z_.js","sources":["../../app/javascript/mastodon/components/admin/Dimension.jsx"],"sourcesContent":["import PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\n\nimport { FormattedNumber } from 'react-intl';\n\nimport api from 'mastodon/api';\nimport { Skeleton } from 'mastodon/components/skeleton';\nimport { roundTo10 } from 'mastodon/utils/numbers';\n\nexport default class Dimension extends PureComponent {\n\n  static propTypes = {\n    dimension: PropTypes.string.isRequired,\n    start_at: PropTypes.string.isRequired,\n    end_at: PropTypes.string.isRequired,\n    limit: PropTypes.number.isRequired,\n    label: PropTypes.string.isRequired,\n    params: PropTypes.object,\n  };\n\n  state = {\n    loading: true,\n    data: null,\n  };\n\n  componentDidMount () {\n    const { start_at, end_at, dimension, limit, params } = this.props;\n\n    api(false).post('/api/v1/admin/dimensions', { keys: [dimension], start_at, end_at, limit, [dimension]: params }).then(res => {\n      this.setState({\n        loading: false,\n        data: res.data,\n      });\n    }).catch(err => {\n      console.error(err);\n    });\n  }\n\n  render () {\n    const { label, limit } = this.props;\n    const { loading, data } = this.state;\n\n    let content;\n\n    if (loading) {\n      content = (\n        <table>\n          <tbody>\n            {Array.from(Array(limit)).map((_, i) => (\n              <tr className='dimension__item' key={i}>\n                <td className='dimension__item__key'>\n                  <Skeleton width={100} />\n                </td>\n\n                <td className='dimension__item__value'>\n                  <Skeleton width={60} />\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      );\n    } else {\n      const sum = data[0].data.reduce((sum, cur) => sum + (cur.value * 1), 0);\n\n      content = (\n        <table>\n          <tbody>\n            {data[0].data.map(item => (\n              <tr className='dimension__item' key={item.key}>\n                <td className='dimension__item__key'>\n                  <span className={`dimension__item__indicator dimension__item__indicator--${roundTo10(((item.value * 1) / sum) * 100)}`} />\n                  <span title={item.key}>{item.human_key}</span>\n                </td>\n\n                <td className='dimension__item__value'>\n                  {typeof item.human_value !== 'undefined' ? item.human_value : <FormattedNumber value={item.value} />}\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      );\n    }\n\n    return (\n      <div className='dimension'>\n        <h4>{label}</h4>\n\n        {content}\n      </div>\n    );\n  }\n\n}\n"],"names":["Dimension","PureComponent","state","loading","data","componentDidMount","start_at","end_at","dimension","limit","params","props","api","post","keys","then","res","setState","catch","err","console","error","render","label","content","jsx","Array","from","map","_","i","jsxs","Skeleton","sum","reduce","cur","value","item","roundTo10","key","human_key","human_value","FormattedNumber"],"mappings":"mdASA,MAAqBA,UAAkBC,EAAAA,aAAc,CAArD,kCAWEC,EAAAA,aAAQ,CACNC,QAAS,GACTC,KAAM,IAAA,GAGRC,mBAAqB,CACnB,KAAM,CAAEC,SAAAA,EAAUC,OAAAA,EAAQC,UAAAA,EAAWC,MAAAA,EAAOC,OAAAA,CAAAA,EAAW,KAAKC,MAE5DC,EAAI,EAAK,EAAEC,KAAK,2BAA4B,CAAEC,KAAM,CAACN,CAAS,EAAGF,SAAAA,EAAUC,OAAAA,EAAQE,MAAAA,EAAO,CAACD,CAAS,EAAGE,CAAAA,CAAQ,EAAEK,KAAKC,GAAO,CAC3H,KAAKC,SAAS,CACZd,QAAS,GACTC,KAAMY,EAAIZ,IAAAA,CACX,CAAA,CACF,EAAEc,MAAMC,GAAO,CACdC,QAAQC,MAAMF,CAAG,CAAA,CAClB,CAAA,CAGHG,QAAU,CACR,KAAM,CAAEC,MAAAA,EAAOd,MAAAA,CAAAA,EAAU,KAAKE,MACxB,CAAER,QAAAA,EAASC,KAAAA,CAAAA,EAAS,KAAKF,MAE/B,IAAIsB,EAEJ,GAAIrB,EACFqB,QACG,QAAA,CACC,SAAAC,MAAC,QAAA,CACEC,SAAAA,MAAMC,KAAKD,MAAMjB,CAAK,CAAC,EAAEmB,IAAI,CAACC,EAAGC,IAChCC,OAAC,KAAA,CAAG,UAAU,kBACZ,SAAA,CAAAN,EAAAA,IAAC,MAAG,UAAU,uBACZ,eAACO,EAAA,CAAS,MAAO,IAAI,CAAA,CACvB,EAEAP,EAAAA,IAAC,MAAG,UAAU,yBACZ,eAACO,EAAA,CAAS,MAAO,GAAG,CAAA,CACtB,CAAA,CAAA,EAPmCF,CAQrC,CACD,CAAA,CACH,EACF,MAEG,CACL,MAAMG,EAAM7B,EAAK,CAAC,EAAEA,KAAK8B,OAAO,CAACD,EAAKE,IAAQF,EAAOE,EAAIC,MAAQ,EAAI,CAAC,EAEtEZ,EACEC,EAAAA,IAAC,QAAA,CACC,SAAAA,EAAAA,IAAC,QAAA,CACErB,SAAAA,EAAK,CAAC,EAAEA,KAAKwB,IAAIS,GAChBN,EAAAA,KAAC,KAAA,CAAG,UAAU,kBACZ,SAAA,CAAAA,EAAAA,KAAC,KAAA,CAAG,UAAU,uBACZ,SAAA,CAAAN,EAAAA,IAAC,OAAA,CAAK,UAAW,0DAA0Da,EAAYD,EAAKD,MAAQ,EAAKH,EAAO,GAAG,CAAC,EAAA,CAAG,QACtH,OAAA,CAAK,MAAOI,EAAKE,IAAMF,WAAKG,SAAAA,CAAU,CAAA,EACzC,EAEAf,EAAAA,IAAC,KAAA,CAAG,UAAU,yBACX,gBAAOY,EAAKI,YAAgB,IAAcJ,EAAKI,YAAchB,EAAAA,IAACiB,EAAA,CAAgB,MAAOL,EAAKD,MAAM,CAAA,CACnG,CAAA,CAAA,EARmCC,EAAKE,GAS1C,CACD,CAAA,CACH,CAAA,CACF,CAAA,CAIJ,OACER,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAN,EAAAA,IAAC,MAAIF,SAAAA,CAAAA,CAAM,EAEVC,CAAAA,EACH,CAAA,CAIN"}