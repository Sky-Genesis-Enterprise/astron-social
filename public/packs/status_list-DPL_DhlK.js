var P=Object.defineProperty;var D=(n,i,o)=>i in n?P(n,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[i]=o;var h=(n,i,o)=>D(n,typeof i!="symbol"?i+"":i,o);import{j as e}from"./client-wT6vtYO_.js";import{L as M,P as a}from"./short_number-WomMu2iV.js";import{u as L,a as x,cU as F,aM as R,I as j,aQ as H,cV as z,b as E,A as W,y as U,z as v,H as O,cW as V,cX as G}from"./useSelectableClick-DeaJbL2_.js";import{u as S,r as c,d as A}from"./index-BdTwX--g.js";import{G as B}from"./gif-BtN1axMk.js";import{M as u}from"./message-UFwkQlnu.js";import{S as $}from"./chevron_left-CnYIoVsW.js";import{S as q}from"./close-BsPe8EbX.js";import{S as K}from"./info-HtHaDKcq.js";import{D as Q}from"./content_warning-DZ8mar1O.js";import{F as X}from"./follow_button-BdqDKUmA.js";import{V as J}from"./verified_badge-CtK79Pb7.js";import{d as b}from"./initial_state-BP3UcUr4.js";import{S as I}from"./status_quoted-COu-QToA.js";import{L as Y}from"./load_gap-6rwcZCuh.js";import{S as Z}from"./scrollable_list-lNykmhKA.js";const ee=()=>e.jsxs("div",{className:"regeneration-indicator",children:[e.jsx(B,{src:"/loading.gif",staticSrc:"/loading.png",className:"regeneration-indicator__figure"}),e.jsxs("div",{className:"regeneration-indicator__label",children:[e.jsx("strong",{children:e.jsx(u,{id:"regeneration_indicator.preparing_your_home_feed",defaultMessage:"Preparing your home feedâ€¦"})}),e.jsx(u,{id:"regeneration_indicator.please_stand_by",defaultMessage:"Please stand by."})]})]}),m=A({follow:{id:"account.follow",defaultMessage:"Follow"},unfollow:{id:"account.unfollow",defaultMessage:"Unfollow"},previous:{id:"lightbox.previous",defaultMessage:"Previous"},next:{id:"lightbox.next",defaultMessage:"Next"},dismiss:{id:"follow_suggestions.dismiss",defaultMessage:"Don't show again"},friendsOfFriendsHint:{id:"follow_suggestions.hints.friends_of_friends",defaultMessage:"This profile is popular among the people you follow."},similarToRecentlyFollowedHint:{id:"follow_suggestions.hints.similar_to_recently_followed",defaultMessage:"This profile is similar to the profiles you have most recently followed."},featuredHint:{id:"follow_suggestions.hints.featured",defaultMessage:"This profile has been hand-picked by the {domain} team."},mostFollowedHint:{id:"follow_suggestions.hints.most_followed",defaultMessage:"This profile is one of the most followed on {domain}."},mostInteractionsHint:{id:"follow_suggestions.hints.most_interactions",defaultMessage:"This profile has been recently getting a lot of attention on {domain}."}}),se=({id:n})=>{const i=S();let o,s;switch(n){case"friends_of_friends":s=i.formatMessage(m.friendsOfFriendsHint),o=e.jsx(u,{id:"follow_suggestions.personalized_suggestion",defaultMessage:"Personalized suggestion"});break;case"similar_to_recently_followed":s=i.formatMessage(m.similarToRecentlyFollowedHint),o=e.jsx(u,{id:"follow_suggestions.personalized_suggestion",defaultMessage:"Personalized suggestion"});break;case"featured":s=i.formatMessage(m.featuredHint,{domain:b}),o=e.jsx(u,{id:"follow_suggestions.curated_suggestion",defaultMessage:"Staff pick"});break;case"most_followed":s=i.formatMessage(m.mostFollowedHint,{domain:b}),o=e.jsx(u,{id:"follow_suggestions.popular_suggestion",defaultMessage:"Popular suggestion"});break;case"most_interactions":s=i.formatMessage(m.mostInteractionsHint,{domain:b}),o=e.jsx(u,{id:"follow_suggestions.popular_suggestion",defaultMessage:"Popular suggestion"});break}return e.jsxs("div",{className:"inline-follow-suggestions__body__scrollable__card__text-stack__source",title:s,children:[e.jsx(j,{id:"",icon:K}),o]})},oe=({id:n,sources:i})=>{const o=S(),s=x(f=>f.accounts.get(n)),l=s==null?void 0:s.fields.find(f=>!!f.verified_at),r=L(),t=c.useCallback(()=>{r(z({accountId:n}))},[n,r]);return e.jsxs("div",{className:"inline-follow-suggestions__body__scrollable__card",children:[e.jsx(E,{icon:"",iconComponent:q,onClick:t,title:o.formatMessage(m.dismiss)}),e.jsx("div",{className:"inline-follow-suggestions__body__scrollable__card__avatar",children:e.jsx(M,{to:`/@${s==null?void 0:s.acct}`,"data-hover-card-account":s==null?void 0:s.id,children:e.jsx(W,{account:s,size:72})})}),e.jsxs("div",{className:"inline-follow-suggestions__body__scrollable__card__text-stack",children:[e.jsx(M,{to:`/@${s==null?void 0:s.acct}`,"data-hover-card-account":s==null?void 0:s.id,children:e.jsx(Q,{account:s})}),l?e.jsx(J,{link:l.value}):e.jsx(se,{id:i[0]})]}),e.jsx(X,{accountId:n})]})},y="home/follow-suggestions",te=({hidden:n})=>{const i=S(),o=L(),s=x(g=>g.suggestions.items),l=x(g=>g.suggestions.isLoading),r=x(g=>g.settings.getIn(["dismissed_banners",y])),t=c.useRef(null),[f,_]=c.useState(!1),[p,d]=c.useState(!0);c.useEffect(()=>{o(F())},[o]),c.useEffect(()=>{t.current&&(getComputedStyle(t.current).direction==="rtl"?(_(t.current.clientWidth-t.current.scrollLeft<t.current.scrollWidth),d(t.current.scrollLeft<0)):(_(t.current.scrollLeft>0),d(t.current.scrollLeft+t.current.clientWidth<t.current.scrollWidth)))},[d,_,s]);const w=c.useCallback(()=>{t.current&&(t.current.scrollLeft-=200)},[]),N=c.useCallback(()=>{t.current&&(t.current.scrollLeft+=200)},[]),k=c.useCallback(()=>{t.current&&(getComputedStyle(t.current).direction==="rtl"?(_(t.current.clientWidth-t.current.scrollLeft<t.current.scrollWidth),d(t.current.scrollLeft<0)):(_(t.current.scrollLeft>0),d(t.current.scrollLeft+t.current.clientWidth<t.current.scrollWidth)))},[d,_]),T=c.useCallback(()=>{o(R(["dismissed_banners",y],!0))},[o]);return r||!l&&s.length===0?null:n?e.jsx("div",{className:"inline-follow-suggestions"}):e.jsxs("div",{className:"inline-follow-suggestions",children:[e.jsxs("div",{className:"inline-follow-suggestions__header",children:[e.jsx("h3",{children:e.jsx(u,{id:"follow_suggestions.who_to_follow",defaultMessage:"Who to follow"})}),e.jsxs("div",{className:"inline-follow-suggestions__header__actions",children:[e.jsx("button",{className:"link-button",onClick:T,children:e.jsx(u,{id:"follow_suggestions.dismiss",defaultMessage:"Don't show again"})}),e.jsx(M,{to:"/explore/suggestions",className:"link-button",children:e.jsx(u,{id:"follow_suggestions.view_all",defaultMessage:"View all"})})]})]}),e.jsxs("div",{className:"inline-follow-suggestions__body",children:[e.jsx("div",{className:"inline-follow-suggestions__body__scrollable",ref:t,onScroll:k,children:s.map(g=>e.jsx(oe,{id:g.account_id,sources:g.sources},g.account_id))}),f&&e.jsx("button",{className:"inline-follow-suggestions__body__scroll-button left",onClick:w,"aria-label":i.formatMessage(m.previous),children:e.jsx("div",{className:"inline-follow-suggestions__body__scroll-button__icon",children:e.jsx(j,{id:"",icon:$})})}),p&&e.jsx("button",{className:"inline-follow-suggestions__body__scroll-button right",onClick:N,"aria-label":i.formatMessage(m.next),children:e.jsx("div",{className:"inline-follow-suggestions__body__scroll-button__icon",children:e.jsx(j,{id:"",icon:H})})})]})]})};class C extends U{constructor(){super(...arguments);h(this,"getFeaturedStatusCount",()=>this.props.featuredStatusIds?this.props.featuredStatusIds.size:0);h(this,"getCurrentStatusIndex",(o,s)=>s?this.props.featuredStatusIds.indexOf(o):this.props.statusIds.indexOf(o)+this.getFeaturedStatusCount());h(this,"handleMoveUp",(o,s)=>{const l=this.getCurrentStatusIndex(o,s)-1;this._selectChild(l,!0)});h(this,"handleMoveDown",(o,s)=>{const l=this.getCurrentStatusIndex(o,s)+1;this._selectChild(l,!1)});h(this,"handleLoadOlder",O(()=>{const{statusIds:o,lastId:s,onLoadMore:l}=this.props;l(s||(o.size>0?o.last():void 0))},300,{leading:!0}));h(this,"setRef",o=>{this.node=o})}_selectChild(o,s){const l=this.node.node,r=l.querySelector(`article:nth-of-type(${o+1}) .focusable`);r&&(s&&l.scrollTop>r.offsetTop?r.scrollIntoView(!0):!s&&l.scrollTop+l.clientHeight<r.offsetTop+r.offsetHeight&&r.scrollIntoView(!1),r.focus())}render(){const{statusIds:o,featuredStatusIds:s,onLoadMore:l,timelineId:r,...t}=this.props,{isLoading:f,isPartial:_}=t;if(_)return e.jsx(ee,{});let p=f||o.size>0?o.map((d,w)=>{switch(d){case G:return e.jsx(te,{},"inline-follow-suggestions");case V:return e.jsx(Y,{disabled:f,param:w>0?o.get(w-1):null,onClick:l},"gap:"+o.get(w+1));default:return e.jsx(I,{id:d,onMoveUp:this.handleMoveUp,onMoveDown:this.handleMoveDown,contextType:r,scrollKey:this.props.scrollKey,showThread:!0,withCounters:this.props.withCounters},d)}}):null;return p&&s&&(p=s.map(d=>e.jsx(I,{id:d,featured:!0,onMoveUp:this.handleMoveUp,onMoveDown:this.handleMoveDown,contextType:r,showThread:!0,withCounters:this.props.withCounters},`f-${d}`)).concat(p)),e.jsx(Z,{...t,showLoading:f&&o.size===0,onLoadMore:l&&this.handleLoadOlder,ref:this.setRef,children:p})}}h(C,"propTypes",{scrollKey:a.string.isRequired,statusIds:v.list.isRequired,featuredStatusIds:v.list,onLoadMore:a.func,onScrollToTop:a.func,onScroll:a.func,trackScroll:a.bool,isLoading:a.bool,isPartial:a.bool,hasMore:a.bool,prepend:a.node,emptyMessage:a.node,alwaysPrepend:a.bool,withCounters:a.bool,timelineId:a.string,lastId:a.string,bindToDocument:a.bool}),h(C,"defaultProps",{trackScroll:!0});export{C as S};
//# sourceMappingURL=status_list-DPL_DhlK.js.map
