{"version":3,"file":"link_timeline-index-DE3UkR5y.js","sources":["../../app/javascript/mastodon/features/link_timeline/index.tsx"],"sourcesContent":["import { useRef, useEffect, useCallback } from 'react';\n\nimport { Helmet } from 'react-helmet';\nimport { useParams } from 'react-router-dom';\n\nimport TrendingUpIcon from '@/material-icons/400-24px/trending_up.svg?react';\nimport { expandLinkTimeline } from 'mastodon/actions/timelines';\nimport { Column } from 'mastodon/components/column';\nimport type { ColumnRef } from 'mastodon/components/column';\nimport { ColumnHeader } from 'mastodon/components/column_header';\nimport StatusListContainer from 'mastodon/features/ui/containers/status_list_container';\nimport type { Card } from 'mastodon/models/status';\nimport { useAppDispatch, useAppSelector } from 'mastodon/store';\n\nexport const LinkTimeline: React.FC<{\n  multiColumn: boolean;\n}> = ({ multiColumn }) => {\n  const { url } = useParams<{ url: string }>();\n  const decodedUrl = url ? decodeURIComponent(url) : undefined;\n  const dispatch = useAppDispatch();\n  const columnRef = useRef<ColumnRef>(null);\n  const firstStatusId = useAppSelector((state) =>\n    decodedUrl\n      ? // eslint-disable-next-line @typescript-eslint/no-unsafe-call, @typescript-eslint/no-unsafe-member-access\n        (state.timelines.getIn([`link:${decodedUrl}`, 'items', 0]) as string)\n      : undefined,\n  );\n  const story = useAppSelector((state) =>\n    firstStatusId\n      ? (state.statuses.getIn([firstStatusId, 'card']) as Card)\n      : undefined,\n  );\n\n  const handleHeaderClick = useCallback(() => {\n    columnRef.current?.scrollTop();\n  }, []);\n\n  const handleLoadMore = useCallback(\n    (maxId: string) => {\n      void dispatch(expandLinkTimeline(decodedUrl, { maxId }));\n    },\n    [dispatch, decodedUrl],\n  );\n\n  useEffect(() => {\n    void dispatch(expandLinkTimeline(decodedUrl));\n  }, [dispatch, decodedUrl]);\n\n  return (\n    <Column bindToDocument={!multiColumn} ref={columnRef} label={story?.title}>\n      <ColumnHeader\n        icon='explore'\n        iconComponent={TrendingUpIcon}\n        title={story?.title}\n        onClick={handleHeaderClick}\n        multiColumn={multiColumn}\n        showBackButton\n      />\n\n      <StatusListContainer\n        timelineId={`link:${decodedUrl}`}\n        onLoadMore={handleLoadMore}\n        trackScroll\n        scrollKey={`link_timeline-${decodedUrl}`}\n        bindToDocument={!multiColumn}\n      />\n\n      <Helmet>\n        <title>{story?.title}</title>\n        <meta name='robots' content='noindex' />\n      </Helmet>\n    </Column>\n  );\n};\n\n// eslint-disable-next-line import/no-default-export\nexport default LinkTimeline;\n"],"names":["LinkTimeline","multiColumn","url","useParams","decodedUrl","decodeURIComponent","undefined","dispatch","useAppDispatch","columnRef","useRef","firstStatusId","useAppSelector","state","timelines","getIn","story","statuses","handleHeaderClick","useCallback","current","scrollTop","handleLoadMore","maxId","expandLinkTimeline","useEffect","jsxs","Column","title","jsx","ColumnHeader","TrendingUpIcon","StatusListContainer","Helmet"],"mappings":"uwDAcO,MAAMA,GAERA,CAAC,CAAEC,YAAAA,CAAY,IAAM,CACxB,KAAM,CAAEC,IAAAA,CAAAA,EAAQC,EAAAA,EACVC,EAAaF,EAAMG,mBAAmBH,CAAG,EAAII,OAC7CC,EAAWC,EAAAA,EACXC,EAAYC,EAAAA,OAAkB,IAAI,EAClCC,EAAgBC,EAAgBC,GACpCT,EAEKS,EAAMC,UAAUC,MAAM,CAAC,QAAQX,CAAU,GAAI,QAAS,CAAC,CAAC,EACzDE,MACN,EACMU,EAAQJ,EAAgBC,GAC5BF,EACKE,EAAMI,SAASF,MAAM,CAACJ,EAAe,MAAM,CAAC,EAC7CL,MACN,EAEMY,EAAoBC,EAAAA,YAAY,IAAM,QAC1CV,EAAAA,EAAUW,UAAVX,MAAAA,EAAmBY,WAAU,EAC5B,EAAE,EAECC,EAAiBH,cACpBI,GAAkB,CACZhB,EAASiB,EAAmBpB,EAAY,CAAEmB,MAAAA,CAAAA,CAAO,CAAC,CAAA,EAEzD,CAAChB,EAAUH,CAAU,CACvB,EAEAqB,OAAAA,EAAAA,UAAU,IAAM,CACTlB,EAASiB,EAAmBpB,CAAU,CAAC,CAAA,EAC3C,CAACG,EAAUH,CAAU,CAAC,EAGvBsB,OAACC,GAAO,eAAgB,CAAC1B,EAAa,IAAKQ,EAAW,MAAOO,GAAAA,YAAAA,EAAOY,MAClE,SAAA,CAAAC,EAAAA,IAACC,EAAA,CACC,KAAK,UACL,cAAeC,EACf,MAAOf,GAAAA,YAAAA,EAAOY,MACd,QAASV,EACT,YAAAjB,EACA,eAAc,GAAA,QAGf+B,EAAA,CACC,WAAY,QAAQ5B,CAAU,GAC9B,WAAYkB,EACZ,YAAW,GACX,UAAW,iBAAiBlB,CAAU,GACtC,eAAgB,CAACH,EAAY,SAG9BgC,EAAA,CACC,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CAAOb,0BAAOY,KAAAA,CAAM,EACrBC,EAAAA,IAAC,OAAA,CAAK,KAAK,SAAS,QAAQ,SAAA,CAAS,CAAA,CAAA,CACvC,CAAA,EACF,CAEJ"}