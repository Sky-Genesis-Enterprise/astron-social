{"version":3,"file":"domain_blocks-CYnp0hav.js","sources":["../../app/javascript/mastodon/actions/domain_blocks.js"],"sourcesContent":["import api, { getLinks } from '../api';\n\nimport { blockDomainSuccess, unblockDomainSuccess } from \"./domain_blocks_typed\";\nimport { openModal } from './modal';\n\n\nexport * from \"./domain_blocks_typed\";\n\nexport const DOMAIN_BLOCK_REQUEST = 'DOMAIN_BLOCK_REQUEST';\nexport const DOMAIN_BLOCK_FAIL    = 'DOMAIN_BLOCK_FAIL';\n\nexport const DOMAIN_UNBLOCK_REQUEST = 'DOMAIN_UNBLOCK_REQUEST';\nexport const DOMAIN_UNBLOCK_FAIL    = 'DOMAIN_UNBLOCK_FAIL';\n\nexport function blockDomain(domain) {\n  return (dispatch, getState) => {\n    dispatch(blockDomainRequest(domain));\n\n    api().post('/api/v1/domain_blocks', { domain }).then(() => {\n      const at_domain = '@' + domain;\n      const accounts = getState().get('accounts').filter(item => item.get('acct').endsWith(at_domain)).valueSeq().map(item => item.get('id'));\n\n      dispatch(blockDomainSuccess({ domain, accounts }));\n    }).catch(err => {\n      dispatch(blockDomainFail(domain, err));\n    });\n  };\n}\n\nexport function blockDomainRequest(domain) {\n  return {\n    type: DOMAIN_BLOCK_REQUEST,\n    domain,\n  };\n}\n\nexport function blockDomainFail(domain, error) {\n  return {\n    type: DOMAIN_BLOCK_FAIL,\n    domain,\n    error,\n  };\n}\n\nexport function unblockDomain(domain) {\n  return (dispatch, getState) => {\n    dispatch(unblockDomainRequest(domain));\n\n    api().delete('/api/v1/domain_blocks', { params: { domain } }).then(() => {\n      const at_domain = '@' + domain;\n      const accounts = getState().get('accounts').filter(item => item.get('acct').endsWith(at_domain)).valueSeq().map(item => item.get('id'));\n      dispatch(unblockDomainSuccess({ domain, accounts }));\n    }).catch(err => {\n      dispatch(unblockDomainFail(domain, err));\n    });\n  };\n}\n\nexport function unblockDomainRequest(domain) {\n  return {\n    type: DOMAIN_UNBLOCK_REQUEST,\n    domain,\n  };\n}\n\nexport function unblockDomainFail(domain, error) {\n  return {\n    type: DOMAIN_UNBLOCK_FAIL,\n    domain,\n    error,\n  };\n}\n\nexport const initDomainBlockModal = account => dispatch => dispatch(openModal({\n  modalType: 'DOMAIN_BLOCK',\n  modalProps: {\n    domain: account.get('acct').split('@')[1],\n    acct: account.get('acct'),\n    accountId: account.get('id'),\n  },\n}));\n"],"names":["DOMAIN_BLOCK_REQUEST","DOMAIN_BLOCK_FAIL","DOMAIN_UNBLOCK_REQUEST","DOMAIN_UNBLOCK_FAIL","blockDomain","domain","dispatch","getState","blockDomainRequest","api","post","then","at_domain","accounts","get","filter","item","endsWith","valueSeq","map","blockDomainSuccess","catch","err","blockDomainFail","type","error","unblockDomain","unblockDomainRequest","delete","params","unblockDomainSuccess","unblockDomainFail","initDomainBlockModal","account","openModal","modalType","modalProps","split","acct","accountId"],"mappings":"2GAQO,MAAMA,EAAuB,uBACvBC,EAAuB,oBAEvBC,EAAyB,yBACzBC,EAAyB,sBAE/B,SAASC,EAAYC,EAAQ,CAClC,MAAO,CAACC,EAAUC,IAAa,CAC7BD,EAASE,EAAmBH,CAAM,CAAC,EAEnCI,EAAG,EAAGC,KAAK,wBAAyB,CAAEL,OAAAA,CAAO,CAAC,EAAEM,KAAK,IAAM,CACzD,MAAMC,EAAY,IAAMP,EAClBQ,EAAWN,EAAQ,EAAGO,IAAI,UAAU,EAAEC,OAAOC,GAAQA,EAAKF,IAAI,MAAM,EAAEG,SAASL,CAAS,CAAC,EAAEM,SAAQ,EAAGC,IAAIH,GAAQA,EAAKF,IAAI,IAAI,CAAC,EAEtIR,EAASc,EAAmB,CAAEf,OAAAA,EAAQQ,SAAAA,CAAS,CAAC,CAAC,CACnD,CAAC,EAAEQ,MAAMC,GAAO,CACdhB,EAASiB,EAAgBlB,EAAQiB,CAAG,CAAC,CACvC,CAAC,EAEL,CAEO,SAASd,EAAmBH,EAAQ,CACzC,MAAO,CACLmB,KAAMxB,EACNK,OAAAA,EAEJ,CAEO,SAASkB,EAAgBlB,EAAQoB,EAAO,CAC7C,MAAO,CACLD,KAAMvB,EACNI,OAAAA,EACAoB,MAAAA,EAEJ,CAEO,SAASC,EAAcrB,EAAQ,CACpC,MAAO,CAACC,EAAUC,IAAa,CAC7BD,EAASqB,EAAqBtB,CAAM,CAAC,EAErCI,EAAG,EAAGmB,OAAO,wBAAyB,CAAEC,OAAQ,CAAExB,OAAAA,CAAO,CAAE,CAAC,EAAEM,KAAK,IAAM,CACvE,MAAMC,EAAY,IAAMP,EAClBQ,EAAWN,EAAQ,EAAGO,IAAI,UAAU,EAAEC,OAAOC,GAAQA,EAAKF,IAAI,MAAM,EAAEG,SAASL,CAAS,CAAC,EAAEM,SAAQ,EAAGC,IAAIH,GAAQA,EAAKF,IAAI,IAAI,CAAC,EACtIR,EAASwB,EAAqB,CAAEzB,OAAAA,EAAQQ,SAAAA,CAAS,CAAC,CAAC,CACrD,CAAC,EAAEQ,MAAMC,GAAO,CACdhB,EAASyB,EAAkB1B,EAAQiB,CAAG,CAAC,CACzC,CAAC,EAEL,CAEO,SAASK,EAAqBtB,EAAQ,CAC3C,MAAO,CACLmB,KAAMtB,EACNG,OAAAA,EAEJ,CAEO,SAAS0B,EAAkB1B,EAAQoB,EAAO,CAC/C,MAAO,CACLD,KAAMrB,EACNE,OAAAA,EACAoB,MAAAA,EAEJ,CAEO,MAAMO,EAAuBC,GAAW3B,GAAYA,EAAS4B,EAAU,CAC5EC,UAAW,eACXC,WAAY,CACV/B,OAAQ4B,EAAQnB,IAAI,MAAM,EAAEuB,MAAM,GAAG,EAAE,CAAC,EACxCC,KAAML,EAAQnB,IAAI,MAAM,EACxByB,UAAWN,EAAQnB,IAAI,IAAI,CAC7B,CACF,CAAC,CAAC"}