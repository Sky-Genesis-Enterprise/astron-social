{"version":3,"file":"terms_of_service-index-Z1Y-TtzH.js","sources":["../../app/javascript/mastodon/features/terms_of_service/index.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\n\nimport {\n  FormattedMessage,\n  FormattedDate,\n  useIntl,\n  defineMessages,\n} from 'react-intl';\n\nimport { Helmet } from 'react-helmet';\nimport { Link, useParams } from 'react-router-dom';\n\nimport { apiGetTermsOfService } from 'mastodon/api/instance';\nimport type { ApiTermsOfServiceJSON } from 'mastodon/api_types/instance';\nimport { Column } from 'mastodon/components/column';\nimport BundleColumnError from 'mastodon/features/ui/components/bundle_column_error';\n\nconst messages = defineMessages({\n  title: { id: 'terms_of_service.title', defaultMessage: 'Terms of Service' },\n});\n\ninterface Params {\n  date?: string;\n}\n\nconst TermsOfService: React.FC<{\n  multiColumn: boolean;\n}> = ({ multiColumn }) => {\n  const intl = useIntl();\n  const { date } = useParams<Params>();\n  const [response, setResponse] = useState<ApiTermsOfServiceJSON>();\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    apiGetTermsOfService(date)\n      .then((data) => {\n        setResponse(data);\n        setLoading(false);\n        return '';\n      })\n      .catch(() => {\n        setLoading(false);\n      });\n  }, [date]);\n\n  if (!loading && !response) {\n    return <BundleColumnError multiColumn={multiColumn} errorType='routing' />;\n  }\n\n  return (\n    <Column\n      bindToDocument={!multiColumn}\n      label={intl.formatMessage(messages.title)}\n    >\n      <div className='scrollable privacy-policy'>\n        <div className='column-title'>\n          <h3>\n            <FormattedMessage\n              id='terms_of_service.title'\n              defaultMessage='Terms of Service'\n            />\n          </h3>\n          <p className='prose'>\n            {response?.effective ? (\n              <FormattedMessage\n                id='privacy_policy.last_updated'\n                defaultMessage='Last updated {date}'\n                values={{\n                  date: (\n                    <FormattedDate\n                      value={response.effective_date}\n                      year='numeric'\n                      month='short'\n                      day='2-digit'\n                    />\n                  ),\n                }}\n              />\n            ) : (\n              <FormattedMessage\n                id='terms_of_service.effective_as_of'\n                defaultMessage='Effective as of {date}'\n                values={{\n                  date: (\n                    <FormattedDate\n                      value={response?.effective_date}\n                      year='numeric'\n                      month='short'\n                      day='2-digit'\n                    />\n                  ),\n                }}\n              />\n            )}\n\n            {response?.succeeded_by && (\n              <>\n                {' Â· '}\n                <Link to={`/terms-of-service/${response.succeeded_by}`}>\n                  <FormattedMessage\n                    id='terms_of_service.upcoming_changes_on'\n                    defaultMessage='Upcoming changes on {date}'\n                    values={{\n                      date: (\n                        <FormattedDate\n                          value={response.succeeded_by}\n                          year='numeric'\n                          month='short'\n                          day='2-digit'\n                        />\n                      ),\n                    }}\n                  />\n                </Link>\n              </>\n            )}\n          </p>\n        </div>\n\n        {response && (\n          <div\n            className='privacy-policy__body prose'\n            dangerouslySetInnerHTML={{ __html: response.content }}\n          />\n        )}\n      </div>\n\n      <Helmet>\n        <title>{intl.formatMessage(messages.title)}</title>\n        <meta name='robots' content='all' />\n      </Helmet>\n    </Column>\n  );\n};\n\n// eslint-disable-next-line import/no-default-export\nexport default TermsOfService;\n"],"names":["messages","defineMessages","title","id","defaultMessage","TermsOfService","multiColumn","intl","useIntl","date","useParams","response","setResponse","useState","loading","setLoading","useEffect","apiGetTermsOfService","then","data","catch","jsx","BundleColumnError","jsxs","Column","formatMessage","FormattedMessage","effective","FormattedDate","effective_date","succeeded_by","Fragment","Link","__html","content","Helmet"],"mappings":"ytBAiBA,MAAMA,EAAWC,EAAe,CAC9BC,MAAO,CAAEC,GAAE,yBAA4BC,eAAc,kBAAA,CACvD,CAAC,EAMKC,EAEDA,CAAC,CAAEC,YAAAA,CAAY,IAAM,CACxB,MAAMC,EAAOC,EAAAA,EACP,CAAEC,KAAAA,CAAAA,EAASC,EAAAA,EACX,CAACC,EAAUC,CAAW,EAAIC,WAAAA,EAC1B,CAACC,EAASC,CAAU,EAAIF,EAAAA,SAAS,EAAI,EAc3C,OAZAG,EAAAA,UAAU,IAAM,CACdC,EAAqBR,CAAI,EACtBS,KAAMC,IACLP,EAAYO,CAAI,EAChBJ,EAAW,EAAK,EACT,GACR,EACAK,MAAM,IAAM,CACXL,EAAW,EAAK,CAAA,CACjB,CAAA,EACF,CAACN,CAAI,CAAC,EAEL,CAACK,GAAW,CAACH,EACRU,EAAAA,IAACC,EAAA,CAAkB,YAAAhB,EAA0B,UAAU,SAAA,CAAS,EAIvEiB,OAACC,EAAA,CACC,eAAgB,CAAClB,EACjB,MAAOC,EAAKkB,cAAczB,EAASE,KAAK,EAExC,SAAA,CAAAqB,EAAAA,KAAC,MAAA,CAAI,UAAU,4BACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,eACb,SAAA,CAAAF,EAAAA,IAAC,MACC,SAAAA,EAAAA,IAACK,EAAA,CACC,4BACA,eAAe,mBAAkB,CAAA,CAErC,EACAH,EAAAA,KAAC,IAAA,CAAE,UAAU,QACVZ,SAAAA,CAAAA,GAAAA,MAAAA,EAAUgB,UACTN,EAAAA,IAACK,EAAA,CACC,GAAE,8BACF,eAAe,sBACf,OAAQ,CACNjB,KACEY,EAAAA,IAACO,EAAA,CACC,MAAOjB,EAASkB,eAChB,KAAK,UACL,MAAM,QACN,IAAI,SAAA,CAAS,CAAA,EAGjB,EAGJR,EAAAA,IAACK,EAAA,CACC,GAAE,mCACF,eAAe,yBACf,OAAQ,CACNjB,KACEY,EAAAA,IAACO,EAAA,CACC,MAAOjB,GAAAA,YAAAA,EAAUkB,eACjB,KAAK,UACL,MAAM,QACN,IAAI,SAAA,CAAS,CAAA,EAGjB,GAILlB,GAAAA,YAAAA,EAAUmB,eACTP,EAAAA,KAAAQ,EAAAA,SAAA,CACG,SAAA,CAAA,MACDV,EAAAA,IAACW,EAAA,CAAK,GAAI,qBAAqBrB,EAASmB,YAAY,GAClD,SAAAT,EAAAA,IAACK,EAAA,CACC,GAAE,uCACF,eAAe,6BACf,OAAQ,CACNjB,KACEY,EAAAA,IAACO,EAAA,CACC,MAAOjB,EAASmB,aAChB,KAAK,UACL,MAAM,QACN,IAAI,SAAA,CAAS,CAAA,EAGjB,CAAA,CAEN,CAAA,CAAA,CACF,CAAA,CAAA,CAEJ,CAAA,EACF,EAECnB,GACCU,EAAAA,IAAC,MAAA,CACC,UAAU,6BACV,wBAAyB,CAAEY,OAAQtB,EAASuB,OAAAA,CAAQ,CAAE,CAAA,EAG5D,SAECC,EAAA,CACC,SAAA,CAAAd,MAAC,QAAA,CAAOd,SAAAA,EAAKkB,cAAczB,EAASE,KAAK,EAAE,EAC3CmB,EAAAA,IAAC,OAAA,CAAK,KAAK,SAAS,QAAQ,KAAA,CAAK,CAAA,CAAA,CACnC,CAAA,EACF,CAEJ"}