{"version":3,"file":"ImpactReport-B2eEV7cA.js","sources":["../../app/javascript/mastodon/components/admin/ImpactReport.jsx"],"sourcesContent":["import PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\n\nimport { FormattedNumber, FormattedMessage } from 'react-intl';\n\nimport classNames from 'classnames';\n\nimport api from 'mastodon/api';\nimport { Skeleton } from 'mastodon/components/skeleton';\n\nexport default class ImpactReport extends PureComponent {\n\n  static propTypes = {\n    domain: PropTypes.string.isRequired,\n  };\n\n  state = {\n    loading: true,\n    data: null,\n  };\n\n  componentDidMount () {\n    const { domain } = this.props;\n\n    const params = {\n      domain: domain,\n      include_subdomains: true,\n    };\n\n    api(false).post('/api/v1/admin/measures', {\n      keys: ['instance_accounts', 'instance_follows', 'instance_followers'],\n      start_at: null,\n      end_at: null,\n      instance_accounts: params,\n      instance_follows: params,\n      instance_followers: params,\n    }).then(res => {\n      this.setState({\n        loading: false,\n        data: res.data,\n      });\n    }).catch(err => {\n      console.error(err);\n    });\n  }\n\n  render () {\n    const { loading, data } = this.state;\n\n    return (\n      <div className='dimension'>\n        <h4><FormattedMessage id='admin.impact_report.title' defaultMessage='Impact summary' /></h4>\n\n        <table>\n          <tbody>\n            <tr className='dimension__item'>\n              <td className='dimension__item__key'>\n                <FormattedMessage id='admin.impact_report.instance_accounts' defaultMessage='Accounts profiles this would delete' />\n              </td>\n\n              <td className='dimension__item__value'>\n                {loading ? <Skeleton width={60} /> : <FormattedNumber value={data[0].total} />}\n              </td>\n            </tr>\n\n            <tr className={classNames('dimension__item', { negative: !loading && data[1].total > 0 })}>\n              <td className='dimension__item__key'>\n                <FormattedMessage id='admin.impact_report.instance_follows' defaultMessage='Followers their users would lose' />\n              </td>\n\n              <td className='dimension__item__value'>\n                {loading ? <Skeleton width={60} /> : <FormattedNumber value={data[1].total} />}\n              </td>\n            </tr>\n\n            <tr className={classNames('dimension__item', { negative: !loading && data[2].total > 0 })}>\n              <td className='dimension__item__key'>\n                <FormattedMessage id='admin.impact_report.instance_followers' defaultMessage='Followers our users would lose' />\n              </td>\n\n              <td className='dimension__item__value'>\n                {loading ? <Skeleton width={60} /> : <FormattedNumber value={data[2].total} />}\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    );\n  }\n\n}\n"],"names":["ImpactReport","PureComponent","state","loading","data","componentDidMount","domain","props","params","include_subdomains","api","post","keys","start_at","end_at","instance_accounts","instance_follows","instance_followers","then","res","setState","catch","err","console","error","render","jsxs","jsx","FormattedMessage","Skeleton","FormattedNumber","total","classNames","negative"],"mappings":"2fAUA,MAAqBA,UAAqBC,EAAAA,aAAc,CAAxD,kCAMEC,EAAAA,aAAQ,CACNC,QAAS,GACTC,KAAM,IAAA,GAGRC,mBAAqB,CACnB,KAAM,CAAEC,OAAAA,CAAAA,EAAW,KAAKC,MAElBC,EAAS,CACbF,OAAAA,EACAG,mBAAoB,EAAA,EAGtBC,EAAI,EAAK,EAAEC,KAAK,yBAA0B,CACxCC,KAAM,CAAC,oBAAqB,mBAAoB,oBAAoB,EACpEC,SAAU,KACVC,OAAQ,KACRC,kBAAmBP,EACnBQ,iBAAkBR,EAClBS,mBAAoBT,CAAAA,CACrB,EAAEU,KAAKC,GAAO,CACb,KAAKC,SAAS,CACZjB,QAAS,GACTC,KAAMe,EAAIf,IAAAA,CACX,CAAA,CACF,EAAEiB,MAAMC,GAAO,CACdC,QAAQC,MAAMF,CAAG,CAAA,CAClB,CAAA,CAGHG,QAAU,CACR,KAAM,CAAEtB,QAAAA,EAASC,KAAAA,CAAAA,EAAS,KAAKF,MAE/B,OACEwB,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAC,EAAAA,IAAC,MAAG,SAAAA,EAAAA,IAACC,EAAA,CAAiB,GAAE,4BAA6B,eAAe,iBAAgB,CAAA,CAAG,EAEvFD,EAAAA,IAAC,QAAA,CACC,SAAAD,EAAAA,KAAC,QAAA,CACC,SAAA,CAAAA,EAAAA,KAAC,KAAA,CAAG,UAAU,kBACZ,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAG,UAAU,uBACZ,SAAAA,EAAAA,IAACC,GAAiB,2CAA2C,eAAe,qCAAA,CAAqC,CAAA,CACnH,QAEC,KAAA,CAAG,UAAU,yBACXzB,SAAAA,QAAW0B,EAAA,CAAS,MAAO,GAAG,QAAOC,EAAA,CAAgB,MAAO1B,EAAK,CAAC,EAAE2B,MAAM,CAAA,CAC7E,CAAA,EACF,EAEAL,EAAAA,KAAC,KAAA,CAAG,UAAWM,EAAW,kBAAmB,CAAEC,SAAU,CAAC9B,GAAWC,EAAK,CAAC,EAAE2B,MAAQ,CAAA,CAAG,EACtF,SAAA,CAAAJ,EAAAA,IAAC,KAAA,CAAG,UAAU,uBACZ,SAAAA,EAAAA,IAACC,GAAiB,0CAA0C,eAAe,kCAAA,CAAkC,CAAA,CAC/G,QAEC,KAAA,CAAG,UAAU,yBACXzB,SAAAA,QAAW0B,EAAA,CAAS,MAAO,GAAG,QAAOC,EAAA,CAAgB,MAAO1B,EAAK,CAAC,EAAE2B,MAAM,CAAA,CAC7E,CAAA,EACF,EAEAL,EAAAA,KAAC,KAAA,CAAG,UAAWM,EAAW,kBAAmB,CAAEC,SAAU,CAAC9B,GAAWC,EAAK,CAAC,EAAE2B,MAAQ,CAAA,CAAG,EACtF,SAAA,CAAAJ,EAAAA,IAAC,KAAA,CAAG,UAAU,uBACZ,SAAAA,EAAAA,IAACC,GAAiB,4CAA4C,eAAe,gCAAA,CAAgC,CAAA,CAC/G,QAEC,KAAA,CAAG,UAAU,yBACXzB,SAAAA,QAAW0B,EAAA,CAAS,MAAO,GAAG,QAAOC,EAAA,CAAgB,MAAO1B,EAAK,CAAC,EAAE2B,MAAM,CAAA,CAC7E,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CACF,CAAA,EACF,CAAA,CAIN"}