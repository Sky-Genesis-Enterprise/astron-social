import{j as e}from"./client-wT6vtYO_.js";import{d as B,u as C,r as o}from"./index-BdTwX--g.js";import{H as D}from"./Helmet-ZVWnGmbg.js";import{j as E,L as N,S as T}from"./short_number-WomMu2iV.js";import{c as q}from"./index.module-sM2fS0Fl.js";import{S as H}from"./list_alt-yox9TcbF.js";import{S as O}from"./squiggly_arrow-jedqCbUN.js";import{u as w,d7 as P,eb as V,dP as S,a as A,ap as z,dI as G,dH as k,o as $,bM as K,a9 as W,A as J}from"./useSelectableClick-DeaJbL2_.js";import{d as Q}from"./api-B2m7efUy.js";import{B as U}from"./index-BZWHsOPk.js";import{C as X}from"./column-B4vwzadM.js";import{C as Y}from"./column_header-FN7GyEAs.js";import{C as Z}from"./column_search_header-reFrdFDN.js";import{F as I}from"./counters-BJ0cOeaq.js";import{D as ee}from"./content_warning-DZ8mar1O.js";import{S as se}from"./scrollable_list-lNykmhKA.js";import{V as te}from"./verified_badge-CtK79Pb7.js";import{e as ae}from"./initial_state-BP3UcUr4.js";import{M as b}from"./message-UFwkQlnu.js";import"./numbers-CGZQWBYL.js";import"./index-CAH5FfLP.js";import"./ready-DpOgoWSg.js";import"./load_locale-tOpKhmcM.js";import"./index-lj9VQs0f.js";import"./index-DizoKcfL.js";import"./scroll-BygYx8ga.js";import"./add-D8GR9P00.js";import"./chevron_left-CnYIoVsW.js";import"./close-BsPe8EbX.js";import"./skeleton-D9NbTYr9.js";import"./scroll_container-Bq73vRM7.js";import"./react-router-scroll-4.es-CU7ja20b.js";import"./interopRequireDefault-CdiRfGvq.js";import"./schedule_idle_task-Co3Ydhdu.js";import"./load_more-qGthrhsi.js";import"./loading_indicator-7xMB1U6D.js";const f=B({manageMembers:{id:"column.list_members",defaultMessage:"Manage list members"},placeholder:{id:"lists.search",defaultMessage:"Search"},enterSearch:{id:"lists.add_to_list",defaultMessage:"Add to list"},add:{id:"lists.add_member",defaultMessage:"Add"},remove:{id:"lists.remove_member",defaultMessage:"Remove"},back:{id:"column_back_button.label",defaultMessage:"Back"}}),re=({accountId:s,listId:c,partOfList:i,onToggle:m})=>{const j=C(),n=w(),t=A(a=>a.accounts.get(s)),l=A(a=>s?a.relationships.get(s):void 0),h=s===ae||(l==null?void 0:l.following)||(l==null?void 0:l.requested);o.useEffect(()=>{s&&n(z([s]))},[n,s]);const _=o.useCallback(()=>{i?(G(c,s),m(s)):h?(k(c,s),m(s)):n($({modalType:"CONFIRM_FOLLOW_TO_LIST",modalProps:{accountId:s,onConfirm:()=>{K(s).then(()=>k(c,s)).then(()=>(m(s),"")).catch(a=>{n(W(a))})}}}))},[n,s,h,c,i,m]);if(!t)return null;const p=t.fields.find(a=>!!a.verified_at);return e.jsx("div",{className:"account",children:e.jsxs("div",{className:"account__wrapper",children:[e.jsxs(N,{className:"account__display-name",title:t.acct,to:`/@${t.acct}`,"data-hover-card-account":t.id,children:[e.jsx("div",{className:"account__avatar-wrapper",children:e.jsx(J,{account:t,size:36})}),e.jsxs("div",{className:"account__contents",children:[e.jsx(ee,{account:t}),e.jsxs("div",{className:"account__details",children:[e.jsx(T,{value:t.followers_count,renderer:I})," ",p&&e.jsx(te,{link:p.value})]})]})]},t.id),e.jsx("div",{className:"account__relationship",children:e.jsx(U,{text:j.formatMessage(i?f.remove:f.add),secondary:i,onClick:_})})]})})},Ve=({multiColumn:s})=>{const c=w(),{id:i}=E(),m=C(),[j,n]=o.useState(!1),[t,l]=o.useState([]),[h,_]=o.useState([]),[p,a]=o.useState(!0),[v,g]=o.useState("remove");o.useEffect(()=>{i&&(a(!0),c(P(i)),V(i).then(r=>(c(S(r)),l(r.map(u=>u.id)),a(!1),"")).catch(()=>{a(!1)}))},[c,i]);const F=o.useCallback(()=>{g("add")},[g]),L=o.useCallback(()=>{g("remove"),n(!1)},[g]),y=o.useCallback(r=>{const u=t.includes(r);l(u?t.filter(M=>M!==r):[r,...t])},[t,l]),x=o.useRef(null),R=q(r=>{if(x.current&&x.current.abort(),r.trim().length===0){n(!1);return}a(!0),x.current=new AbortController,Q("GET","v1/accounts/search",{signal:x.current.signal,params:{q:r,resolve:!0}}).then(u=>(c(S(u)),_(u.map(M=>M.id)),a(!1),n(!0),"")).catch(()=>{n(!0),a(!1)})},500,{leading:!0,trailing:!0});let d;return v==="add"&&j?d=h:d=t,e.jsxs(X,{bindToDocument:!s,label:m.formatMessage(f.manageMembers),children:[e.jsx(Y,{title:m.formatMessage(f.manageMembers),icon:"list-ul",iconComponent:H,multiColumn:s,showBackButton:!0}),e.jsx(Z,{placeholder:m.formatMessage(f.placeholder),onBack:L,onSubmit:R,onActivate:F,active:v==="add"}),e.jsx(se,{scrollKey:"list_members",trackScroll:!s,bindToDocument:!s,isLoading:p,showLoading:p&&d.length===0,hasMore:!1,footer:e.jsxs(e.Fragment,{children:[d.length>0&&e.jsx("div",{className:"spacer"}),e.jsx("div",{className:"column-footer",children:e.jsx(N,{to:`/lists/${i}`,className:"button button--block",children:e.jsx(b,{id:"lists.done",defaultMessage:"Done"})})})]}),emptyMessage:v==="remove"?e.jsxs(e.Fragment,{children:[e.jsxs("span",{children:[e.jsx(b,{id:"lists.no_members_yet",defaultMessage:"No members yet."}),e.jsx("br",{}),e.jsx(b,{id:"lists.find_users_to_add",defaultMessage:"Find users to add"})]}),e.jsx(O,{className:"empty-column-indicator__arrow"})]}):e.jsx(b,{id:"lists.no_results_found",defaultMessage:"No results found."}),children:d.map(r=>e.jsx(re,{accountId:r,listId:i,partOfList:d===t||t.includes(r),onToggle:y},r))}),e.jsxs(D,{children:[e.jsx("title",{children:m.formatMessage(f.manageMembers)}),e.jsx("meta",{name:"robots",content:"noindex"})]})]})};export{Ve as default,f as messages};
//# sourceMappingURL=members-BLbYVDxO.js.map
