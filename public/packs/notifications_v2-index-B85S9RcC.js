var Be=Object.defineProperty;var $e=(t,s,i)=>s in t?Be(t,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[s]=i;var B=(t,s,i)=>$e(t,typeof s!="symbol"?s+"":s,i);import{j as e}from"./client-wT6vtYO_.js";import{r as d,u as F,d as k,i as fe}from"./index-BdTwX--g.js";import{H as Le}from"./Helmet-ZVWnGmbg.js";import{i as pe}from"./isEqual-Q9WdZnh7.js";import{c as O}from"./index.module-sM2fS0Fl.js";import{S as De}from"./notifications-fill-BPpVqP74.js";import{a as p,cl as me,I as _,u as P,cm as se,j as ge,cn as $,aM as R,b as z,B as Ze,o as he,co as ie,cp as xe,P as He,cq as _e,cr as je,cs as Ge,A as Oe,v as Ue,ct as ze,cu as We,S as Ve,a3 as Ke,a$ as Qe,b0 as Ye,ab as be,cv as Xe,cw as Je,bb as et,cx as tt,aU as st,w as it,cy as oe,cz as ot,cA as nt,cB as at,cC as U,cD as ne,cE as lt,ae as rt,cF as ct,cG as dt,cH as ut,E as ft,d as pt,bd as mt}from"./useSelectableClick-DeaJbL2_.js";import{N as gt}from"./not_signed_in_indicator-CCzEFwYn.js";import{a as ht,b as xt,s as _t,c as jt}from"./notifications-0yz-Se0w.js";import{C as bt}from"./column-B4vwzadM.js";import{C as vt}from"./column_header-FN7GyEAs.js";import{L as wt}from"./load_gap-6rwcZCuh.js";import{S as Mt}from"./scrollable_list-lNykmhKA.js";import{d as yt,L as T,S as Nt}from"./short_number-WomMu2iV.js";import{S as ve}from"./inventory_2-Cl3pumXb.js";import{M as a}from"./message-UFwkQlnu.js";import{S as we}from"./close-BsPe8EbX.js";import{B as Pt}from"./index-BZWHsOPk.js";import{changeAlerts as ae}from"./push_notifications-index-EEFAVoaE.js";import{P as le,d as re}from"./permissions-Djze7cmB.js";import{P as St}from"./policy_controls-dBLdekz7.js";import{S as r}from"./setting_toggle-56grnhBH.js";import{i as W}from"./index.es-B0ZBMj49.js";import{c as L}from"./index-DizoKcfL.js";import{S as Ct,M as kt,R as It}from"./relationships_severance_event-CWoLAgE9.js";import{R as Me}from"./index-CAH5FfLP.js";import{S as V}from"./person_add-fill-D1U4oKl8.js";import{A as At}from"./avatar_group-PUipFlog.js";import{D as ye}from"./status-CiF0hsk4.js";import{E as qt}from"./embedded_status-CRZOb2jI.js";import{F as Rt}from"./counters-BJ0cOeaq.js";import{F as Ft}from"./follow_button-BdqDKUmA.js";import{e as K}from"./initial_state-BP3UcUr4.js";import{an as Tt,d as Et}from"./content_warning-DZ8mar1O.js";import{S as Bt}from"./status_quoted-COu-QToA.js";import{S as $t}from"./embedded_status_content-Dm1KuweQ.js";import{S as Lt}from"./notifications_active-fill-Bd5B72X1.js";import{S as Dt}from"./edit-Cyfwv5F_.js";import{S as Zt}from"./home-fill-BjwEpYg3.js";import{S as Ht}from"./insert_chart-BTwnuSdd.js";import{S as Gt}from"./person_add-Bq7Kcwwn.js";import"./api-B2m7efUy.js";import"./index-lj9VQs0f.js";import"./ready-DpOgoWSg.js";import"./load_locale-tOpKhmcM.js";import"./scroll-BygYx8ga.js";import"./add-D8GR9P00.js";import"./chevron_left-CnYIoVsW.js";import"./loading_indicator-7xMB1U6D.js";import"./scroll_container-Bq73vRM7.js";import"./react-router-scroll-4.es-CU7ja20b.js";import"./interopRequireDefault-CdiRfGvq.js";import"./schedule_idle_task-Co3Ydhdu.js";import"./load_more-qGthrhsi.js";import"./numbers-CGZQWBYL.js";import"./dropdown_selector-TPsaB6cz.js";import"./info-HtHaDKcq.js";import"./index-Dk6IJ02w.js";import"./gavel-BYJTFhVW.js";import"./card-CttmBekj.js";import"./avatar_overlay-BeG39OK4.js";import"./toString-Cy1Ecq9L.js";import"./status_content-CaIN8-0B.js";import"./poll-CjurB963.js";import"./visibility_icon-DbVVvHFb.js";import"./skeleton-D9NbTYr9.js";import"./domain_blocks-CYnp0hav.js";import"./reports-DBOcsYZF.js";import"./index-OwtqmxAM.js";const Ot=t=>d.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:24,viewBox:"0 -960 960 960",width:24,...t},d.createElement("path",{d:"M268-240 42-466l57-56 170 170 56 56-57 56Zm226 0L268-466l56-57 170 170 368-368 56 57-424 424Zm0-226-57-56 198-198 57 56-198 198Z"})),ce=k({filteredNotifications:{id:"notification_requests.title",defaultMessage:"Filtered notifications"}}),Ut=({className:t})=>{const s=F(),i=yt(),n=p(u=>u.notificationPolicy),o=p(me),c=d.useCallback(()=>{i.push("/notifications/requests")},[i]);return n===null||n.summary.pending_requests_count<=0||!o?null:e.jsx("button",{"aria-label":s.formatMessage(ce.filteredNotifications),title:s.formatMessage(ce.filteredNotifications),onClick:c,className:t,children:e.jsx(_,{id:"filtered-notifications",icon:ve})})},zt=()=>{const t=P(),s=p(n=>n.notificationPolicy),i=p(me);return d.useEffect(()=>{t(se());const n=setInterval(()=>{t(se())},12e4);return()=>{clearInterval(n)}},[t]),s===null||s.summary.pending_requests_count<=0||i?null:e.jsxs(T,{className:"filtered-notifications-banner",to:"/notifications/requests",children:[e.jsx("div",{className:"notification-group__icon",children:e.jsx(_,{icon:ve,id:"filtered-notifications"})}),e.jsxs("div",{className:"filtered-notifications-banner__text",children:[e.jsx("strong",{children:e.jsx(a,{id:"filtered_notifications_banner.title",defaultMessage:"Filtered notifications"})}),e.jsx("span",{children:e.jsx(a,{id:"filtered_notifications_banner.pending_requests",defaultMessage:"From {count, plural, =0 {no one} one {one person} other {# people}} you may know",values:{count:s.summary.pending_requests_count}})})]})]})},Wt=t=>d.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:20,viewBox:"0 -960 960 960",width:20,...t},d.createElement("path",{d:"m403-96-22-114q-23-9-44.5-21T296-259l-110 37-77-133 87-76q-2-12-3-24t-1-25q0-13 1-25t3-24l-87-76 77-133 110 37q19-16 40.5-28t44.5-21l22-114h154l22 114q23 9 44.5 21t40.5 28l110-37 77 133-87 76q2 12 3 24t1 25q0 13-1 25t-3 24l87 76-77 133-110-37q-19 16-40.5 28T579-210L557-96H403Zm59-72h36l19-99q38-7 71-26t57-48l96 32 18-30-76-67q6-17 9.5-35.5T696-480q0-20-3.5-38.5T683-554l76-67-18-30-96 32q-24-29-57-48t-71-26l-19-99h-36l-19 99q-38 7-71 26t-57 48l-96-32-18 30 76 67q-6 17-9.5 35.5T264-480q0 20 3.5 38.5T277-406l-76 67 18 30 96-32q24 29 57 48t71 26l19 99Zm18-168q60 0 102-42t42-102q0-60-42-102t-102-42q-60 0-102 42t-42 102q0 60 42 102t102 42Zm0-144Z"})),Vt=k({close:{id:"lightbox.close",defaultMessage:"Close"}});class Kt extends d.PureComponent{constructor(){super(...arguments);B(this,"handleClick",()=>{this.props.dispatch($())});B(this,"handleClose",()=>{this.props.dispatch(R(["notifications","dismissPermissionBanner"],!0))})}render(){const{intl:i}=this.props;return e.jsxs("div",{className:"notifications-permission-banner",children:[e.jsx("div",{className:"notifications-permission-banner__close",children:e.jsx(z,{icon:"times",iconComponent:we,onClick:this.handleClose,title:i.formatMessage(Vt.close)})}),e.jsx("h2",{children:e.jsx(a,{id:"notifications_permission_banner.title",defaultMessage:"Never miss a thing"})}),e.jsx("p",{children:e.jsx(a,{id:"notifications_permission_banner.how_to_control",defaultMessage:"To receive notifications when Mastodon isn't open, enable desktop notifications. You can control precisely which types of interactions generate desktop notifications through the {icon} button above once they're enabled.",values:{icon:e.jsx(_,{id:"sliders",icon:Wt})}})}),e.jsx(Pt,{onClick:this.handleClick,children:e.jsx(a,{id:"notifications_permission_banner.enable",defaultMessage:"Enable desktop notifications"})})]})}}const Qt=ge()(fe(Kt)),Yt=t=>d.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:24,viewBox:"0 -960 960 960",width:24,...t},d.createElement("path",{d:"m376-300 104-104 104 104 56-56-104-104 104-104-56-56-104 104-104-104-56 56 104 104-104 104 56 56Zm-96 180q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520Zm-400 0v520-520Z"}));class Xt extends d.PureComponent{render(){return e.jsxs("button",{className:"text-btn column-header__setting-btn",tabIndex:0,onClick:this.props.onClick,children:[e.jsx(_,{id:"eraser",icon:Yt})," ",e.jsx(a,{id:"notifications.clear",defaultMessage:"Clear notifications"})]})}}class Jt extends d.PureComponent{render(){return e.jsx("button",{className:"text-btn column-header__permission-btn",tabIndex:0,onClick:this.props.onClick,children:e.jsx(a,{id:"notifications.grant_permission",defaultMessage:"Grant permission."})})}}class es extends d.PureComponent{constructor(){super(...arguments);B(this,"onPushChange",(i,n)=>{this.props.onChange(["push",...i],n)})}render(){const{settings:i,pushSettings:n,onChange:o,onClear:c,alertsEnabled:u,browserSupport:g,browserPermission:l,onRequestNotificationPermission:b}=this.props,M=e.jsx(a,{id:"notifications.column_settings.filter_bar.advanced",defaultMessage:"Display all categories"}),N=e.jsx(a,{id:"notifications.column_settings.unread_notifications.highlight",defaultMessage:"Highlight unread notifications"}),h=e.jsx(a,{id:"notifications.column_settings.alert",defaultMessage:"Desktop notifications"}),x=e.jsx(a,{id:"notifications.column_settings.show",defaultMessage:"Show in column"}),j=e.jsx(a,{id:"notifications.column_settings.sound",defaultMessage:"Play sound"}),S=e.jsx(a,{id:"notifications.column_settings.group",defaultMessage:"Group"}),m=n.get("browserSupport")&&n.get("isSubscribed"),v=m&&e.jsx(a,{id:"notifications.column_settings.push",defaultMessage:"Push notifications"});return e.jsxs("div",{className:"column-settings",children:[e.jsx("section",{children:e.jsx(Xt,{onClick:c})}),u&&g&&l==="denied"&&e.jsx("section",{children:e.jsx("span",{className:"warning-hint",children:e.jsx(a,{id:"notifications.permission_denied",defaultMessage:"Desktop notifications are unavailable due to previously denied browser permissions request"})})}),u&&g&&l==="default"&&e.jsx("section",{children:e.jsxs("span",{className:"warning-hint",children:[e.jsx(a,{id:"notifications.permission_required",defaultMessage:"Desktop notifications are unavailable because the required permission has not been granted."})," ",e.jsx(Jt,{onClick:b})]})}),e.jsx(St,{}),e.jsxs("section",{role:"group","aria-labelledby":"notifications-unread-markers",children:[e.jsx("h3",{id:"notifications-unread-markers",children:e.jsx(a,{id:"notifications.column_settings.unread_notifications.category",defaultMessage:"Unread notifications"})}),e.jsx("div",{className:"column-settings__row",children:e.jsx(r,{id:"unread-notification-markers",prefix:"notifications",settings:i,settingPath:["showUnread"],onChange:o,label:N})})]}),e.jsxs("section",{role:"group","aria-labelledby":"notifications-filter-bar",children:[e.jsx("h3",{id:"notifications-filter-bar",children:e.jsx(a,{id:"notifications.column_settings.filter_bar.category",defaultMessage:"Quick filter bar"})}),e.jsx("div",{className:"column-settings__row",children:e.jsx(r,{id:"advanced-filter-bar",prefix:"notifications",settings:i,settingPath:["quickFilter","advanced"],onChange:o,label:M})})]}),e.jsxs("section",{role:"group","aria-labelledby":"notifications-follow",children:[e.jsx("h3",{id:"notifications-follow",children:e.jsx(a,{id:"notifications.column_settings.follow",defaultMessage:"New followers:"})}),e.jsxs("div",{className:"column-settings__row",children:[e.jsx(r,{disabled:l==="denied",prefix:"notifications_desktop",settings:i,settingPath:["alerts","follow"],onChange:o,label:h}),m&&e.jsx(r,{prefix:"notifications_push",settings:n,settingPath:["alerts","follow"],onChange:this.onPushChange,label:v}),e.jsx(r,{prefix:"notifications",settings:i,settingPath:["shows","follow"],onChange:o,label:x}),e.jsx(r,{prefix:"notifications",settings:i,settingPath:["sounds","follow"],onChange:o,label:j}),e.jsx(r,{prefix:"notifications",settings:i,settingPath:["group","follow"],onChange:o,label:S})]})]}),e.jsxs("section",{role:"group","aria-labelledby":"notifications-follow-request",children:[e.jsx("h3",{id:"notifications-follow-request",children:e.jsx(a,{id:"notifications.column_settings.follow_request",defaultMessage:"New follow requests:"})}),e.jsxs("div",{className:"column-settings__row",children:[e.jsx(r,{disabled:l==="denied",prefix:"notifications_desktop",settings:i,settingPath:["alerts","follow_request"],onChange:o,label:h}),m&&e.jsx(r,{prefix:"notifications_push",settings:n,settingPath:["alerts","follow_request"],onChange:this.onPushChange,label:v}),e.jsx(r,{prefix:"notifications",settings:i,settingPath:["shows","follow_request"],onChange:o,label:x}),e.jsx(r,{prefix:"notifications",settings:i,settingPath:["sounds","follow_request"],onChange:o,label:j})]})]}),e.jsxs("section",{role:"group","aria-labelledby":"notifications-favourite",children:[e.jsx("h3",{id:"notifications-favourite",children:e.jsx(a,{id:"notifications.column_settings.favourite",defaultMessage:"Favorites:"})}),e.jsxs("div",{className:"column-settings__row",children:[e.jsx(r,{disabled:l==="denied",prefix:"notifications_desktop",settings:i,settingPath:["alerts","favourite"],onChange:o,label:h}),m&&e.jsx(r,{prefix:"notifications_push",settings:n,settingPath:["alerts","favourite"],onChange:this.onPushChange,label:v}),e.jsx(r,{prefix:"notifications",settings:i,settingPath:["shows","favourite"],onChange:o,label:x}),e.jsx(r,{prefix:"notifications",settings:i,settingPath:["sounds","favourite"],onChange:o,label:j})]})]}),e.jsxs("section",{role:"group","aria-labelledby":"notifications-mention",children:[e.jsx("h3",{id:"notifications-mention",children:e.jsx(a,{id:"notifications.column_settings.mention",defaultMessage:"Mentions:"})}),e.jsxs("div",{className:"column-settings__row",children:[e.jsx(r,{disabled:l==="denied",prefix:"notifications_desktop",settings:i,settingPath:["alerts","mention"],onChange:o,label:h}),m&&e.jsx(r,{prefix:"notifications_push",settings:n,settingPath:["alerts","mention"],onChange:this.onPushChange,label:v}),e.jsx(r,{prefix:"notifications",settings:i,settingPath:["shows","mention"],onChange:o,label:x}),e.jsx(r,{prefix:"notifications",settings:i,settingPath:["sounds","mention"],onChange:o,label:j})]})]}),e.jsxs("section",{role:"group","aria-labelledby":"notifications-reblog",children:[e.jsx("h3",{id:"notifications-reblog",children:e.jsx(a,{id:"notifications.column_settings.reblog",defaultMessage:"Boosts:"})}),e.jsxs("div",{className:"column-settings__row",children:[e.jsx(r,{disabled:l==="denied",prefix:"notifications_desktop",settings:i,settingPath:["alerts","reblog"],onChange:o,label:h}),m&&e.jsx(r,{prefix:"notifications_push",settings:n,settingPath:["alerts","reblog"],onChange:this.onPushChange,label:v}),e.jsx(r,{prefix:"notifications",settings:i,settingPath:["shows","reblog"],onChange:o,label:x}),e.jsx(r,{prefix:"notifications",settings:i,settingPath:["sounds","reblog"],onChange:o,label:j})]})]}),e.jsxs("section",{role:"group","aria-labelledby":"notifications-poll",children:[e.jsx("h3",{id:"notifications-poll",children:e.jsx(a,{id:"notifications.column_settings.poll",defaultMessage:"Poll results:"})}),e.jsxs("div",{className:"column-settings__row",children:[e.jsx(r,{disabled:l==="denied",prefix:"notifications_desktop",settings:i,settingPath:["alerts","poll"],onChange:o,label:h}),m&&e.jsx(r,{prefix:"notifications_push",settings:n,settingPath:["alerts","poll"],onChange:this.onPushChange,label:v}),e.jsx(r,{prefix:"notifications",settings:i,settingPath:["shows","poll"],onChange:o,label:x}),e.jsx(r,{prefix:"notifications",settings:i,settingPath:["sounds","poll"],onChange:o,label:j})]})]}),e.jsxs("section",{role:"group","aria-labelledby":"notifications-status",children:[e.jsx("h3",{id:"notifications-status",children:e.jsx(a,{id:"notifications.column_settings.status",defaultMessage:"New posts:"})}),e.jsxs("div",{className:"column-settings__row",children:[e.jsx(r,{disabled:l==="denied",prefix:"notifications_desktop",settings:i,settingPath:["alerts","status"],onChange:o,label:h}),m&&e.jsx(r,{prefix:"notifications_push",settings:n,settingPath:["alerts","status"],onChange:this.onPushChange,label:v}),e.jsx(r,{prefix:"notifications",settings:i,settingPath:["shows","status"],onChange:o,label:x}),e.jsx(r,{prefix:"notifications",settings:i,settingPath:["sounds","status"],onChange:o,label:j})]})]}),e.jsxs("section",{role:"group","aria-labelledby":"notifications-update",children:[e.jsx("h3",{id:"notifications-update",children:e.jsx(a,{id:"notifications.column_settings.update",defaultMessage:"Edits:"})}),e.jsxs("div",{className:"column-settings__row",children:[e.jsx(r,{disabled:l==="denied",prefix:"notifications_desktop",settings:i,settingPath:["alerts","update"],onChange:o,label:h}),m&&e.jsx(r,{prefix:"notifications_push",settings:n,settingPath:["alerts","update"],onChange:this.onPushChange,label:v}),e.jsx(r,{prefix:"notifications",settings:i,settingPath:["shows","update"],onChange:o,label:x}),e.jsx(r,{prefix:"notifications",settings:i,settingPath:["sounds","update"],onChange:o,label:j})]})]}),(this.props.identity.permissions&le)===le&&e.jsxs("section",{role:"group","aria-labelledby":"notifications-admin-sign-up",children:[e.jsx("h3",{id:"notifications-status",children:e.jsx(a,{id:"notifications.column_settings.admin.sign_up",defaultMessage:"New sign-ups:"})}),e.jsxs("div",{className:"column-settings__row",children:[e.jsx(r,{disabled:l==="denied",prefix:"notifications_desktop",settings:i,settingPath:["alerts","admin.sign_up"],onChange:o,label:h}),m&&e.jsx(r,{prefix:"notifications_push",settings:n,settingPath:["alerts","admin.sign_up"],onChange:this.onPushChange,label:v}),e.jsx(r,{prefix:"notifications",settings:i,settingPath:["shows","admin.sign_up"],onChange:o,label:x}),e.jsx(r,{prefix:"notifications",settings:i,settingPath:["sounds","admin.sign_up"],onChange:o,label:j})]})]}),(this.props.identity.permissions&re)===re&&e.jsxs("section",{role:"group","aria-labelledby":"notifications-admin-report",children:[e.jsx("h3",{id:"notifications-status",children:e.jsx(a,{id:"notifications.column_settings.admin.report",defaultMessage:"New reports:"})}),e.jsxs("div",{className:"column-settings__row",children:[e.jsx(r,{disabled:l==="denied",prefix:"notifications_desktop",settings:i,settingPath:["alerts","admin.report"],onChange:o,label:h}),m&&e.jsx(r,{prefix:"notifications_push",settings:n,settingPath:["alerts","admin.report"],onChange:this.onPushChange,label:v}),e.jsx(r,{prefix:"notifications",settings:i,settingPath:["shows","admin.report"],onChange:o,label:x}),e.jsx(r,{prefix:"notifications",settings:i,settingPath:["sounds","admin.report"],onChange:o,label:j})]})]})]})}}const ts=Ze(es),de=k({permissionDenied:{id:"notifications.permission_denied_alert",defaultMessage:"Desktop notifications can't be enabled, as browser permission has been denied before"}}),ss=t=>({settings:t.getIn(["settings","notifications"]),pushSettings:t.get("push_notifications"),alertsEnabled:t.getIn(["settings","notifications","alerts"]).includes(!0),browserSupport:t.getIn(["notifications","browserSupport"]),browserPermission:t.getIn(["notifications","browserPermission"])}),is=t=>({onChange(s,i){s[0]==="push"?i&&typeof window.Notification<"u"&&Notification.permission!=="granted"?t($(n=>{t(n==="granted"?ae(s.slice(1),i):ie({message:de.permissionDenied}))})):t(ae(s.slice(1),i)):s[0]==="quickFilter"?(t(R(["notifications",...s],i)),t(xe("all"))):s[0]==="alerts"&&i&&typeof window.Notification<"u"&&Notification.permission!=="granted"?i&&typeof window.Notification<"u"&&Notification.permission!=="granted"?t($(n=>{t(n==="granted"?R(["notifications",...s],i):ie({message:de.permissionDenied}))})):t(R(["notifications",...s],i)):(t(R(["notifications",...s],i)),s[0]==="group"&&s[1]==="follow"&&t(He()))},onClear(){t(he({modalType:"CONFIRM_CLEAR_NOTIFICATIONS"}))},onRequestNotificationPermission(){t($())}}),os=fe(ge(ss,is)(ts)),ns=k({other:{id:"report_notification.categories.other_sentence",defaultMessage:"other"},spam:{id:"report_notification.categories.spam_sentence",defaultMessage:"spam"},legal:{id:"report_notification.categories.legal_sentence",defaultMessage:"illegal content"},violation:{id:"report_notification.categories.violation_sentence",defaultMessage:"rule violation"}}),as=({notification:t,notification:{report:s},unread:i})=>{const n=F(),o=p(b=>b.accounts.get(s.targetAccountId)),c=p(b=>b.accounts.get(t.sampleAccountIds[0]??"0"));if(!c||!o)return null;const u=c.acct.split("@")[1],g={name:e.jsx("bdi",{children:u??`@${c.acct}`}),target:e.jsxs("bdi",{children:["@",o.acct]}),category:n.formatMessage(ns[s.category]),count:s.status_ids.length};let l;return s.status_ids.length>0?s.category==="other"?l=e.jsx(a,{id:"notification.admin.report_account_other",defaultMessage:"{name} reported {count, plural, one {one post} other {# posts}} from {target}",values:g}):l=e.jsx(a,{id:"notification.admin.report_account",defaultMessage:"{name} reported {count, plural, one {one post} other {# posts}} from {target} for {category}",values:g}):s.category==="other"?l=e.jsx(a,{id:"notification.admin.report_statuses_other",defaultMessage:"{name} reported {target}",values:g}):l=e.jsx(a,{id:"notification.admin.report_statuses",defaultMessage:"{name} reported {target} for {category}",values:g}),e.jsxs("a",{href:`/admin/reports/${s.id}`,target:"_blank",rel:"noopener noreferrer",className:L("notification-group notification-group--link notification-group--admin-report focusable",{"notification-group--unread":i}),children:[e.jsx("div",{className:"notification-group__icon",children:e.jsx(_,{id:"flag",icon:Ct})}),e.jsxs("div",{className:"notification-group__main",children:[e.jsx("div",{className:"notification-group__main__header",children:e.jsxs("div",{className:"notification-group__main__header__label",children:[l,e.jsx(Me,{timestamp:s.created_at})]})}),s.comment.length>0&&e.jsxs("div",{className:"notification-group__embedded-status__content",children:["“",s.comment,"”"]})]})]})},Ne=28,ls=({accountId:t})=>{const s=p(i=>i.accounts.get(t));return s?e.jsx(Oe,{withLink:!0,account:s,size:Ne}):null},E=({icon:t,iconId:s,timestamp:i,accountIds:n,actions:o,count:c,statusId:u,labelRenderer:g,labelSeeMoreHref:l,type:b,unread:M,additionalContent:N})=>{const h=P(),x=d.useMemo(()=>g(e.jsx(ye,{accountIds:n}),c,l),[g,n,c,l]),j=p(m=>m.statuses.getIn([u,"visibility"])==="direct"),S=d.useMemo(()=>({open:()=>{h(je(u))},reply:()=>{h(_e(u))}}),[h,u]);return e.jsx(W.HotKeys,{handlers:S,children:e.jsxs("div",{role:"button",className:L(`notification-group focusable notification-group--${b}`,{"notification-group--unread":M,"notification-group--direct":j}),tabIndex:0,children:[e.jsx("div",{className:"notification-group__icon",children:e.jsx(_,{icon:t,id:s})}),e.jsxs("div",{className:"notification-group__main",children:[e.jsxs("div",{className:"notification-group__main__header",children:[e.jsxs("div",{className:"notification-group__main__header__wrapper",children:[e.jsx(At,{avatarHeight:Ne,children:n.slice(0,Ge).map(m=>e.jsx(ls,{accountId:m},m))}),o&&e.jsx("div",{className:"notification-group__actions",children:o})]}),e.jsxs("div",{className:"notification-group__main__header__label",children:[x,i&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"notification-group__main__header__label-separator",children:"·"}),e.jsx(Me,{timestamp:i})]})]})]}),u&&e.jsx("div",{className:"notification-group__main__status",children:e.jsx(qt,{statusId:u})}),N&&e.jsx("div",{className:"notification-group__main__additional-content",children:N})]})]})})},rs=(t,s)=>s===1?e.jsx(a,{id:"notification.admin.sign_up",defaultMessage:"{name} signed up",values:{name:t}}):e.jsx(a,{id:"notification.admin.sign_up.name_and_others",defaultMessage:"{name} and {count, plural, one {# other} other {# others}} signed up",values:{name:t,count:s-1}}),cs=({notification:t,unread:s})=>e.jsx(E,{type:"admin-sign-up",icon:V,iconId:"person-add",accountIds:t.sampleAccountIds,timestamp:t.latest_page_notification_at,count:t.notifications_count,labelRenderer:rs,unread:s}),ds=t=>d.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:24,viewBox:"0 -960 960 960",width:24,...t},d.createElement("path",{d:"m80-80 200-560 360 360L80-80Zm132-132 282-100-182-182-100 282Zm370-246-42-42 224-224q32-32 77-32t77 32l24 24-42 42-24-24q-14-14-35-14t-35 14L582-458ZM422-618l-42-42 24-24q14-14 14-34t-14-34l-26-26 42-42 26 26q32 32 32 76t-32 76l-24 24Zm80 80-42-42 144-144q14-14 14-35t-14-35l-64-64 42-42 64 64q32 32 32 77t-32 77L502-538Zm160 160-42-42 64-64q32-32 77-32t77 32l64 64-42 42-64-64q-14-14-35-14t-35 14l-64 64ZM212-212Z"})),us=({notification:{annualReport:t},unread:s})=>{const i=P(),n=t.year,o=d.useCallback(()=>{i(he({modalType:"ANNUAL_REPORT",modalProps:{year:n}}))},[i,n]);return e.jsxs("div",{role:"button",className:L("notification-group notification-group--link notification-group--annual-report focusable",{"notification-group--unread":s}),tabIndex:0,children:[e.jsx("div",{className:"notification-group__icon",children:e.jsx(_,{id:"celebration",icon:ds})}),e.jsxs("div",{className:"notification-group__main",children:[e.jsx("p",{children:e.jsx(a,{id:"notification.annual_report.message",defaultMessage:"Your {year} #Wrapstodon awaits! Unveil your year's highlights and memorable moments on Mastodon!",values:{year:n}})}),e.jsx("button",{onClick:o,className:"link-button",children:e.jsx(a,{id:"notification.annual_report.view",defaultMessage:"View #Wrapstodon"})})]})]})},fs=(t,s,i)=>s===1?e.jsx(a,{id:"notification.favourite",defaultMessage:"{name} favorited your post",values:{name:t}}):e.jsx(a,{id:"notification.favourite.name_and_others_with_link",defaultMessage:"{name} and <a>{count, plural, one {# other} other {# others}}</a> favorited your post",values:{name:t,count:s-1,a:n=>i?e.jsx(T,{to:i,children:n}):n}}),ps=(t,s,i)=>s===1?e.jsx(a,{id:"notification.favourite_pm",defaultMessage:"{name} favorited your private mention",values:{name:t}}):e.jsx(a,{id:"notification.favourite_pm.name_and_others_with_link",defaultMessage:"{name} and <a>{count, plural, one {# other} other {# others}}</a> favorited your private mention",values:{name:t,count:s-1,a:n=>i?e.jsx(T,{to:i,children:n}):n}}),ms=({notification:t,unread:s})=>{const{statusId:i}=t,n=p(c=>{var u;return(u=c.accounts.get(c.statuses.getIn([i,"account"])))==null?void 0:u.acct}),o=p(c=>c.statuses.getIn([i,"visibility"])==="direct");return e.jsx(E,{type:"favourite",icon:Ue,iconId:"star",accountIds:t.sampleAccountIds,statusId:t.statusId,timestamp:t.latest_page_notification_at,count:t.notifications_count,labelRenderer:o?ps:fs,labelSeeMoreHref:n?`/@${n}/${i}/favourites`:void 0,unread:s})},gs=(t,s,i)=>s===1?e.jsx(a,{id:"notification.follow",defaultMessage:"{name} followed you",values:{name:t}}):e.jsx(a,{id:"notification.follow.name_and_others",defaultMessage:"{name} and <a>{count, plural, one {# other} other {# others}}</a> followed you",values:{name:t,count:s-1,a:n=>i?e.jsx(T,{to:i,children:n}):n}}),hs=({accountId:t})=>{const s=p(i=>i.accounts.get(t));return s?e.jsx(Nt,{value:s.followers_count,renderer:Rt}):null},xs=({notification:t,unread:s})=>{const i=p(c=>c.accounts.getIn([K,"username"]));let n,o;if(t.sampleAccountIds.length===1){const c=t.sampleAccountIds[0];c&&(n=e.jsx(Ft,{compact:!0,accountId:t.sampleAccountIds[0]}),o=e.jsx(hs,{accountId:c}))}return e.jsx(E,{type:"follow",icon:V,iconId:"person-add",accountIds:t.sampleAccountIds,timestamp:t.latest_page_notification_at,count:t.notifications_count,labelRenderer:gs,labelSeeMoreHref:`/@${i}/followers`,unread:s,actions:n,additionalContent:o})},ue=k({authorize:{id:"follow_request.authorize",defaultMessage:"Authorize"},reject:{id:"follow_request.reject",defaultMessage:"Reject"}}),_s=(t,s)=>s===1?e.jsx(a,{id:"notification.follow_request",defaultMessage:"{name} has requested to follow you",values:{name:t}}):e.jsx(a,{id:"notification.follow_request.name_and_others",defaultMessage:"{name} and {count, plural, one {# other} other {# others}} has requested to follow you",values:{name:t,count:s-1}}),js=({notification:t,unread:s})=>{const i=F(),n=P(),o=d.useCallback(()=>{n(ze(t.sampleAccountIds[0]))},[n,t.sampleAccountIds]),c=d.useCallback(()=>{n(We(t.sampleAccountIds[0]))},[n,t.sampleAccountIds]),u=e.jsxs(e.Fragment,{children:[e.jsx(z,{title:i.formatMessage(ue.reject),icon:"times",iconComponent:we,onClick:c}),e.jsx(z,{title:i.formatMessage(ue.authorize),icon:"check",iconComponent:Ve,onClick:o})]});return e.jsx(E,{type:"follow-request",icon:V,iconId:"person-add",accountIds:t.sampleAccountIds,timestamp:t.latest_page_notification_at,count:t.notifications_count,labelRenderer:_s,actions:u,unread:s})},bs=t=>d.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:24,viewBox:"0 -960 960 960",width:24,...t},d.createElement("path",{d:"M760-200v-160q0-50-35-85t-85-35H273l144 144-57 56-240-240 240-240 57 56-144 144h367q83 0 141.5 58.5T840-360v160h-80Z"})),D=({icon:t,iconId:s,accountIds:i,statusId:n,count:o,labelRenderer:c,type:u,unread:g})=>{const l=P(),b=d.useMemo(()=>c(e.jsx(ye,{accountIds:i}),o),[c,i,o]),M=p(x=>x.statuses.getIn([n,"visibility"])==="direct"),N=p(x=>n&&Tt(x,{id:n,contextType:"notifications"})),h=d.useMemo(()=>({open:()=>{l(je(n))},reply:()=>{l(_e(n))},boost:()=>{l(Ye(n))},favourite:()=>{l(Qe(n))},toggleHidden:()=>{l(Ke(n))}}),[l,n]);return!n||N?null:e.jsx(W.HotKeys,{handlers:h,children:e.jsxs("div",{role:"button",className:L(`notification-ungrouped focusable notification-ungrouped--${u}`,{"notification-ungrouped--unread":g,"notification-ungrouped--direct":M}),tabIndex:0,children:[e.jsxs("div",{className:"notification-ungrouped__header",children:[e.jsx("div",{className:"notification-ungrouped__header__icon",children:e.jsx(_,{icon:t,id:s})}),b]}),e.jsx(Bt,{id:n,contextType:"notifications",withDismiss:!0,skipPrepend:!0,avatarSize:40,unfocusable:!0})]})})},vs=()=>e.jsx(a,{id:"notification.label.mention",defaultMessage:"Mention"}),ws=()=>e.jsx(a,{id:"notification.label.private_mention",defaultMessage:"Private mention"}),Ms=()=>e.jsx(a,{id:"notification.label.reply",defaultMessage:"Reply"}),ys=()=>e.jsx(a,{id:"notification.label.private_reply",defaultMessage:"Private reply"}),Ns=({notification:t,unread:s})=>{const[i,n]=p(c=>{const u=t.statusId?c.statuses.get(t.statusId):void 0;return u?[u.get("visibility")==="direct",u.get("in_reply_to_account_id")===K]:[!1,!1]},pe);let o=vs;return n&&i?o=ys:n?o=Ms:i&&(o=ws),e.jsx(D,{type:"mention",icon:n?bs:Et,iconId:"reply",accountIds:t.sampleAccountIds,count:t.notifications_count,statusId:t.statusId,labelRenderer:o,unread:s})},Ps=({notification:{moderationWarning:t},unread:s})=>e.jsx(kt,{action:t.action,id:t.id,unread:s}),Ss=()=>e.jsx(a,{id:"notification.poll",defaultMessage:"A poll you voted in has ended"}),Cs=()=>e.jsx(a,{id:"notification.own_poll",defaultMessage:"Your poll has ended"}),ks=({notification:t,unread:s})=>e.jsx(D,{type:"poll",icon:$t,iconId:"bar-chart-4-bars",accountIds:t.sampleAccountIds,count:t.notifications_count,statusId:t.statusId,labelRenderer:t.sampleAccountIds[0]===K?Cs:Ss,unread:s}),Is=(t,s,i)=>s===1?e.jsx(a,{id:"notification.reblog",defaultMessage:"{name} boosted your post",values:{name:t}}):e.jsx(a,{id:"notification.reblog.name_and_others_with_link",defaultMessage:"{name} and <a>{count, plural, one {# other} other {# others}}</a> boosted your post",values:{name:t,count:s-1,a:n=>i?e.jsx(T,{to:i,children:n}):n}}),As=({notification:t,unread:s})=>{const{statusId:i}=t,n=p(o=>{var c;return(c=o.accounts.get(o.statuses.getIn([i,"account"])))==null?void 0:c.acct});return e.jsx(E,{type:"reblog",icon:be,iconId:"repeat",accountIds:t.sampleAccountIds,statusId:t.statusId,timestamp:t.latest_page_notification_at,count:t.notifications_count,labelRenderer:Is,labelSeeMoreHref:n?`/@${n}/${i}/reblogs`:void 0,unread:s})},qs=({notification:{event:t},unread:s})=>e.jsx(It,{type:t.type,target:t.target_name,followersCount:t.followers_count,followingCount:t.following_count,unread:s}),Rs=t=>e.jsx(a,{id:"notification.status",defaultMessage:"{name} just posted",values:{name:t}}),Fs=({notification:t,unread:s})=>e.jsx(D,{type:"status",icon:Lt,iconId:"notifications-active",accountIds:t.sampleAccountIds,count:t.notifications_count,statusId:t.statusId,labelRenderer:Rs,unread:s}),Ts=t=>e.jsx(a,{id:"notification.update",defaultMessage:"{name} edited a post",values:{name:t}}),Es=({notification:t,unread:s})=>e.jsx(D,{type:"update",icon:Dt,iconId:"edit",accountIds:t.sampleAccountIds,count:t.notifications_count,statusId:t.statusId,labelRenderer:Ts,unread:s}),Bs=({notificationGroupId:t,unread:s,onMoveUp:i,onMoveDown:n})=>{const o=p(b=>b.notificationGroups.groups.find(M=>M.type!=="gap"&&M.group_key===t)),c=P(),u=(o==null?void 0:o.type)==="gap"||o==null?void 0:o.sampleAccountIds[0],g=d.useMemo(()=>({moveUp:()=>{i(t)},moveDown:()=>{n(t)},openProfile:()=>{u&&c(Je(u))},mention:()=>{u&&c(Xe(u))}}),[c,t,u,i,n]);if(!o||o.type==="gap")return null;let l;switch(o.type){case"reblog":l=e.jsx(As,{unread:s,notification:o});break;case"favourite":l=e.jsx(ms,{unread:s,notification:o});break;case"severed_relationships":l=e.jsx(qs,{unread:s,notification:o});break;case"mention":l=e.jsx(Ns,{unread:s,notification:o});break;case"follow":l=e.jsx(xs,{unread:s,notification:o});break;case"follow_request":l=e.jsx(js,{unread:s,notification:o});break;case"poll":l=e.jsx(ks,{unread:s,notification:o});break;case"status":l=e.jsx(Fs,{unread:s,notification:o});break;case"update":l=e.jsx(Es,{unread:s,notification:o});break;case"admin.sign_up":l=e.jsx(cs,{unread:s,notification:o});break;case"admin.report":l=e.jsx(as,{unread:s,notification:o});break;case"moderation_warning":l=e.jsx(Ps,{unread:s,notification:o});break;case"annual_report":l=e.jsx(us,{unread:s,notification:o});break;default:return null}return e.jsx(W.HotKeys,{handlers:g,children:l})},A=k({mentions:{id:"notifications.filter.mentions",defaultMessage:"Mentions"},favourites:{id:"notifications.filter.favourites",defaultMessage:"Favorites"},boosts:{id:"notifications.filter.boosts",defaultMessage:"Boosts"},polls:{id:"notifications.filter.polls",defaultMessage:"Poll results"},follows:{id:"notifications.filter.follows",defaultMessage:"Follows"},statuses:{id:"notifications.filter.statuses",defaultMessage:"Updates from people you follow"}}),y=({selectedFilter:t,type:s,title:i,children:n})=>{const o=P(),c=d.useCallback(()=>{o(xe({filterType:s}))},[o,s]);return e.jsx("button",{className:t===s?"active":"",onClick:c,title:i,children:n})},$s=()=>{const t=F(),s=p(et);return p(tt)?e.jsxs("div",{className:"notification__filter-bar",children:[e.jsx(y,{selectedFilter:s,type:"all",children:e.jsx(a,{id:"notifications.filter.all",defaultMessage:"All"})},"all"),e.jsx(y,{selectedFilter:s,type:"mention",title:t.formatMessage(A.mentions),children:e.jsx(_,{id:"reply-all",icon:st})},"mention"),e.jsx(y,{selectedFilter:s,type:"favourite",title:t.formatMessage(A.favourites),children:e.jsx(_,{id:"star",icon:it})},"favourite"),e.jsx(y,{selectedFilter:s,type:"reblog",title:t.formatMessage(A.boosts),children:e.jsx(_,{id:"retweet",icon:be})},"reblog"),e.jsx(y,{selectedFilter:s,type:"poll",title:t.formatMessage(A.polls),children:e.jsx(_,{id:"tasks",icon:Ht})},"poll"),e.jsx(y,{selectedFilter:s,type:"status",title:t.formatMessage(A.statuses),children:e.jsx(_,{id:"home",icon:Zt})},"status"),e.jsx(y,{selectedFilter:s,type:"follow",title:t.formatMessage(A.follows),children:e.jsx(_,{id:"user-plus",icon:Gt})},"follow")]}):e.jsxs("div",{className:"notification__filter-bar",children:[e.jsx(y,{selectedFilter:s,type:"all",children:e.jsx(a,{id:"notifications.filter.all",defaultMessage:"All"})},"all"),e.jsx(y,{selectedFilter:s,type:"mention",children:e.jsx(a,{id:"notifications.filter.mentions",defaultMessage:"Mentions"})},"mention")]})},q=k({title:{id:"column.notifications",defaultMessage:"Notifications"},markAsRead:{id:"notifications.mark_as_read",defaultMessage:"Mark every notification as read"}}),to=({columnId:t,multiColumn:s})=>{var ee;const i=F(),n=p(ht,pe),o=P(),c=p(f=>f.notificationGroups.isLoading),u=((ee=n.at(-1))==null?void 0:ee.type)==="gap",g=p(f=>oe(f)?f.notificationGroups.readMarkerId:"0"),l=p(xt),b=p(_t),M=p(jt),N=p(f=>f.notificationGroups.mergedNotifications==="needs-reload"),h=b>0||N,x=p(oe)&&M,j=p(ot),S=d.useRef(null),m=d.useCallback((f,I)=>{var te;const w=(te=S.current)==null?void 0:te.node;if(!w)return;const C=w.querySelector(`article:nth-of-type(${f+1}) .focusable`);C&&(I&&w.scrollTop>C.offsetTop?C.scrollIntoView(!0):!I&&w.scrollTop+w.clientHeight<C.offsetTop+C.offsetHeight&&C.scrollIntoView(!1),C.focus())},[]);d.useEffect(()=>(o(nt()),()=>{o(at()),o(U({top:!1}))}),[o]);const v=d.useCallback(f=>{o(ne({gap:f}))},[o]),Z=O(()=>{const f=n.at(-1);(f==null?void 0:f.type)==="gap"&&o(ne({gap:f}))},300,{leading:!0}),Pe=d.useCallback(()=>{o(lt())},[o]),H=O(()=>{o(U({top:!0}))},100),G=O(()=>{o(U({top:!1}))},100);d.useEffect(()=>()=>{Z.cancel(),H.cancel(),G.cancel()},[Z,H,G]);const Se=d.useCallback(()=>{o(t?rt(t):ct("NOTIFICATIONS",{}))},[t,o]),Ce=d.useCallback(f=>{o(dt(t,f))},[o,t]),ke=d.useCallback(()=>{var f;(f=S.current)==null||f.scrollTop()},[]),Q=d.useCallback(f=>{const I=n.findIndex(w=>w.type!=="gap"&&w.group_key===f)-1;m(I,!0)},[n,m]),Y=d.useCallback(f=>{const I=n.findIndex(w=>w.type!=="gap"&&w.group_key===f)+1;m(I,!1)},[n,m]),Ie=d.useCallback(()=>{o(ut()),o(ft({immediate:!0}))},[o]),X=!!t,Ae=e.jsx(a,{id:"empty_column.notifications",defaultMessage:"You don't have any notifications yet. When other people interact with you, you will see it here."}),{signedIn:J}=pt(),qe=J?e.jsx($s,{}):null,Re=d.useMemo(()=>n.length===0&&!u?null:n.map(f=>f.type==="gap"?e.jsx(wt,{disabled:c,param:f,onClick:v},`${f.maxId}-${f.sinceId}`):e.jsx(Bs,{notificationGroupId:f.group_key,onMoveUp:Q,onMoveDown:Y,unread:g!=="0"&&!!f.page_max_id&&mt(f.page_max_id,g)>0},f.group_key)),[n,c,u,g,v,Q,Y]),Fe=e.jsxs(e.Fragment,{children:[j&&e.jsx(Qt,{}),e.jsx(zt,{})]}),Te=J?e.jsx(Mt,{scrollKey:`notifications-${t}`,trackScroll:!X,isLoading:c,showLoading:c&&n.length===0,hasMore:u,numPending:l,prepend:Fe,alwaysPrepend:!0,emptyMessage:Ae,onLoadMore:Z,onLoadPending:Pe,onScrollToTop:H,onScroll:G,bindToDocument:!s,children:Re}):e.jsx(gt,{}),Ee=e.jsxs(e.Fragment,{children:[e.jsx(Ut,{className:"column-header__button"}),x&&e.jsx("button",{"aria-label":i.formatMessage(q.markAsRead),title:i.formatMessage(q.markAsRead),onClick:Ie,className:"column-header__button",children:e.jsx(_,{id:"done-all",icon:Ot})})]});return e.jsxs(bt,{bindToDocument:!s,ref:S,label:i.formatMessage(q.title),children:[e.jsx(vt,{icon:"bell",iconComponent:De,active:h,title:i.formatMessage(q.title),onPin:Se,onMove:Ce,onClick:ke,pinned:X,multiColumn:s,extraButton:Ee,children:e.jsx(os,{})}),qe,Te,e.jsxs(Le,{children:[e.jsx("title",{children:i.formatMessage(q.title)}),e.jsx("meta",{name:"robots",content:"noindex"})]})]})};export{to as Notifications,to as default};
//# sourceMappingURL=notifications_v2-index-B85S9RcC.js.map
