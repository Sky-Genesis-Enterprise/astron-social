{"version":3,"file":"detailed_status-BXIq3on5.js","sources":["../../app/javascript/mastodon/components/edited_timestamp/index.tsx","../../app/javascript/mastodon/features/status/components/detailed_status.tsx"],"sourcesContent":["import { useCallback } from 'react';\n\nimport { FormattedMessage } from 'react-intl';\n\nimport type { Map as ImmutableMap, List as ImmutableList } from 'immutable';\n\nimport { fetchHistory } from 'mastodon/actions/history';\nimport { openModal } from 'mastodon/actions/modal';\nimport { Dropdown } from 'mastodon/components/dropdown_menu';\nimport { FormattedDateWrapper } from 'mastodon/components/formatted_date';\nimport InlineAccount from 'mastodon/components/inline_account';\nimport { RelativeTimestamp } from 'mastodon/components/relative_timestamp';\nimport { useAppDispatch, useAppSelector } from 'mastodon/store';\n\ntype HistoryItem = ImmutableMap<string, unknown>;\n\nexport const EditedTimestamp: React.FC<{\n  statusId: string;\n  timestamp: string;\n}> = ({ statusId, timestamp }) => {\n  const dispatch = useAppDispatch();\n  const items = useAppSelector(\n    (state) =>\n      (\n        state.history.getIn([statusId, 'items']) as\n          | ImmutableList<unknown>\n          | undefined\n      )?.toArray() as HistoryItem[],\n  );\n  const loading = useAppSelector(\n    (state) => state.history.getIn([statusId, 'loading']) as boolean,\n  );\n\n  const handleOpen = useCallback(() => {\n    dispatch(fetchHistory(statusId));\n  }, [dispatch, statusId]);\n\n  const handleItemClick = useCallback(\n    (_item: HistoryItem, index: number) => {\n      dispatch(\n        openModal({\n          modalType: 'COMPARE_HISTORY',\n          modalProps: { index, statusId },\n        }),\n      );\n    },\n    [dispatch, statusId],\n  );\n\n  const renderHeader = useCallback((items: HistoryItem[]) => {\n    return (\n      <FormattedMessage\n        id='status.edited_x_times'\n        defaultMessage='Edited {count, plural, one {# time} other {# times}}'\n        values={{ count: items.length - 1 }}\n      />\n    );\n  }, []);\n\n  const renderItem = useCallback(\n    (\n      item: HistoryItem,\n      index: number,\n      {\n        onClick,\n        onKeyUp,\n      }: {\n        onClick: React.MouseEventHandler;\n        onKeyUp: React.KeyboardEventHandler;\n      },\n    ) => {\n      const formattedDate = (\n        <RelativeTimestamp\n          timestamp={item.get('created_at') as string}\n          short={false}\n        />\n      );\n      const formattedName = (\n        <InlineAccount accountId={item.get('account') as string} />\n      );\n\n      const label = (item.get('original') as boolean) ? (\n        <FormattedMessage\n          id='status.history.created'\n          defaultMessage='{name} created {date}'\n          values={{ name: formattedName, date: formattedDate }}\n        />\n      ) : (\n        <FormattedMessage\n          id='status.history.edited'\n          defaultMessage='{name} edited {date}'\n          values={{ name: formattedName, date: formattedDate }}\n        />\n      );\n\n      return (\n        <li\n          className='dropdown-menu__item edited-timestamp__history__item'\n          key={item.get('created_at') as string}\n        >\n          <button data-index={index} onClick={onClick} onKeyUp={onKeyUp}>\n            {label}\n          </button>\n        </li>\n      );\n    },\n    [],\n  );\n\n  return (\n    <Dropdown<HistoryItem>\n      items={items}\n      loading={loading}\n      renderItem={renderItem}\n      scrollable\n      renderHeader={renderHeader}\n      onOpen={handleOpen}\n      onItemClick={handleItemClick}\n      forceDropdown\n    >\n      <button className='dropdown-menu__text-button'>\n        <FormattedMessage\n          id='status.edited'\n          defaultMessage='Edited {date}'\n          values={{\n            date: (\n              <FormattedDateWrapper\n                className='animated-number'\n                value={timestamp}\n                month='short'\n                day='2-digit'\n                hour='2-digit'\n                minute='2-digit'\n              />\n            ),\n          }}\n        />\n      </button>\n    </Dropdown>\n  );\n};\n","/* eslint-disable @typescript-eslint/no-unsafe-member-access,\n                  @typescript-eslint/no-unsafe-call,\n                  @typescript-eslint/no-explicit-any,\n                  @typescript-eslint/no-unsafe-assignment */\n\nimport type { CSSProperties } from 'react';\nimport { useState, useRef, useCallback } from 'react';\n\nimport { FormattedMessage } from 'react-intl';\n\nimport classNames from 'classnames';\nimport { Link } from 'react-router-dom';\n\nimport AlternateEmailIcon from '@/material-icons/400-24px/alternate_email.svg?react';\nimport { AnimatedNumber } from 'mastodon/components/animated_number';\nimport { Avatar } from 'mastodon/components/avatar';\nimport { ContentWarning } from 'mastodon/components/content_warning';\nimport { DisplayName } from 'mastodon/components/display_name';\nimport { EditedTimestamp } from 'mastodon/components/edited_timestamp';\nimport { FilterWarning } from 'mastodon/components/filter_warning';\nimport { FormattedDateWrapper } from 'mastodon/components/formatted_date';\nimport type { StatusLike } from 'mastodon/components/hashtag_bar';\nimport { getHashtagBarForStatus } from 'mastodon/components/hashtag_bar';\nimport { Icon } from 'mastodon/components/icon';\nimport { IconLogo } from 'mastodon/components/logo';\nimport MediaGallery from 'mastodon/components/media_gallery';\nimport { PictureInPicturePlaceholder } from 'mastodon/components/picture_in_picture_placeholder';\nimport StatusContent from 'mastodon/components/status_content';\nimport { QuotedStatus } from 'mastodon/components/status_quoted';\nimport { VisibilityIcon } from 'mastodon/components/visibility_icon';\nimport { Audio } from 'mastodon/features/audio';\nimport scheduleIdleTask from 'mastodon/features/ui/util/schedule_idle_task';\nimport { Video } from 'mastodon/features/video';\n\nimport Card from './card';\n\ninterface VideoModalOptions {\n  startTime: number;\n  autoPlay?: boolean;\n  defaultVolume: number;\n}\n\nexport const DetailedStatus: React.FC<{\n  status: any;\n  onOpenMedia?: (status: any, index: number, lang: string) => void;\n  onOpenVideo?: (status: any, lang: string, options: VideoModalOptions) => void;\n  onTranslate?: (status: any) => void;\n  measureHeight?: boolean;\n  onHeightChange?: () => void;\n  domain: string;\n  showMedia?: boolean;\n  withLogo?: boolean;\n  overrideDisplayName?: React.ReactNode;\n  pictureInPicture: any;\n  onToggleHidden?: (status: any) => void;\n  onToggleMediaVisibility?: () => void;\n}> = ({\n  status,\n  onOpenMedia,\n  onOpenVideo,\n  onTranslate,\n  measureHeight,\n  onHeightChange,\n  domain,\n  showMedia,\n  withLogo,\n  overrideDisplayName,\n  pictureInPicture,\n  onToggleMediaVisibility,\n  onToggleHidden,\n}) => {\n  const properStatus = status?.get('reblog') ?? status;\n  const [height, setHeight] = useState(0);\n  const [showDespiteFilter, setShowDespiteFilter] = useState(false);\n  const nodeRef = useRef<HTMLDivElement>();\n\n  const handleOpenVideo = useCallback(\n    (options: VideoModalOptions) => {\n      const lang = (status.getIn(['translation', 'language']) ||\n        status.get('language')) as string;\n      if (onOpenVideo)\n        onOpenVideo(status.getIn(['media_attachments', 0]), lang, options);\n    },\n    [onOpenVideo, status],\n  );\n\n  const handleFilterToggle = useCallback(() => {\n    setShowDespiteFilter(!showDespiteFilter);\n  }, [showDespiteFilter, setShowDespiteFilter]);\n\n  const handleExpandedToggle = useCallback(() => {\n    if (onToggleHidden) onToggleHidden(status);\n  }, [onToggleHidden, status]);\n\n  const _measureHeight = useCallback(\n    (heightJustChanged?: boolean) => {\n      if (measureHeight && nodeRef.current) {\n        scheduleIdleTask(() => {\n          if (nodeRef.current)\n            setHeight(Math.ceil(nodeRef.current.scrollHeight) + 1);\n        });\n\n        if (onHeightChange && heightJustChanged) {\n          onHeightChange();\n        }\n      }\n    },\n    [onHeightChange, measureHeight, setHeight],\n  );\n\n  const handleRef = useCallback(\n    (c: HTMLDivElement) => {\n      nodeRef.current = c;\n      _measureHeight();\n    },\n    [_measureHeight],\n  );\n\n  const handleTranslate = useCallback(() => {\n    if (onTranslate) onTranslate(status);\n  }, [onTranslate, status]);\n\n  if (!properStatus) {\n    return null;\n  }\n\n  let media;\n  let applicationLink;\n  let reblogLink;\n  let attachmentAspectRatio;\n\n  if (properStatus.get('media_attachments').getIn([0, 'type']) === 'video') {\n    attachmentAspectRatio = `${properStatus.get('media_attachments').getIn([0, 'meta', 'original', 'width'])} / ${properStatus.get('media_attachments').getIn([0, 'meta', 'original', 'height'])}`;\n  } else if (\n    properStatus.get('media_attachments').getIn([0, 'type']) === 'audio'\n  ) {\n    attachmentAspectRatio = '16 / 9';\n  } else {\n    attachmentAspectRatio =\n      properStatus.get('media_attachments').size === 1 &&\n      properStatus\n        .get('media_attachments')\n        .getIn([0, 'meta', 'small', 'aspect'])\n        ? properStatus\n            .get('media_attachments')\n            .getIn([0, 'meta', 'small', 'aspect'])\n        : '3 / 2';\n  }\n\n  const outerStyle = { boxSizing: 'border-box' } as CSSProperties;\n\n  if (measureHeight) {\n    outerStyle.height = height;\n  }\n\n  const language =\n    status.getIn(['translation', 'language']) || status.get('language');\n\n  if (pictureInPicture.get('inUse')) {\n    media = <PictureInPicturePlaceholder aspectRatio={attachmentAspectRatio} />;\n  } else if (status.get('media_attachments').size > 0) {\n    if (\n      ['image', 'gifv', 'unknown'].includes(\n        status.getIn(['media_attachments', 0, 'type']) as string,\n      ) ||\n      status.get('media_attachments').size > 1\n    ) {\n      media = (\n        <MediaGallery\n          standalone\n          sensitive={status.get('sensitive')}\n          media={status.get('media_attachments')}\n          lang={language}\n          height={300}\n          onOpenMedia={onOpenMedia}\n          visible={showMedia}\n          onToggleVisibility={onToggleMediaVisibility}\n          matchedFilters={status.get('matched_media_filters')}\n        />\n      );\n    } else if (status.getIn(['media_attachments', 0, 'type']) === 'audio') {\n      const attachment = status.getIn(['media_attachments', 0]);\n      const description =\n        attachment.getIn(['translation', 'description']) ||\n        attachment.get('description');\n\n      media = (\n        <Audio\n          src={attachment.get('url')}\n          alt={description}\n          lang={language}\n          poster={\n            attachment.get('preview_url') ||\n            status.getIn(['account', 'avatar_static'])\n          }\n          duration={attachment.getIn(['meta', 'original', 'duration'], 0)}\n          backgroundColor={attachment.getIn(['meta', 'colors', 'background'])}\n          foregroundColor={attachment.getIn(['meta', 'colors', 'foreground'])}\n          accentColor={attachment.getIn(['meta', 'colors', 'accent'])}\n          sensitive={status.get('sensitive')}\n          visible={showMedia}\n          blurhash={attachment.get('blurhash')}\n          onToggleVisibility={onToggleMediaVisibility}\n          matchedFilters={status.get('matched_media_filters')}\n        />\n      );\n    } else if (status.getIn(['media_attachments', 0, 'type']) === 'video') {\n      const attachment = status.getIn(['media_attachments', 0]);\n      const description =\n        attachment.getIn(['translation', 'description']) ||\n        attachment.get('description');\n\n      media = (\n        <Video\n          preview={attachment.get('preview_url')}\n          frameRate={attachment.getIn(['meta', 'original', 'frame_rate'])}\n          aspectRatio={`${attachment.getIn(['meta', 'original', 'width'])} / ${attachment.getIn(['meta', 'original', 'height'])}`}\n          blurhash={attachment.get('blurhash')}\n          src={attachment.get('url')}\n          alt={description}\n          lang={language}\n          onOpenVideo={handleOpenVideo}\n          sensitive={status.get('sensitive')}\n          visible={showMedia}\n          onToggleVisibility={onToggleMediaVisibility}\n          matchedFilters={status.get('matched_media_filters')}\n        />\n      );\n    }\n  } else if (status.get('card') && !status.get('quote')) {\n    media = (\n      <Card\n        sensitive={status.get('sensitive')}\n        onOpenMedia={onOpenMedia}\n        card={status.get('card')}\n      />\n    );\n  }\n\n  if (status.get('application')) {\n    applicationLink = (\n      <>\n        ·\n        <a\n          className='detailed-status__application'\n          href={status.getIn(['application', 'website'])}\n          target='_blank'\n          rel='noopener noreferrer'\n        >\n          {status.getIn(['application', 'name'])}\n        </a>\n      </>\n    );\n  }\n\n  const visibilityLink = (\n    <>\n      ·<VisibilityIcon visibility={status.get('visibility')} />\n    </>\n  );\n\n  if (['private', 'direct'].includes(status.get('visibility') as string)) {\n    reblogLink = '';\n  } else {\n    reblogLink = (\n      <Link\n        to={`/@${status.getIn(['account', 'acct'])}/${status.get('id')}/reblogs`}\n        className='detailed-status__link'\n      >\n        <span className='detailed-status__reblogs'>\n          <AnimatedNumber value={status.get('reblogs_count')} />\n        </span>\n        <FormattedMessage\n          id='status.reblogs'\n          defaultMessage='{count, plural, one {boost} other {boosts}}'\n          values={{ count: status.get('reblogs_count') }}\n        />\n      </Link>\n    );\n  }\n\n  const favouriteLink = (\n    <Link\n      to={`/@${status.getIn(['account', 'acct'])}/${status.get('id')}/favourites`}\n      className='detailed-status__link'\n    >\n      <span className='detailed-status__favorites'>\n        <AnimatedNumber value={status.get('favourites_count')} />\n      </span>\n      <FormattedMessage\n        id='status.favourites'\n        defaultMessage='{count, plural, one {favorite} other {favorites}}'\n        values={{ count: status.get('favourites_count') }}\n      />\n    </Link>\n  );\n\n  const { statusContentProps, hashtagBar } = getHashtagBarForStatus(\n    status as StatusLike,\n  );\n\n  const matchedFilters = status.get('matched_filters');\n\n  const expanded =\n    (!matchedFilters || showDespiteFilter) &&\n    (!status.get('hidden') || status.get('spoiler_text').length === 0);\n\n  return (\n    <div style={outerStyle}>\n      <div\n        ref={handleRef}\n        className={classNames('detailed-status', {\n          'status--has-quote': !!status.get('quote'),\n        })}\n      >\n        {status.get('visibility') === 'direct' && (\n          <div className='status__prepend'>\n            <div className='status__prepend-icon-wrapper'>\n              <Icon\n                id='at'\n                icon={AlternateEmailIcon}\n                className='status__prepend-icon'\n              />\n            </div>\n            <FormattedMessage\n              id='status.direct_indicator'\n              defaultMessage='Private mention'\n            />\n          </div>\n        )}\n        <Link\n          to={`/@${status.getIn(['account', 'acct'])}`}\n          data-hover-card-account={status.getIn(['account', 'id'])}\n          className='detailed-status__display-name'\n        >\n          <div className='detailed-status__display-avatar'>\n            <Avatar account={status.get('account')} size={46} />\n          </div>\n\n          {overrideDisplayName ?? (\n            <DisplayName account={status.get('account')} localDomain={domain} />\n          )}\n\n          {withLogo && (\n            <>\n              <div className='spacer' />\n              <IconLogo />\n            </>\n          )}\n        </Link>\n\n        {matchedFilters && (\n          <FilterWarning\n            title={matchedFilters.join(', ')}\n            expanded={showDespiteFilter}\n            onClick={handleFilterToggle}\n          />\n        )}\n\n        {status.get('spoiler_text').length > 0 &&\n          (!matchedFilters || showDespiteFilter) && (\n            <ContentWarning\n              text={\n                status.getIn(['translation', 'spoilerHtml']) ||\n                status.get('spoilerHtml')\n              }\n              expanded={expanded}\n              onClick={handleExpandedToggle}\n            />\n          )}\n\n        {expanded && (\n          <>\n            <StatusContent\n              status={status}\n              onTranslate={handleTranslate}\n              {...(statusContentProps as any)}\n            />\n\n            {media}\n            {hashtagBar}\n\n            {status.get('quote') && (\n              <QuotedStatus quote={status.get('quote')} />\n            )}\n          </>\n        )}\n\n        <div className='detailed-status__meta'>\n          <div className='detailed-status__meta__line'>\n            <a\n              className='detailed-status__datetime'\n              href={`/@${status.getIn(['account', 'acct'])}/${status.get('id')}`}\n              target='_blank'\n              rel='noopener noreferrer'\n            >\n              <FormattedDateWrapper\n                value={new Date(status.get('created_at') as string)}\n                year='numeric'\n                month='short'\n                day='2-digit'\n                hour='2-digit'\n                minute='2-digit'\n              />\n            </a>\n\n            {visibilityLink}\n            {applicationLink}\n          </div>\n\n          {status.get('edited_at') && (\n            <div className='detailed-status__meta__line'>\n              <EditedTimestamp\n                statusId={status.get('id')}\n                timestamp={status.get('edited_at')}\n              />\n            </div>\n          )}\n\n          <div className='detailed-status__meta__line'>\n            {reblogLink}\n            {reblogLink && <>·</>}\n            {favouriteLink}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n"],"names":["EditedTimestamp","statusId","timestamp","dispatch","useAppDispatch","items","useAppSelector","state","history","getIn","toArray","loading","handleOpen","useCallback","fetchHistory","handleItemClick","_item","index","openModal","modalType","modalProps","renderHeader","FormattedMessage","count","length","renderItem","item","onClick","onKeyUp","formattedDate","RelativeTimestamp","get","formattedName","jsx","InlineAccount","label","name","date","Dropdown","FormattedDateWrapper","DetailedStatus","status","onOpenMedia","onOpenVideo","onTranslate","measureHeight","onHeightChange","domain","showMedia","withLogo","overrideDisplayName","pictureInPicture","onToggleMediaVisibility","onToggleHidden","properStatus","height","setHeight","useState","showDespiteFilter","setShowDespiteFilter","nodeRef","useRef","handleOpenVideo","options","lang","handleFilterToggle","handleExpandedToggle","_measureHeight","heightJustChanged","current","scheduleIdleTask","Math","ceil","scrollHeight","handleRef","c","handleTranslate","media","applicationLink","reblogLink","attachmentAspectRatio","size","outerStyle","boxSizing","language","PictureInPicturePlaceholder","includes","MediaGallery","attachment","description","Audio","Video","Card","jsxs","Fragment","visibilityLink","VisibilityIcon","Link","AnimatedNumber","favouriteLink","statusContentProps","hashtagBar","getHashtagBarForStatus","matchedFilters","expanded","classNames","Icon","AlternateEmailIcon","Avatar","DisplayName","IconLogo","FilterWarning","join","ContentWarning","StatusContent","QuotedStatus","Date"],"mappings":"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"}