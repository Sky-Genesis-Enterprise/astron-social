import{j as e}from"./client-wT6vtYO_.js";import{r as a,u as Z,d as q}from"./index-BdTwX--g.js";import{c as f}from"./index-DizoKcfL.js";import{H as O}from"./Helmet-ZVWnGmbg.js";import{T as W}from"./index-Dk6IJ02w.js";import{S as w}from"./edit-Cyfwv5F_.js";import{S as Y}from"./person-DcoiY4fW.js";import{a as z,dM as G,u as J,dN as K,I as k}from"./useSelectableClick-DeaJbL2_.js";import{c as Q}from"./onboarding-w4rAx4s2.js";import{B as V}from"./index-BZWHsOPk.js";import{C as X}from"./column-B4vwzadM.js";import{C as $}from"./column_header-FN7GyEAs.js";import{L as ee}from"./loading_indicator-7xMB1U6D.js";import{e as H}from"./initial_state-BP3UcUr4.js";import{d as ae}from"./short_number-WomMu2iV.js";import{M as o}from"./message-UFwkQlnu.js";import"./api-B2m7efUy.js";import"./index-lj9VQs0f.js";import"./ready-DpOgoWSg.js";import"./index-CAH5FfLP.js";import"./load_locale-tOpKhmcM.js";import"./scroll-BygYx8ga.js";import"./add-D8GR9P00.js";import"./chevron_left-CnYIoVsW.js";import"./close-BsPe8EbX.js";import"./numbers-CGZQWBYL.js";const L=l=>a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:24,viewBox:"0 -960 960 960",width:24,...l},a.createElement("path",{d:"M480-480ZM200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h320v80H200v560h560v-320h80v320q0 33-23.5 56.5T760-120H200Zm40-160h480L570-480 450-320l-90-120-120 160Zm440-320v-80h-80v-80h80v-80h80v80h80v80h-80v80h-80Z"})),m=q({title:{id:"onboarding.profile.title",defaultMessage:"Profile setup"},uploadHeader:{id:"onboarding.profile.upload_header",defaultMessage:"Upload profile header"},uploadAvatar:{id:"onboarding.profile.upload_avatar",defaultMessage:"Upload profile picture"}}),R=l=>l.endsWith("missing.png")?null:l,ke=({multiColumn:l})=>{const s=z(t=>H?t.accounts.get(H):void 0),[u,j]=a.useState((s==null?void 0:s.display_name)??""),[v,b]=a.useState(s?G(s.note)??"":""),[r,_]=a.useState(),[d,M]=a.useState(),[p,N]=a.useState((s==null?void 0:s.discoverable)??!0),[y,C]=a.useState(!1),[i,A]=a.useState(),D=a.createRef(),E=a.createRef(),x=J(),c=Z(),S=ae(),T=a.useCallback(t=>{j(t.target.value)},[j]),I=a.useCallback(t=>{b(t.target.value)},[b]),P=a.useCallback(t=>{N(t.target.checked)},[N]),U=a.useCallback(t=>{var n;_((n=t.target.files)==null?void 0:n[0])},[_]),F=a.useCallback(t=>{var n;M((n=t.target.files)==null?void 0:n[0])},[M]),h=a.useMemo(()=>r?URL.createObjectURL(r):R((s==null?void 0:s.avatar)??"missing.png"),[r,s]),g=a.useMemo(()=>d?URL.createObjectURL(d):R((s==null?void 0:s.header)??"missing.png"),[d,s]),B=a.useCallback(()=>{C(!0),x(K({displayName:u,note:v,avatar:r,header:d,discoverable:p,indexable:p})).then(()=>(S.push("/start/follows"),x(Q()),"")).catch(t=>{if(t.response){const{details:n}=t.response.data;A(n)}C(!1)})},[x,u,v,r,d,p,S]);return e.jsxs(X,{bindToDocument:!l,label:c.formatMessage(m.title),children:[e.jsx($,{title:c.formatMessage(m.title),icon:"person",iconComponent:Y,multiColumn:l}),e.jsxs("div",{className:"scrollable scrollable--flex",children:[e.jsxs("div",{className:"simple_form app-form",children:[e.jsxs("div",{className:"onboarding__profile",children:[e.jsxs("label",{className:f("app-form__header-input",{selected:!!g,invalid:!!(i!=null&&i.header)}),title:c.formatMessage(m.uploadHeader),children:[e.jsx("input",{type:"file",hidden:!0,ref:E,accept:"image/*",onChange:F}),g&&e.jsx("img",{src:g,alt:""}),e.jsx(k,{id:"",icon:g?w:L})]}),e.jsxs("label",{className:f("app-form__avatar-input",{selected:!!h,invalid:!!(i!=null&&i.avatar)}),title:c.formatMessage(m.uploadAvatar),children:[e.jsx("input",{type:"file",hidden:!0,ref:D,accept:"image/*",onChange:U}),h&&e.jsx("img",{src:h,alt:""}),e.jsx(k,{id:"",icon:h?w:L})]})]}),e.jsx("div",{className:"fields-group",children:e.jsxs("div",{className:f("input with_block_label",{field_with_errors:!!(i!=null&&i.display_name)}),children:[e.jsx("label",{htmlFor:"display_name",children:e.jsx(o,{id:"onboarding.profile.display_name",defaultMessage:"Display name"})}),e.jsx("span",{className:"hint",children:e.jsx(o,{id:"onboarding.profile.display_name_hint",defaultMessage:"Your full name or your fun name…"})}),e.jsx("div",{className:"label_input",children:e.jsx("input",{id:"display_name",type:"text",value:u,onChange:T,maxLength:30})})]})}),e.jsx("div",{className:"fields-group",children:e.jsxs("div",{className:f("input with_block_label",{field_with_errors:!!(i!=null&&i.note)}),children:[e.jsx("label",{htmlFor:"note",children:e.jsx(o,{id:"onboarding.profile.note",defaultMessage:"Bio"})}),e.jsx("span",{className:"hint",children:e.jsx(o,{id:"onboarding.profile.note_hint",defaultMessage:"You can @mention other people or #hashtags…"})}),e.jsx("div",{className:"label_input",children:e.jsx("textarea",{id:"note",value:v,onChange:I,maxLength:500})})]})}),e.jsxs("label",{className:"app-form__toggle",children:[e.jsxs("div",{className:"app-form__toggle__label",children:[e.jsx("strong",{children:e.jsx(o,{id:"onboarding.profile.discoverable",defaultMessage:"Make my profile discoverable"})})," ",e.jsx("span",{className:"recommended",children:e.jsx(o,{id:"recommended",defaultMessage:"Recommended"})}),e.jsx("span",{className:"hint",children:e.jsx(o,{id:"onboarding.profile.discoverable_hint",defaultMessage:"When you opt in to discoverability on Mastodon, your posts may appear in search results and trending, and your profile may be suggested to people with similar interests to you."})})]}),e.jsx("div",{className:"app-form__toggle__toggle",children:e.jsx("div",{children:e.jsx(W,{checked:p,onChange:P})})})]})]}),e.jsx("div",{className:"spacer"}),e.jsx("div",{className:"column-footer",children:e.jsx(V,{block:!0,onClick:B,disabled:y,children:y?e.jsx(ee,{}):e.jsx(o,{id:"onboarding.profile.save_and_continue",defaultMessage:"Save and continue"})})})]}),e.jsxs(O,{children:[e.jsx("title",{children:c.formatMessage(m.title)}),e.jsx("meta",{name:"robots",content:"noindex"})]})]})};export{ke as Profile,ke as default};
//# sourceMappingURL=profile-gfKtu6Mr.js.map
