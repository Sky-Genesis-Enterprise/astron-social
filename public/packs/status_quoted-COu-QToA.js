import{j as s}from"./client-wT6vtYO_.js";import{r as m,i as E}from"./index-BdTwX--g.js";import{c as b}from"./index-DizoKcfL.js";import{L as y}from"./short_number-WomMu2iV.js";import{j as P,o as d,b_ as k,b$ as h,a3 as A,c0 as w,c1 as D,bJ as N,bK as R,c2 as Q,bH as H,c3 as F,c4 as L,c5 as O,c6 as B,c7 as Z,ag as U,ac as z,c8 as $,c9 as G,ca as V,cb as K,a$ as W,b0 as J,af as X,a as g,u as Y,a2 as ee,I as p,aQ as te}from"./useSelectableClick-DeaJbL2_.js";import{u as oe,i as ne}from"./domain_blocks-CYnp0hav.js";import{i as se}from"./reports-DBOcsYZF.js";import{S as ae}from"./status-CiF0hsk4.js";import{I as re}from"./initial_state-BP3UcUr4.js";import{m as S,a as ie}from"./index-OwtqmxAM.js";import{M as c}from"./message-UFwkQlnu.js";const le=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:24,viewBox:"0 -960 960 960",width:24,...t},m.createElement("path",{d:"M280-280h280v-80H280v80Zm0-160h400v-80H280v80Zm0-160h400v-80H280v80Zm-80 480q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0-560v560-560Z"})),ue=()=>{const t=S(),r=ie();return(o,n)=>({status:t(o,n),nextInReplyToId:n.nextId?o.getIn(["statuses",n.nextId,"in_reply_to_id"]):null,pictureInPicture:r(o,n)})},de=(t,{contextType:r})=>({onReply(e){t((o,n)=>{n().getIn(["compose","text"]).trim().length!==0?t(d({modalType:"CONFIRM_REPLY",modalProps:{status:e}})):t(X(e))})},onReblog(e,o){t(J(e.get("id"),o.shiftKey))},onFavourite(e){t(W(e.get("id")))},onBookmark(e){e.get("bookmarked")?t(V(e)):t(K(e))},onPin(e){e.get("pinned")?t($(e)):t(G(e))},onEmbed(e){t(d({modalType:"EMBED",modalProps:{id:e.get("id")}}))},onDelete(e,o=!1){t(re?d({modalType:"CONFIRM_DELETE_STATUS",modalProps:{statusId:e.get("id"),withRedraft:o}}):z(e.get("id"),o))},onEdit(e){t((o,n)=>{n().getIn(["compose","text"]).trim().length!==0?t(d({modalType:"CONFIRM_EDIT_STATUS",modalProps:{statusId:e.get("id")}})):t(U(e.get("id")))})},onTranslate(e){e.get("translation")?t(B(e.get("id"),e.get("poll"))):t(Z(e.get("id")))},onDirect(e){t(O(e))},onMention(e){t(L(e))},onOpenMedia(e,o,n,a){t(d({modalType:"MEDIA",modalProps:{statusId:e,media:o,index:n,lang:a}}))},onOpenVideo(e,o,n,a){t(d({modalType:"VIDEO",modalProps:{statusId:e,media:o,lang:n,options:a}}))},onBlock(e){const o=e.get("account");t(F(o))},onUnblock(e){t(H(e.get("id")))},onReport(e){t(se(e.get("account"),e))},onAddFilter(e){t(Q(e,{contextType:r}))},onMute(e){t(R(e))},onUnmute(e){t(N(e.get("id")))},onMuteConversation(e){e.get("muted")?t(w(e.get("id"))):t(D(e.get("id")))},onToggleHidden(e){t(A(e.get("id")))},onToggleCollapsed(e,o){t(h(e.get("id"),o))},onBlockDomain(e){t(ne(e))},onUnblockDomain(e){t(oe(e))},deployPictureInPicture(e,o,n){t(k({statusId:e.get("id"),accountId:e.getIn(["account","id"]),playerType:o,props:n}))},onInteractionModal(e,o){t(d({modalType:"INTERACTION",modalProps:{type:e,accountId:o.getIn(["account","id"]),url:o.get("uri")}}))}}),_=E(P(ue,de)(ae)),ce=t=>m.createElement("svg",{width:24,height:20,viewBox:"0 0 24 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M23.933 2.82414C22.324 4.07931 21.0726 5.3569 20.1788 6.6569C19.3296 7.91207 18.905 9.1 18.905 10.2207C19.0838 10.131 19.3073 10.0862 19.5754 10.0862C19.8883 10.0414 20.1564 10.019 20.3799 10.019C21.4078 10.019 22.257 10.4448 22.9274 11.2966C23.6425 12.1034 24 13.1121 24 14.3224C24 15.8017 23.5084 17.0345 22.5251 18.0207C21.5419 19.0069 20.3129 19.5 18.838 19.5C17.2737 19.5 16.0447 18.9397 15.1508 17.819C14.257 16.6535 13.8101 15.1069 13.8101 13.1793C13.8101 10.8931 14.5028 8.62931 15.8883 6.38793C17.2737 4.14655 19.3073 2.01724 21.9888 0L23.933 2.82414ZM10.1229 2.82414C8.51397 4.07931 7.26257 5.3569 6.36872 6.6569C5.51955 7.91207 5.09497 9.1 5.09497 10.2207C5.27374 10.131 5.49721 10.0862 5.76536 10.0862C6.07821 10.0414 6.34637 10.019 6.56983 10.019C7.59777 10.019 8.44693 10.4448 9.11732 11.2966C9.8324 12.1034 10.1899 13.1121 10.1899 14.3224C10.1899 15.8017 9.69832 17.0345 8.71508 18.0207C7.73184 19.0069 6.50279 19.5 5.02793 19.5C3.46369 19.5 2.23464 18.9397 1.34078 17.819C0.446927 16.6535 0 15.1069 0 13.1793C0 10.8931 0.692738 8.62931 2.07821 6.38793C3.46369 4.14655 5.49721 2.01724 8.17877 0L10.1229 2.82414Z",fill:"currentColor"})),T=1,I=({isError:t,children:r})=>s.jsxs("div",{className:b("status__quote",{"status__quote--error":t}),children:[s.jsx(p,{id:"quote",icon:ce,className:"status__quote-icon"}),r]}),me=({status:t})=>{const r=t.get("account"),e=g(u=>r?u.accounts.get(r):void 0),o=e==null?void 0:e.display_name_html;if(!o)return null;const n=s.jsx("span",{dangerouslySetInnerHTML:{__html:o}}),a=`/@${e.get("acct")}/${t.get("id")}`;return s.jsxs(y,{to:a,className:"status__quote-author-button",children:[s.jsx(c,{id:"status.quote_post_author",defaultMessage:"Post by {name}",values:{name:n}}),s.jsx(p,{id:"chevron_right",icon:te}),s.jsx(p,{id:"article",icon:le})]})},v=({quote:t,contextType:r,nestingLevel:e=1,variant:o="full"})=>{const n=Y(),a=t.get("quoted_status"),u=t.get("state"),i=g(f=>a?f.statuses.get(a):void 0);m.useEffect(()=>{!i&&a&&n(ee(a))},[i,a,n]);const x=m.useMemo(()=>S(),[]),M=g(f=>x(f,{id:a,contextType:r})),j=i&&M===null;let l=null;if(j?l=s.jsx(c,{id:"status.quote_error.filtered",defaultMessage:"Hidden due to one of your filters"}):u==="deleted"?l=s.jsx(c,{id:"status.quote_error.removed",defaultMessage:"This post was removed by its author."}):u==="unauthorized"?l=s.jsx(c,{id:"status.quote_error.unauthorized",defaultMessage:"This post cannot be displayed as you are not authorized to view it."}):u==="pending"?l=s.jsx(c,{id:"status.quote_error.pending_approval",defaultMessage:"This post is pending approval from the original author."}):u==="rejected"||u==="revoked"?l=s.jsx(c,{id:"status.quote_error.rejected",defaultMessage:"This post cannot be displayed as the original author does not allow it to be quoted."}):(!i||!a)&&(l=s.jsx(c,{id:"status.quote_error.not_found",defaultMessage:"This post cannot be displayed."})),l)return s.jsx(I,{isError:!0,children:l});if(o==="link"&&i)return s.jsx(me,{status:i});const C=i==null?void 0:i.get("quote"),q=C&&e<=T;return s.jsx(I,{children:s.jsx(_,{isQuotedPost:!0,id:a,contextType:r,avatarSize:40,children:q&&s.jsx(v,{quote:C,contextType:r,variant:e===T?"link":"full",nestingLevel:e+1})})})},je=t=>{const r=g(o=>{const n=o.statuses.get(t.id),a=n==null?void 0:n.get("reblog");return a?o.statuses.get(a):n}),e=r==null?void 0:r.get("quote");return e?s.jsx(_,{...t,children:s.jsx(v,{quote:e,contextType:t.contextType})}):s.jsx(_,{...t})};export{v as Q,je as S,_ as a};
//# sourceMappingURL=status_quoted-COu-QToA.js.map
