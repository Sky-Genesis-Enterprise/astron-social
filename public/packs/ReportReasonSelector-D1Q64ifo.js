var u=Object.defineProperty;var x=(l,r,e)=>r in l?u(l,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[r]=e;var i=(l,r,e)=>x(l,typeof r!="symbol"?r+"":r,e);import{j as o}from"./client-wT6vtYO_.js";import{i as _,r as g,d as v}from"./index-BdTwX--g.js";import{c as h}from"./index-DizoKcfL.js";import{a as m}from"./api-B2m7efUy.js";import"./index-lj9VQs0f.js";import"./initial_state-BP3UcUr4.js";import"./ready-DpOgoWSg.js";const c=v({legal:{id:"report.categories.legal",defaultMessage:"Legal"},other:{id:"report.categories.other",defaultMessage:"Other"},spam:{id:"report.categories.spam",defaultMessage:"Spam"},violation:{id:"report.categories.violation",defaultMessage:"Content violates one or more server rules"}});class p extends g.PureComponent{constructor(){super(...arguments);i(this,"handleClick",()=>{const{id:e,disabled:t,onSelect:s}=this.props;t||s(e)})}render(){const{id:e,text:t,disabled:s,selected:a,children:n}=this.props;return o.jsxs("div",{tabIndex:0,role:"button",className:h("report-reason-selector__category",{selected:a,disabled:s}),onClick:this.handleClick,children:[a&&o.jsx("input",{type:"hidden",name:"report[category]",value:e}),o.jsxs("div",{className:"report-reason-selector__category__label",children:[o.jsx("span",{className:h("poll__input",{active:a,disabled:s})}),t]}),a&&n&&o.jsx("div",{className:"report-reason-selector__category__rules",children:n})]})}}class f extends g.PureComponent{constructor(){super(...arguments);i(this,"handleClick",()=>{const{id:e,disabled:t,onToggle:s}=this.props;t||s(e)})}render(){const{id:e,text:t,disabled:s,selected:a}=this.props;return o.jsxs("div",{tabIndex:0,role:"button",className:h("report-reason-selector__rule",{selected:a,disabled:s}),onClick:this.handleClick,children:[o.jsx("span",{className:h("poll__input",{checkbox:!0,active:a,disabled:s})}),a&&o.jsx("input",{type:"hidden",name:"report[rule_ids][]",value:e}),t]})}}class j extends g.PureComponent{constructor(){super(...arguments);i(this,"state",{category:this.props.category,rule_ids:this.props.rule_ids||[],rules:[]});i(this,"_save",()=>{const{id:e,disabled:t}=this.props,{category:s,rule_ids:a}=this.state;t||m(!1).put(`/api/v1/admin/reports/${e}`,{category:s,rule_ids:s==="violation"?a:[]}).catch(n=>{console.error(n)})});i(this,"handleSelect",e=>{this.setState({category:e},()=>this._save())});i(this,"handleToggle",e=>{const{rule_ids:t}=this.state;t.includes(e)?this.setState({rule_ids:t.filter(s=>s!==e)},()=>this._save()):this.setState({rule_ids:[...t,e]},()=>this._save())})}componentDidMount(){m(!1).get("/api/v2/instance").then(e=>{this.setState({rules:e.data.rules})}).catch(e=>{console.error(e)})}render(){const{disabled:e,intl:t}=this.props,{rules:s,category:a,rule_ids:n}=this.state;return o.jsxs("div",{className:"report-reason-selector",children:[o.jsx(p,{id:"other",text:t.formatMessage(c.other),selected:a==="other",onSelect:this.handleSelect,disabled:e}),o.jsx(p,{id:"legal",text:t.formatMessage(c.legal),selected:a==="legal",onSelect:this.handleSelect,disabled:e}),o.jsx(p,{id:"spam",text:t.formatMessage(c.spam),selected:a==="spam",onSelect:this.handleSelect,disabled:e}),o.jsx(p,{id:"violation",text:t.formatMessage(c.violation),selected:a==="violation",onSelect:this.handleSelect,disabled:e||s.length===0,children:s.map(d=>o.jsx(f,{id:d.id,text:d.text,selected:n.includes(d.id),onToggle:this.handleToggle,disabled:e},d.id))})]})}}const T=_(j);export{T as default};
//# sourceMappingURL=ReportReasonSelector-D1Q64ifo.js.map
