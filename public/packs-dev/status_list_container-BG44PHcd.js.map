{"version":3,"file":"status_list_container-BG44PHcd.js","sources":["../../app/javascript/mastodon/features/ui/containers/status_list_container.js"],"sourcesContent":["import { createSelector } from '@reduxjs/toolkit';\nimport { Map as ImmutableMap, List as ImmutableList } from 'immutable';\nimport { connect } from 'react-redux';\n\nimport { debounce } from 'lodash';\n\nimport { scrollTopTimeline, loadPending } from '../../../actions/timelines';\nimport StatusList from '../../../components/status_list';\nimport { me } from '../../../initial_state';\n\nconst makeGetStatusIds = (pending = false) => createSelector([\n  (state, { type }) => state.getIn(['settings', type], ImmutableMap()),\n  (state, { type }) => state.getIn(['timelines', type, pending ? 'pendingItems' : 'items'], ImmutableList()),\n  (state)           => state.get('statuses'),\n], (columnSettings, statusIds, statuses) => {\n  return statusIds.filter(id => {\n    if (id === null || id === 'inline-follow-suggestions') return true;\n\n    const statusForId = statuses.get(id);\n\n    if (statusForId.get('account') === me) return true;\n\n    if (columnSettings.getIn(['shows', 'reblog']) === false && statusForId.get('reblog') !== null) {\n      return false;\n    }\n\n    if (columnSettings.getIn(['shows', 'reply']) === false && statusForId.get('in_reply_to_id') !== null && statusForId.get('in_reply_to_account_id') !== me) {\n      return false;\n    }\n\n    if (columnSettings.getIn(['shows', 'quote']) === false && statusForId.get('quote') !== null) {\n      return false;\n    }\n\n    return true;\n  });\n});\n\nconst makeMapStateToProps = () => {\n  const getStatusIds = makeGetStatusIds();\n  const getPendingStatusIds = makeGetStatusIds(true);\n\n  const mapStateToProps = (state, { timelineId }) => ({\n    statusIds: getStatusIds(state, { type: timelineId }),\n    lastId:    state.getIn(['timelines', timelineId, 'items'])?.last(),\n    isLoading: state.getIn(['timelines', timelineId, 'isLoading'], true),\n    isPartial: state.getIn(['timelines', timelineId, 'isPartial'], false),\n    hasMore:   state.getIn(['timelines', timelineId, 'hasMore']),\n    numPending: getPendingStatusIds(state, { type: timelineId }).size,\n  });\n\n  return mapStateToProps;\n};\n\nconst mapDispatchToProps = (dispatch, { timelineId }) => ({\n\n  onScrollToTop: debounce(() => {\n    dispatch(scrollTopTimeline(timelineId, true));\n  }, 100),\n\n  onScroll: debounce(() => {\n    dispatch(scrollTopTimeline(timelineId, false));\n  }, 100),\n\n  onLoadPending: () => dispatch(loadPending(timelineId)),\n\n});\n\nexport default connect(makeMapStateToProps, mapDispatchToProps)(StatusList);\n"],"names":["makeGetStatusIds","pending","createSelector","state","type","getIn","ImmutableMap","ImmutableList","get","columnSettings","statusIds","statuses","filter","id","statusForId","me","makeMapStateToProps","getStatusIds","getPendingStatusIds","mapStateToProps","timelineId","lastId","last","isLoading","isPartial","hasMore","numPending","size","mapDispatchToProps","dispatch","onScrollToTop","debounce","scrollTopTimeline","onScroll","onLoadPending","loadPending","StatusListContainer","connect","StatusList"],"mappings":"6LAUA,MAAMA,EAAmBA,CAACC,EAAU,KAAUC,EAAe,CAC3D,CAACC,EAAO,CAAEC,KAAAA,CAAK,IAAMD,EAAME,MAAM,CAAC,WAAYD,CAAI,EAAGE,EAAY,CAAE,EACnE,CAACH,EAAO,CAAEC,KAAAA,CAAK,IAAMD,EAAME,MAAM,CAAC,YAAaD,EAAMH,EAAU,eAAiB,OAAO,EAAGM,EAAa,CAAE,EACxGJ,GAAoBA,EAAMK,IAAI,UAAU,CAAC,EACzC,CAACC,EAAgBC,EAAWC,IACtBD,EAAUE,OAAOC,GAAM,CAC5B,GAAIA,IAAO,MAAQA,IAAO,4BAA6B,MAAO,GAE9D,MAAMC,EAAcH,EAASH,IAAIK,CAAE,EAEnC,OAAIC,EAAYN,IAAI,SAAS,IAAMO,EAAW,GAE1CN,EAAAA,EAAeJ,MAAM,CAAC,QAAS,QAAQ,CAAC,IAAM,IAASS,EAAYN,IAAI,QAAQ,IAAM,MAIrFC,EAAeJ,MAAM,CAAC,QAAS,OAAO,CAAC,IAAM,IAASS,EAAYN,IAAI,gBAAgB,IAAM,MAAQM,EAAYN,IAAI,wBAAwB,IAAMO,GAIlJN,EAAeJ,MAAM,CAAC,QAAS,OAAO,CAAC,IAAM,IAASS,EAAYN,IAAI,OAAO,IAAM,KAKzF,CAAC,CACF,EAEKQ,EAAsBA,IAAM,CAChC,MAAMC,EAAejB,EAAgB,EAC/BkB,EAAsBlB,EAAiB,EAAI,EAWjD,MATwBmB,CAAChB,EAAO,CAAEiB,WAAAA,CAAW,IAAC,OAAM,OAClDV,UAAWO,EAAad,EAAO,CAAEC,KAAMgB,CAAW,CAAC,EACnDC,QAAWlB,EAAAA,EAAME,MAAM,CAAC,YAAae,EAAY,OAAO,CAAC,IAA9CjB,YAAAA,EAAiDmB,OAC5DC,UAAWpB,EAAME,MAAM,CAAC,YAAae,EAAY,WAAW,EAAG,EAAI,EACnEI,UAAWrB,EAAME,MAAM,CAAC,YAAae,EAAY,WAAW,EAAG,EAAK,EACpEK,QAAWtB,EAAME,MAAM,CAAC,YAAae,EAAY,SAAS,CAAC,EAC3DM,WAAYR,EAAoBf,EAAO,CAAEC,KAAMgB,CAAW,CAAC,EAAEO,IAC/D,EAGF,EAEMC,EAAqBA,CAACC,EAAU,CAAET,WAAAA,CAAW,KAAO,CAExDU,cAAeC,EAAS,IAAM,CAC5BF,EAASG,EAAkBZ,EAAY,EAAI,CAAC,GAC3C,GAAG,EAENa,SAAUF,EAAS,IAAM,CACvBF,EAASG,EAAkBZ,EAAY,EAAK,CAAC,GAC5C,GAAG,EAENc,cAAeA,IAAML,EAASM,EAAYf,CAAU,CAAC,CAEvD,GAEAgB,EAAeC,EAAQrB,EAAqBY,CAAkB,EAAEU,CAAU"}