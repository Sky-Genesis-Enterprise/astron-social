var G=Object.defineProperty;var Z=(l,d,e)=>d in l?G(l,d,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[d]=e;var a=(l,d,e)=>Z(l,typeof d!="symbol"?d+"":d,e);import{j as n}from"./client-BG6VvM0b.js";import{w as J,P as p}from"./short_number--sxn3OKQ.js";import{r as S,i as O,d as F}from"./index-ykyyQSL-.js";import{c as T}from"./index-guCj-HqV.js";import{H as Y}from"./Helmet-D0DLVOv1.js";import{bS as q,j as $,B as L,b as I,aT as B,v as Q,w as X,aU as ee,aV as te,aW as se,ab as ae,aX as ie,aY as oe,y as ne,aR as le,z as E,aS as re,a2 as R,cJ as de,a$ as ue,o as f,c8 as ce,c9 as me,af as pe,b0 as he,ca as ge,cb as fe,ac as be,ag as ve,c5 as ke,c4 as Me,bK as xe,c0 as Ne,c1 as Ce,d9 as V,da as w,c6 as _e,c7 as ye,c3 as Ie,bJ as je,bH as De,cK as Te,cL as Se,I as Be}from"./useSelectableClick-DBo53LOf.js";import{i as Ee}from"./index.es-D--CQIAj.js";import{S as Re}from"./visibility_off-DWOPSbpr.js";import{L as Ve}from"./loading_indicator-BBuNQ1GS.js";import{T as we}from"./timeline_hint-5iOue1yn.js";import{S as He}from"./scroll_container-BQpJ36fQ.js";import{B as Ue}from"./bundle_column_error-BUenPHpF.js";import{i as Ae,u as Pe}from"./domain_blocks-DiDVA5xw.js";import{i as Oe}from"./reports-BY0N2xif.js";import{C as Fe}from"./column_header-CtuyYpNB.js";import{a as qe,b as $e,d as H,t as Le}from"./status-D92xLx8p.js";import{S as Ke}from"./status_quoted-D9176USW.js";import{e as U,I as We}from"./initial_state-BP3UcUr4.js";import{m as ze,a as Ge}from"./index-Ds3K_5LX.js";import{C as A}from"./column-u9iYs8RL.js";import{b as Ze,S as Je}from"./content_warning-ZcoJE_cd.js";import{P as j,b as D}from"./permissions-Djze7cmB.js";import{D as Ye}from"./detailed_status-CwyM3hb_.js";import{M as P}from"./message-Bb0z64dP.js";import"./numbers-CGZQWBYL.js";import"./api-uqk9CYtW.js";import"./index-lj9VQs0f.js";import"./ready-DpOgoWSg.js";import"./index-DHslUCy5.js";import"./load_locale-C-B7BkCQ.js";import"./react-router-scroll-4.es-6ieDtVAa.js";import"./interopRequireDefault-CdiRfGvq.js";import"./index-JeRepxZU.js";import"./column-CXD4Tnpb.js";import"./scroll-BygYx8ga.js";import"./gif-CQLWVfmH.js";import"./add-ZanakRnh.js";import"./chevron_left-R_fqLHXp.js";import"./close-DPVxbBbs.js";import"./card-v59kuVL6.js";import"./avatar_overlay-XCWEKsBg.js";import"./toString-CBWlLvSL.js";import"./status_content-BS1khha6.js";import"./poll-wjP7LpZg.js";import"./visibility_icon-B5XmIQZP.js";import"./skeleton-_5CK2hDo.js";import"./formatted_date-kPcGS90C.js";import"./inline_account-CGFjWL6Y.js";import"./media_gallery-D8AVjLNK.js";import"./alt_text_badge-C63PD6vv.js";import"./schedule_idle_task-CTsEu-tt.js";const Qe=l=>S.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:24,viewBox:"0 -960 960 960",width:24,...l},S.createElement("path",{d:"M480-320q75 0 127.5-52.5T660-500q0-75-52.5-127.5T480-680q-75 0-127.5 52.5T300-500q0 75 52.5 127.5T480-320Zm0-72q-45 0-76.5-31.5T372-500q0-45 31.5-76.5T480-608q45 0 76.5 31.5T588-500q0 45-31.5 76.5T480-392Zm0 192q-146 0-266-81.5T40-500q54-137 174-218.5T480-800q146 0 266 81.5T920-500q-54 137-174 218.5T480-200Zm0-300Zm0 220q113 0 207.5-59.5T832-500q-50-101-144.5-160.5T480-720q-113 0-207.5 59.5T128-500q50 101 144.5 160.5T480-280Z"})),Xe=q([(l,d)=>d,l=>l.contexts.inReplyTos],(l,d)=>{const e=[];let s=l;for(;s&&!e.includes(s);)e.unshift(s),s=d[s];return e}),et=q([(l,d)=>d,l=>l.contexts.replies,l=>l.statuses],(l,d,e)=>{const s=[],t=[l];for(;t.length>0;){const i=t.pop();if(!i)break;const c=d[i];l!==i&&s.push(i),c&&c.toReversed().forEach(m=>{!t.includes(m)&&!s.includes(m)&&l!==m&&t.push(m)})}let o=s.findIndex(i=>{const c=e.get(i);if(!c)return!1;const m=c.get("in_reply_to_account_id"),g=c.get("account");return m!==g});return o!==-1&&s.forEach((i,c)=>{const m=e.get(i);if(!m)return;const g=m.get("in_reply_to_account_id"),h=m.get("account");c>o&&g===h&&(s.splice(c,1),s.splice(o,0,i),o+=1)}),s}),r=F({delete:{id:"status.delete",defaultMessage:"Delete"},redraft:{id:"status.redraft",defaultMessage:"Delete & re-draft"},edit:{id:"status.edit",defaultMessage:"Edit"},direct:{id:"status.direct",defaultMessage:"Privately mention @{name}"},mention:{id:"status.mention",defaultMessage:"Mention @{name}"},reply:{id:"status.reply",defaultMessage:"Reply"},reblog:{id:"status.reblog",defaultMessage:"Boost"},reblog_private:{id:"status.reblog_private",defaultMessage:"Boost with original visibility"},cancel_reblog_private:{id:"status.cancel_reblog_private",defaultMessage:"Unboost"},cannot_reblog:{id:"status.cannot_reblog",defaultMessage:"This post cannot be boosted"},favourite:{id:"status.favourite",defaultMessage:"Favorite"},removeFavourite:{id:"status.remove_favourite",defaultMessage:"Remove from favorites"},bookmark:{id:"status.bookmark",defaultMessage:"Bookmark"},removeBookmark:{id:"status.remove_bookmark",defaultMessage:"Remove bookmark"},more:{id:"status.more",defaultMessage:"More"},mute:{id:"status.mute",defaultMessage:"Mute @{name}"},muteConversation:{id:"status.mute_conversation",defaultMessage:"Mute conversation"},unmuteConversation:{id:"status.unmute_conversation",defaultMessage:"Unmute conversation"},block:{id:"status.block",defaultMessage:"Block @{name}"},report:{id:"status.report",defaultMessage:"Report @{name}"},share:{id:"status.share",defaultMessage:"Share"},pin:{id:"status.pin",defaultMessage:"Pin on profile"},unpin:{id:"status.unpin",defaultMessage:"Unpin from profile"},embed:{id:"status.embed",defaultMessage:"Get embed code"},admin_account:{id:"status.admin_account",defaultMessage:"Open moderation interface for @{name}"},admin_status:{id:"status.admin_status",defaultMessage:"Open this post in the moderation interface"},admin_domain:{id:"status.admin_domain",defaultMessage:"Open moderation interface for {domain}"},copy:{id:"status.copy",defaultMessage:"Copy link to post"},blockDomain:{id:"account.block_domain",defaultMessage:"Block domain {domain}"},unblockDomain:{id:"account.unblock_domain",defaultMessage:"Unblock domain {domain}"},unmute:{id:"account.unmute",defaultMessage:"Unmute @{name}"},unblock:{id:"account.unblock",defaultMessage:"Unblock @{name}"},openOriginalPage:{id:"account.open_original_page",defaultMessage:"Open original page"}}),tt=(l,{status:d})=>({relationship:l.getIn(["relationships",d.getIn(["account","id"])])});class st extends S.PureComponent{constructor(){super(...arguments);a(this,"handleReplyClick",()=>{this.props.onReply(this.props.status)});a(this,"handleReblogClick",e=>{this.props.onReblog(this.props.status,e)});a(this,"handleFavouriteClick",()=>{this.props.onFavourite(this.props.status)});a(this,"handleBookmarkClick",e=>{this.props.onBookmark(this.props.status,e)});a(this,"handleDeleteClick",()=>{this.props.onDelete(this.props.status)});a(this,"handleRedraftClick",()=>{this.props.onDelete(this.props.status,!0)});a(this,"handleEditClick",()=>{this.props.onEdit(this.props.status)});a(this,"handleDirectClick",()=>{this.props.onDirect(this.props.status.get("account"))});a(this,"handleMentionClick",()=>{this.props.onMention(this.props.status.get("account"))});a(this,"handleMuteClick",()=>{const{status:e,relationship:s,onMute:t,onUnmute:o}=this.props,i=e.get("account");s&&s.get("muting")?o(i):t(i)});a(this,"handleBlockClick",()=>{const{status:e,relationship:s,onBlock:t,onUnblock:o}=this.props,i=e.get("account");s&&s.get("blocking")?o(i):t(e)});a(this,"handleBlockDomain",()=>{const{status:e,onBlockDomain:s}=this.props,t=e.get("account");s(t)});a(this,"handleUnblockDomain",()=>{const{status:e,onUnblockDomain:s}=this.props,t=e.get("account");s(t.get("acct").split("@")[1])});a(this,"handleConversationMuteClick",()=>{this.props.onMuteConversation(this.props.status)});a(this,"handleReport",()=>{this.props.onReport(this.props.status)});a(this,"handlePinClick",()=>{this.props.onPin(this.props.status)});a(this,"handleShare",()=>{navigator.share({url:this.props.status.get("url")})});a(this,"handleEmbed",()=>{this.props.onEmbed(this.props.status)});a(this,"handleCopy",()=>{const e=this.props.status.get("url");navigator.clipboard.writeText(e)})}render(){const{status:e,relationship:s,intl:t}=this.props,{signedIn:o,permissions:i}=this.props.identity,c=["public","unlisted"].includes(e.get("visibility")),m=["public","unlisted","private"].includes(e.get("visibility")),g=e.get("muted"),h=e.get("account"),M=e.getIn(["account","id"])===U,b=e.getIn(["account","username"])!==e.getIn(["account","acct"]);let u=[];if(c&&b&&u.push({text:t.formatMessage(r.openOriginalPage),href:e.get("url")}),u.push({text:t.formatMessage(r.copy),action:this.handleCopy}),c&&"share"in navigator&&u.push({text:t.formatMessage(r.share),action:this.handleShare}),c&&(o||!b)&&u.push({text:t.formatMessage(r.embed),action:this.handleEmbed}),o)if(u.push(null),M)m&&(u.push({text:t.formatMessage(e.get("pinned")?r.unpin:r.pin),action:this.handlePinClick}),u.push(null)),u.push({text:t.formatMessage(g?r.unmuteConversation:r.muteConversation),action:this.handleConversationMuteClick}),u.push(null),u.push({text:t.formatMessage(r.edit),action:this.handleEditClick}),u.push({text:t.formatMessage(r.delete),action:this.handleDeleteClick,dangerous:!0}),u.push({text:t.formatMessage(r.redraft),action:this.handleRedraftClick,dangerous:!0});else{if(u.push({text:t.formatMessage(r.mention,{name:e.getIn(["account","username"])}),action:this.handleMentionClick}),u.push(null),s&&s.get("muting")?u.push({text:t.formatMessage(r.unmute,{name:h.get("username")}),action:this.handleMuteClick}):u.push({text:t.formatMessage(r.mute,{name:h.get("username")}),action:this.handleMuteClick,dangerous:!0}),s&&s.get("blocking")?u.push({text:t.formatMessage(r.unblock,{name:h.get("username")}),action:this.handleBlockClick}):u.push({text:t.formatMessage(r.block,{name:h.get("username")}),action:this.handleBlockClick,dangerous:!0}),u.push({text:t.formatMessage(r.report,{name:e.getIn(["account","username"])}),action:this.handleReport,dangerous:!0}),h.get("acct")!==h.get("username")){const y=h.get("acct").split("@")[1];u.push(null),s&&s.get("domain_blocking")?u.push({text:t.formatMessage(r.unblockDomain,{domain:y}),action:this.handleUnblockDomain}):u.push({text:t.formatMessage(r.blockDomain,{domain:y}),action:this.handleBlockDomain,dangerous:!0})}if(((i&j)===j||b&&(i&D)===D)&&(u.push(null),(i&j)===j&&(u.push({text:t.formatMessage(r.admin_account,{name:e.getIn(["account","username"])}),href:`/admin/accounts/${e.getIn(["account","id"])}`}),u.push({text:t.formatMessage(r.admin_status),href:`/admin/accounts/${e.getIn(["account","id"])}/statuses/${e.get("id")}`})),b&&(i&D)===D)){const y=h.get("acct").split("@")[1];u.push({text:t.formatMessage(r.admin_domain,{domain:y}),href:`/admin/instances/${y}`})}}let v,x;e.get("in_reply_to_id",null)===null?(v="reply",x=B):(v="reply-all",x=ee);const N=e.getIn(["account","id"])===U&&e.get("visibility")==="private";let C,_;e.get("reblogged")?(C=t.formatMessage(r.cancel_reblog_private),_=c?te:se):c?(C=t.formatMessage(r.reblog),_=ae):N?(C=t.formatMessage(r.reblog_private),_=ie):(C=t.formatMessage(r.cannot_reblog),_=oe);const W=t.formatMessage(e.get("bookmarked")?r.removeBookmark:r.bookmark),z=t.formatMessage(e.get("favourited")?r.removeFavourite:r.favourite);return n.jsxDEV("div",{className:"detailed-status__action-bar",children:[n.jsxDEV("div",{className:"detailed-status__button",children:n.jsxDEV(I,{title:t.formatMessage(r.reply),icon:e.get("in_reply_to_account_id")===e.getIn(["account","id"])?"reply":v,iconComponent:e.get("in_reply_to_account_id")===e.getIn(["account","id"])?B:x,onClick:this.handleReplyClick},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/action_bar.jsx",lineNumber:314,columnNumber:50},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/action_bar.jsx",lineNumber:314,columnNumber:9},this),n.jsxDEV("div",{className:"detailed-status__button",children:n.jsxDEV(I,{className:T({reblogPrivate:N}),disabled:!c&&!N,active:e.get("reblogged"),title:C,icon:"retweet",iconComponent:_,onClick:this.handleReblogClick},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/action_bar.jsx",lineNumber:315,columnNumber:50},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/action_bar.jsx",lineNumber:315,columnNumber:9},this),n.jsxDEV("div",{className:"detailed-status__button",children:n.jsxDEV(I,{className:"star-icon",animate:!0,active:e.get("favourited"),title:z,icon:"star",iconComponent:e.get("favourited")?Q:X,onClick:this.handleFavouriteClick},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/action_bar.jsx",lineNumber:316,columnNumber:50},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/action_bar.jsx",lineNumber:316,columnNumber:9},this),n.jsxDEV("div",{className:"detailed-status__button",children:n.jsxDEV(I,{className:"bookmark-icon",disabled:!o,active:e.get("bookmarked"),title:W,icon:"bookmark",iconComponent:e.get("bookmarked")?qe:$e,onClick:this.handleBookmarkClick},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/action_bar.jsx",lineNumber:317,columnNumber:50},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/action_bar.jsx",lineNumber:317,columnNumber:9},this),n.jsxDEV("div",{className:"detailed-status__action-bar-dropdown",children:n.jsxDEV(Ze,{icon:"ellipsis-h",iconComponent:Je,status:e,items:u,direction:"left",title:t.formatMessage(r.more)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/action_bar.jsx",lineNumber:320,columnNumber:11},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/action_bar.jsx",lineNumber:319,columnNumber:9},this)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/action_bar.jsx",lineNumber:313,columnNumber:7},this)}}const at=$(tt)(L(O(st))),k=F({revealAll:{id:"status.show_more_all",defaultMessage:"Show more for all"},hideAll:{id:"status.show_less_all",defaultMessage:"Show less for all"},statusTitleWithAttachments:{id:"status.title.with_attachments",defaultMessage:"{user} posted {attachmentCount, plural, one {an attachment} other {# attachments}}"},detailedStatus:{id:"status.detailed_status",defaultMessage:"Detailed conversation view"}}),it=()=>{const l=ze(),d=Ge();return(s,t)=>{const o=l(s,{id:t.params.statusId,contextType:"detailed"});let i=[],c=[];return o&&(i=Xe(s,o.get("in_reply_to_id")),c=et(s,o.get("id"))),{isLoading:s.getIn(["statuses",t.params.statusId,"isLoading"]),status:o,ancestorsIds:i,descendantsIds:c,askReplyConfirmation:s.getIn(["compose","text"]).trim().length!==0,domain:s.getIn(["meta","domain"]),pictureInPicture:d(s,{id:t.params.statusId})}}},ot=(l,d)=>{const e=Array.from(l);return e.length>d?e.slice(0,d).join("")+"â€¦":l},nt=(l,d)=>{const e=d.getIn(["account","display_name"]),s=d.getIn(["account","username"]),t=e.trim().length===0?s:e,o=d.get("search_index"),i=d.get("media_attachments").size;return o?`${t}: "${ot(o,30)}"`:l.formatMessage(k.statusTitleWithAttachments,{user:t,attachmentCount:i})};class K extends ne{constructor(){super(...arguments);a(this,"state",{fullscreen:!1,showMedia:H(this.props.status),loadedStatusId:void 0});a(this,"handleToggleMediaVisibility",()=>{this.setState({showMedia:!this.state.showMedia})});a(this,"handleFavouriteClick",e=>{const{dispatch:s}=this.props,{signedIn:t}=this.props.identity;s(t?ue(e.get("id")):f({modalType:"INTERACTION",modalProps:{type:"favourite",accountId:e.getIn(["account","id"]),url:e.get("uri")}}))});a(this,"handlePin",e=>{e.get("pinned")?this.props.dispatch(ce(e)):this.props.dispatch(me(e))});a(this,"handleReplyClick",e=>{const{askReplyConfirmation:s,dispatch:t}=this.props,{signedIn:o}=this.props.identity;t(o?s?f({modalType:"CONFIRM_REPLY",modalProps:{status:e}}):pe(e):f({modalType:"INTERACTION",modalProps:{type:"reply",accountId:e.getIn(["account","id"]),url:e.get("uri")}}))});a(this,"handleReblogClick",(e,s)=>{const{dispatch:t}=this.props,{signedIn:o}=this.props.identity;t(o?he(e.get("id"),s&&s.shiftKey):f({modalType:"INTERACTION",modalProps:{type:"reblog",accountId:e.getIn(["account","id"]),url:e.get("uri")}}))});a(this,"handleBookmarkClick",e=>{e.get("bookmarked")?this.props.dispatch(ge(e)):this.props.dispatch(fe(e))});a(this,"handleDeleteClick",(e,s=!1)=>{const{dispatch:t}=this.props;t(We?f({modalType:"CONFIRM_DELETE_STATUS",modalProps:{statusId:e.get("id"),withRedraft:s}}):be(e.get("id"),s))});a(this,"handleEditClick",e=>{const{dispatch:s,askReplyConfirmation:t}=this.props;s(t?f({modalType:"CONFIRM_EDIT_STATUS",modalProps:{statusId:e.get("id")}}):ve(e.get("id")))});a(this,"handleDirectClick",e=>{this.props.dispatch(ke(e))});a(this,"handleMentionClick",e=>{this.props.dispatch(Me(e))});a(this,"handleOpenMedia",(e,s,t)=>{this.props.dispatch(f({modalType:"MEDIA",modalProps:{statusId:this.props.status.get("id"),media:e,index:s,lang:t}}))});a(this,"handleOpenVideo",(e,s,t)=>{this.props.dispatch(f({modalType:"VIDEO",modalProps:{statusId:this.props.status.get("id"),media:e,lang:s,options:t}}))});a(this,"handleHotkeyOpenMedia",e=>{const{status:s}=this.props;e.preventDefault(),s.get("media_attachments").size>0&&(s.getIn(["media_attachments",0,"type"])==="video"?this.handleOpenVideo(s.getIn(["media_attachments",0]),{startTime:0}):this.handleOpenMedia(s.get("media_attachments"),0))});a(this,"handleMuteClick",e=>{this.props.dispatch(xe(e))});a(this,"handleConversationMuteClick",e=>{e.get("muted")?this.props.dispatch(Ne(e.get("id"))):this.props.dispatch(Ce(e.get("id")))});a(this,"handleToggleHidden",e=>{e.get("hidden")?this.props.dispatch(V(e.get("id"))):this.props.dispatch(w(e.get("id")))});a(this,"handleToggleAll",()=>{const{status:e,ancestorsIds:s,descendantsIds:t}=this.props,o=[e.get("id")].concat(s,t);e.get("hidden")?this.props.dispatch(V(o)):this.props.dispatch(w(o))});a(this,"handleTranslate",e=>{const{dispatch:s}=this.props;e.get("translation")?s(_e(e.get("id"),e.get("poll"))):s(ye(e.get("id")))});a(this,"handleBlockClick",e=>{const{dispatch:s}=this.props,t=e.get("account");s(Ie(t))});a(this,"handleReport",e=>{this.props.dispatch(Oe(e.get("account"),e))});a(this,"handleEmbed",e=>{this.props.dispatch(f({modalType:"EMBED",modalProps:{id:e.get("id")}}))});a(this,"handleUnmuteClick",e=>{this.props.dispatch(je(e.get("id")))});a(this,"handleUnblockClick",e=>{this.props.dispatch(De(e.get("id")))});a(this,"handleBlockDomainClick",e=>{this.props.dispatch(Ae(e))});a(this,"handleUnblockDomainClick",e=>{this.props.dispatch(Pe(e))});a(this,"handleHotkeyMoveUp",()=>{this.handleMoveUp(this.props.status.get("id"))});a(this,"handleHotkeyMoveDown",()=>{this.handleMoveDown(this.props.status.get("id"))});a(this,"handleHotkeyReply",e=>{e.preventDefault(),this.handleReplyClick(this.props.status)});a(this,"handleHotkeyFavourite",()=>{this.handleFavouriteClick(this.props.status)});a(this,"handleHotkeyBoost",()=>{this.handleReblogClick(this.props.status)});a(this,"handleHotkeyMention",e=>{e.preventDefault(),this.handleMentionClick(this.props.status.get("account"))});a(this,"handleHotkeyOpenProfile",()=>{this.props.history.push(`/@${this.props.status.getIn(["account","acct"])}`)});a(this,"handleHotkeyToggleHidden",()=>{this.handleToggleHidden(this.props.status)});a(this,"handleHotkeyToggleSensitive",()=>{this.handleToggleMediaVisibility()});a(this,"handleHotkeyTranslate",()=>{this.handleTranslate(this.props.status)});a(this,"handleMoveUp",e=>{const{status:s,ancestorsIds:t,descendantsIds:o}=this.props;if(e===s.get("id"))this._selectChild(t.length-1,!0);else{let i=t.indexOf(e);i===-1?(i=o.indexOf(e),this._selectChild(t.length+i,!0)):this._selectChild(i-1,!0)}});a(this,"handleMoveDown",e=>{const{status:s,ancestorsIds:t,descendantsIds:o}=this.props;if(e===s.get("id"))this._selectChild(t.length+1,!1);else{let i=t.indexOf(e);i===-1?(i=o.indexOf(e),this._selectChild(t.length+i+2,!1)):this._selectChild(i+1,!1)}});a(this,"setContainerRef",e=>{this.node=e});a(this,"setStatusRef",e=>{this.statusNode=e});a(this,"onFullScreenChange",()=>{this.setState({fullscreen:Se()})});a(this,"shouldUpdateScroll",(e,{location:s})=>{var t,o,i;return((t=s.state)==null?void 0:t.mastodonModalKey)!==((i=(o=e==null?void 0:e.location)==null?void 0:o.state)==null?void 0:i.mastodonModalKey)?!1:this.statusNode?[0,this.statusNode.offsetTop]:!1})}UNSAFE_componentWillMount(){this.props.dispatch(R(this.props.params.statusId))}componentDidMount(){de(this.onFullScreenChange),this._scrollStatusIntoView()}UNSAFE_componentWillReceiveProps(e){e.params.statusId!==this.props.params.statusId&&e.params.statusId&&this.props.dispatch(R(e.params.statusId)),e.status&&e.status.get("id")!==this.state.loadedStatusId&&this.setState({showMedia:H(e.status),loadedStatusId:e.status.get("id")})}_selectChild(e,s){const t=this.node,o=t.querySelectorAll(".focusable")[e];o&&(s&&t.scrollTop>o.offsetTop?o.scrollIntoView(!0):!s&&t.scrollTop+t.clientHeight<o.offsetTop+o.offsetHeight&&o.scrollIntoView(!1),o.focus())}renderChildren(e,s){const{params:{statusId:t}}=this.props;return e.map((o,i)=>n.jsxDEV(Ke,{id:o,onMoveUp:this.handleMoveUp,onMoveDown:this.handleMoveDown,contextType:"thread",previousId:i>0?e[i-1]:void 0,nextId:e[i+1]||s&&t,rootId:t},o,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:478,columnNumber:5},this))}_scrollStatusIntoView(){const{status:e,multiColumn:s}=this.props;e&&requestIdleCallback(()=>{var t,o,i;if((t=this.statusNode)==null||t.scrollIntoView(!0),!s){const c=(i=(o=document.querySelector(".column-header__wrapper"))==null?void 0:o.getBoundingClientRect())==null?void 0:i.bottom;c&&(document.scrollingElement||document.body).scrollBy(0,-c)}})}componentDidUpdate(e){var o;const{status:s,ancestorsIds:t}=this.props;s&&(t.length>e.ancestorsIds.length||((o=e.status)==null?void 0:o.get("id"))!==s.get("id"))&&this._scrollStatusIntoView()}componentWillUnmount(){Te(this.onFullScreenChange)}render(){let e,s,t;const{isLoading:o,status:i,ancestorsIds:c,descendantsIds:m,intl:g,domain:h,multiColumn:M,pictureInPicture:b}=this.props,{fullscreen:u}=this.state;if(o)return n.jsxDEV(A,{children:n.jsxDEV(Ve,{},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:558,columnNumber:11},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:557,columnNumber:9},this);if(i===null)return n.jsxDEV(Ue,{multiColumn:M,errorType:"routing"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:565,columnNumber:9},this);c&&c.length>0&&(e=n.jsxDEV(n.Fragment,{children:this.renderChildren(c,!0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:570,columnNumber:19},this)),m&&m.length>0&&(s=n.jsxDEV(n.Fragment,{children:this.renderChildren(m)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:574,columnNumber:21},this));const v=i.getIn(["account","acct"],"").indexOf("@")===-1,x=!i.getIn(["account","noindex"]);v||(t=n.jsxDEV(we,{className:T(!!s&&"timeline-hint--with-descendants"),url:i.get("url"),message:n.jsxDEV(P,{id:"hints.threads.replies_may_be_missing",defaultMessage:"Replies from other servers may be missing."},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:585,columnNumber:18},this),label:n.jsxDEV(P,{id:"hints.threads.see_more",defaultMessage:"See more replies on {domain}",values:{domain:n.jsxDEV("strong",{children:i.getIn(["account","acct"]).split("@")[1]},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:586,columnNumber:126},this)}},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:586,columnNumber:16},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:582,columnNumber:7},this));const N={moveUp:this.handleHotkeyMoveUp,moveDown:this.handleHotkeyMoveDown,reply:this.handleHotkeyReply,favourite:this.handleHotkeyFavourite,boost:this.handleHotkeyBoost,mention:this.handleHotkeyMention,openProfile:this.handleHotkeyOpenProfile,toggleHidden:this.handleHotkeyToggleHidden,toggleSensitive:this.handleHotkeyToggleSensitive,openMedia:this.handleHotkeyOpenMedia,onTranslate:this.handleHotkeyTranslate};return n.jsxDEV(A,{bindToDocument:!M,label:g.formatMessage(k.detailedStatus),children:[n.jsxDEV(Fe,{showBackButton:!0,multiColumn:M,extraButton:n.jsxDEV("button",{type:"button",className:"column-header__button",title:g.formatMessage(i.get("hidden")?k.revealAll:k.hideAll),"aria-label":g.formatMessage(i.get("hidden")?k.revealAll:k.hideAll),onClick:this.handleToggleAll,children:n.jsxDEV(Be,{id:i.get("hidden")?"eye-slash":"eye",icon:i.get("hidden")?Re:Qe},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:611,columnNumber:281},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:611,columnNumber:11},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:607,columnNumber:9},this),n.jsxDEV(He,{scrollKey:"thread",shouldUpdateScroll:this.shouldUpdateScroll,children:n.jsxDEV("div",{className:T("scrollable",{fullscreen:u}),ref:this.setContainerRef,children:[e,n.jsxDEV(Ee.HotKeys,{handlers:N,children:n.jsxDEV("div",{className:T("focusable","detailed-status__wrapper",`detailed-status__wrapper-${i.get("visibility")}`),tabIndex:0,"aria-label":Le(g,i,!1),ref:this.setStatusRef,children:[n.jsxDEV(Ye,{status:i,onOpenVideo:this.handleOpenVideo,onOpenMedia:this.handleOpenMedia,onToggleHidden:this.handleToggleHidden,onTranslate:this.handleTranslate,domain:h,showMedia:this.state.showMedia,onToggleMediaVisibility:this.handleToggleMediaVisibility,pictureInPicture:b},`details-${i.get("id")}`,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:621,columnNumber:17},this),n.jsxDEV(at,{status:i,onReply:this.handleReplyClick,onFavourite:this.handleFavouriteClick,onReblog:this.handleReblogClick,onBookmark:this.handleBookmarkClick,onDelete:this.handleDeleteClick,onEdit:this.handleEditClick,onDirect:this.handleDirectClick,onMention:this.handleMentionClick,onMute:this.handleMuteClick,onUnmute:this.handleUnmuteClick,onMuteConversation:this.handleConversationMuteClick,onBlock:this.handleBlockClick,onUnblock:this.handleUnblockClick,onBlockDomain:this.handleBlockDomainClick,onUnblockDomain:this.handleUnblockDomainClick,onReport:this.handleReport,onPin:this.handlePin,onEmbed:this.handleEmbed},`action-bar-${i.get("id")}`,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:634,columnNumber:17},this)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:620,columnNumber:15},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:619,columnNumber:13},this),s,t]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:616,columnNumber:11},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:615,columnNumber:9},this),n.jsxDEV(Y,{children:[n.jsxDEV("title",{children:nt(g,i)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:665,columnNumber:11},this),n.jsxDEV("meta",{name:"robots",content:v&&x?"all":"noindex"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:666,columnNumber:11},this),n.jsxDEV("link",{rel:"canonical",href:i.get("url")},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:667,columnNumber:11},this)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:664,columnNumber:9},this)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/index.jsx",lineNumber:606,columnNumber:7},this)}}a(K,"propTypes",{identity:re,params:p.object.isRequired,dispatch:p.func.isRequired,status:E.map,isLoading:p.bool,ancestorsIds:p.arrayOf(p.string).isRequired,descendantsIds:p.arrayOf(p.string).isRequired,intl:p.object.isRequired,askReplyConfirmation:p.bool,multiColumn:p.bool,domain:p.string.isRequired,pictureInPicture:E.contains({inUse:p.bool,available:p.bool}),...le});const os=J(O($(it)(L(K))));export{os as default};
//# sourceMappingURL=status-index-sguiIXlN.js.map
