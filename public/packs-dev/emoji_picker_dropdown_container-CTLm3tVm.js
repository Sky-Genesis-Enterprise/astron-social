var E=Object.defineProperty;var w=(s,t,e)=>t in s?E(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var i=(s,t,e)=>w(s,typeof t!="symbol"?t+"":t,e);import{b as D,O as y,bT as C,an as k,bv as M,j as T,bU as B,aM as S}from"./useSelectableClick-DBo53LOf.js";import{j as o}from"./client-BG6VvM0b.js";import{r as c,i as _,d as q}from"./index-ykyyQSL-.js";import{c as V}from"./index-guCj-HqV.js";import{n as P,d as L}from"./index-DHslUCy5.js";import{al as F}from"./content_warning-ZcoJE_cd.js";import{M as O}from"./message-Bb0z64dP.js";const U=s=>c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:20,viewBox:"0 -960 960 960",width:20,...s},c.createElement("path",{d:"M612-516q25 0 42.5-17.5T672-576q0-25-17.5-42.5T612-636q-25 0-42.5 17.5T552-576q0 25 17.5 42.5T612-516Zm-264 0q25 0 42.5-17.5T408-576q0-25-17.5-42.5T348-636q-25 0-42.5 17.5T288-576q0 25 17.5 42.5T348-516Zm132 228q60 0 110.5-31t79.5-84H290q29 53 79.5 84T480-288Zm.28 192Q401-96 331-126t-122.5-82.5Q156-261 126-330.96t-30-149.5Q96-560 126-629.5q30-69.5 82.5-122T330.96-834q69.96-30 149.5-30t149.04 30q69.5 30 122 82.5T834-629.28q30 69.73 30 149Q864-401 834-331t-82.5 122.5Q699-156 629.28-126q-69.73 30-149 30ZM480-480Zm0 312q130 0 221-91t91-221q0-130-91-221t-221-91q-130 0-221 91t-91 221q0 130 91 221t221 91Z"})),n=q({emoji:{id:"emoji_button.label",defaultMessage:"Insert emoji"},emoji_search:{id:"emoji_button.search",defaultMessage:"Search..."},custom:{id:"emoji_button.custom",defaultMessage:"Custom"},recent:{id:"emoji_button.recent",defaultMessage:"Frequently used"},search_results:{id:"emoji_button.search_results",defaultMessage:"Search results"},people:{id:"emoji_button.people",defaultMessage:"People"},nature:{id:"emoji_button.nature",defaultMessage:"Nature"},food:{id:"emoji_button.food",defaultMessage:"Food & Drink"},activity:{id:"emoji_button.activity",defaultMessage:"Activity"},travel:{id:"emoji_button.travel",defaultMessage:"Travel & Places"},objects:{id:"emoji_button.objects",defaultMessage:"Objects"},symbols:{id:"emoji_button.symbols",defaultMessage:"Symbols"},flags:{id:"emoji_button.flags",defaultMessage:"Flags"}});let g,r;const f=C?{passive:!0,capture:!0}:!0,R=()=>o.jsxDEV("div",{className:"emoji-mart-no-results",children:[o.jsxDEV(r,{emoji:"sleuth_or_spy",size:32},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:41,columnNumber:5},void 0),o.jsxDEV("div",{className:"emoji-mart-no-results-label",children:o.jsxDEV(O,{id:"emoji_button.not_found",defaultMessage:"No matching emojis found"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:47,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:46,columnNumber:5},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:40,columnNumber:1},void 0);class z extends c.PureComponent{constructor(){super(...arguments);i(this,"handleClick",e=>{this.props.onSelect(e.currentTarget.getAttribute("data-index")*1)});i(this,"handleDocumentClick",e=>{this.node&&!this.node.contains(e.target)&&this.props.onClose()});i(this,"setRef",e=>{this.node=e})}UNSAFE_componentWillReceiveProps(e){e.active?this.attachListeners():this.removeListeners()}componentWillUnmount(){this.removeListeners()}attachListeners(){document.addEventListener("click",this.handleDocumentClick,{capture:!0}),document.addEventListener("touchend",this.handleDocumentClick,f)}removeListeners(){document.removeEventListener("click",this.handleDocumentClick,{capture:!0}),document.removeEventListener("touchend",this.handleDocumentClick,f)}render(){const{active:e}=this.props;return o.jsxDEV("div",{className:"emoji-picker-dropdown__modifiers__menu",style:{display:e?"block":"none"},ref:this.setRef,children:[o.jsxDEV("button",{type:"button",onClick:this.handleClick,"data-index":1,children:o.jsxDEV(r,{emoji:"fist",size:22,skin:1},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:101,columnNumber:73},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:101,columnNumber:9},this),o.jsxDEV("button",{type:"button",onClick:this.handleClick,"data-index":2,children:o.jsxDEV(r,{emoji:"fist",size:22,skin:2},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:102,columnNumber:73},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:102,columnNumber:9},this),o.jsxDEV("button",{type:"button",onClick:this.handleClick,"data-index":3,children:o.jsxDEV(r,{emoji:"fist",size:22,skin:3},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:103,columnNumber:73},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:103,columnNumber:9},this),o.jsxDEV("button",{type:"button",onClick:this.handleClick,"data-index":4,children:o.jsxDEV(r,{emoji:"fist",size:22,skin:4},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:104,columnNumber:73},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:104,columnNumber:9},this),o.jsxDEV("button",{type:"button",onClick:this.handleClick,"data-index":5,children:o.jsxDEV(r,{emoji:"fist",size:22,skin:5},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:105,columnNumber:73},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:105,columnNumber:9},this),o.jsxDEV("button",{type:"button",onClick:this.handleClick,"data-index":6,children:o.jsxDEV(r,{emoji:"fist",size:22,skin:6},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:106,columnNumber:73},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:106,columnNumber:9},this)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:100,columnNumber:7},this)}}class A extends c.PureComponent{constructor(){super(...arguments);i(this,"handleClick",()=>{this.props.active?this.props.onClose():this.props.onOpen()});i(this,"handleSelect",e=>{this.props.onChange(e),this.props.onClose()})}render(){const{active:e,modifier:a}=this.props;return o.jsxDEV("div",{className:"emoji-picker-dropdown__modifiers",children:[o.jsxDEV(r,{emoji:"fist",size:22,skin:a,onClick:this.handleClick},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:141,columnNumber:9},this),o.jsxDEV(z,{active:e,onSelect:this.handleSelect,onClose:this.props.onClose},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:142,columnNumber:9},this)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:140,columnNumber:7},this)}}class N extends c.PureComponent{constructor(){super(...arguments);i(this,"state",{modifierOpen:!1,readyToFocus:!1});i(this,"handleDocumentClick",e=>{this.node&&!this.node.contains(e.target)&&!this.props.pickerButtonRef.contains(e.target)&&this.props.onClose()});i(this,"setRef",e=>{this.node=e});i(this,"getI18n",()=>{const{intl:e}=this.props;return{search:e.formatMessage(n.emoji_search),categories:{search:e.formatMessage(n.search_results),recent:e.formatMessage(n.recent),people:e.formatMessage(n.people),nature:e.formatMessage(n.nature),foods:e.formatMessage(n.food),activity:e.formatMessage(n.activity),places:e.formatMessage(n.travel),objects:e.formatMessage(n.objects),symbols:e.formatMessage(n.symbols),flags:e.formatMessage(n.flags),custom:e.formatMessage(n.custom)}}});i(this,"handleClick",(e,a)=>{e.native||(e.native=e.colons),a.ctrlKey||a.metaKey||this.props.onClose(),this.props.onPick(e)});i(this,"handleModifierOpen",()=>{this.setState({modifierOpen:!0})});i(this,"handleModifierClose",()=>{this.setState({modifierOpen:!1})});i(this,"handleModifierChange",e=>{this.props.onSkinTone(e)})}componentDidMount(){document.addEventListener("click",this.handleDocumentClick,{capture:!0}),document.addEventListener("touchend",this.handleDocumentClick,f),requestAnimationFrame(()=>{if(this.setState({readyToFocus:!0}),this.node){const e=this.node.querySelector('input[type="search"]');e&&e.focus()}})}componentWillUnmount(){document.removeEventListener("click",this.handleDocumentClick,{capture:!0}),document.removeEventListener("touchend",this.handleDocumentClick,f)}render(){const{loading:e,style:a,intl:m,custom_emojis:d,skinTone:u,frequentlyUsedEmojis:j}=this.props;if(e)return o.jsxDEV("div",{style:{width:299}},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:253,columnNumber:14},this);const l=m.formatMessage(n.emoji),{modifierOpen:p}=this.state,h=["recent","people","nature","foods","activity","places","objects","symbols","flags"];return h.splice(1,0,...Array.from(P(d)).sort()),o.jsxDEV("div",{className:V("emoji-picker-dropdown__menu",{selecting:p}),style:a,ref:this.setRef,children:[o.jsxDEV(g,{perLine:8,emojiSize:22,custom:L(d),color:"",emoji:"",title:l,i18n:this.getI18n(),onClick:this.handleClick,include:h,recent:j,skin:u,showPreview:!1,showSkinTones:!1,notFound:R,autoFocus:this.state.readyToFocus,emojiTooltip:!0},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:276,columnNumber:9},this),o.jsxDEV(A,{active:p,modifier:u,onOpen:this.handleModifierOpen,onClose:this.handleModifierClose,onChange:this.handleModifierChange},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:295,columnNumber:9},this)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:275,columnNumber:7},this)}}i(N,"defaultProps",{style:{},loading:!0,frequentlyUsedEmojis:[]});const I=_(N);let Z=class extends c.PureComponent{constructor(){super(...arguments);i(this,"state",{active:!1,loading:!1,placement:"bottom"});i(this,"setRef",e=>{this.dropdown=e});i(this,"onShowDropdown",()=>{this.setState({active:!0}),g||(this.setState({loading:!0}),F().then(e=>{g=e.Picker,r=e.Emoji,this.setState({loading:!1})}).catch(()=>{this.setState({loading:!1,active:!1})}))});i(this,"onHideDropdown",()=>{this.setState({active:!1})});i(this,"onToggle",e=>{!this.state.loading&&(!e.key||e.key==="Enter")&&(this.state.active?this.onHideDropdown():this.onShowDropdown(e))});i(this,"handleKeyDown",e=>{e.key==="Escape"&&this.onHideDropdown()});i(this,"setTargetRef",e=>{this.target=e});i(this,"findTarget",()=>this.target);i(this,"handleOverlayEnter",e=>{this.setState({placement:e.placement})})}render(){const{intl:e,onPickEmoji:a,onSkinTone:m,skinTone:d,frequentlyUsedEmojis:u}=this.props,j=e.formatMessage(n.emoji),{active:l,loading:p,placement:h}=this.state;return o.jsxDEV("div",{className:"emoji-picker-dropdown",onKeyDown:this.handleKeyDown,ref:this.setTargetRef,children:[o.jsxDEV(D,{title:j,"aria-expanded":l,active:l,iconComponent:U,onClick:this.onToggle,inverted:!0},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:387,columnNumber:9},this),o.jsxDEV(y,{show:l,placement:h,flip:!0,target:this.findTarget,popperConfig:{strategy:"fixed",onFirstUpdate:this.handleOverlayEnter},children:({props:v,placement:x})=>o.jsxDEV("div",{...v,style:{...v.style},children:o.jsxDEV("div",{className:`dropdown-animation ${x}`,children:o.jsxDEV(I,{custom_emojis:this.props.custom_emojis,loading:p,onClose:this.onHideDropdown,onPick:a,onSkinTone:m,skinTone:d,frequentlyUsedEmojis:u,pickerButtonRef:this.target},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:400,columnNumber:17},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:399,columnNumber:15},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:398,columnNumber:11},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:396,columnNumber:9},this)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/compose/components/emoji_picker_dropdown.jsx",lineNumber:386,columnNumber:7},this)}};const H=_(Z),K=8,Q=2,b=["+1","grinning","kissing_heart","heart_eyes","laughing","stuck_out_tongue_winking_eye","sweat_smile","joy","yum","disappointed","thinking_face","weary","sob","sunglasses","heart","ok_hand"],$=k([s=>s.getIn(["settings","frequentlyUsedEmojis"],M())],s=>{let t=s.keySeq().sort((e,a)=>s.get(e)-s.get(a)).reverse().slice(0,K*Q).toArray();if(t.length<b.length){let e=b.filter(a=>!t.includes(a));t=t.concat(e.slice(0,b.length-t.length))}return t}),W=k([s=>s.get("custom_emojis")],s=>s.filter(t=>t.get("visible_in_picker")).sort((t,e)=>{const a=t.get("shortcode").toLowerCase(),m=e.get("shortcode").toLowerCase();return a<m?-1:a>m?1:0})),G=s=>({custom_emojis:W(s),skinTone:s.getIn(["settings","skinTone"]),frequentlyUsedEmojis:$(s)}),J=(s,{onPickEmoji:t})=>({onSkinTone:e=>{s(S(["skinTone"],e))},onPickEmoji:e=>{s(B(e)),t&&t(e)}}),re=T(G,J)(H);export{re as E};
//# sourceMappingURL=emoji_picker_dropdown_container-CTLm3tVm.js.map
