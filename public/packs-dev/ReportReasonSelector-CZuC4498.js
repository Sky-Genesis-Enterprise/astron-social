var b=Object.defineProperty;var g=(r,i,e)=>i in r?b(r,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[i]=e;var n=(r,i,e)=>g(r,typeof i!="symbol"?i+"":i,e);import{j as o}from"./client-BG6VvM0b.js";import{i as v,r as u,d as N}from"./index-ykyyQSL-.js";import{c as p}from"./index-guCj-HqV.js";import{a as h}from"./api-uqk9CYtW.js";import"./index-lj9VQs0f.js";import"./initial_state-BP3UcUr4.js";import"./ready-DpOgoWSg.js";const d=N({legal:{id:"report.categories.legal",defaultMessage:"Legal"},other:{id:"report.categories.other",defaultMessage:"Other"},spam:{id:"report.categories.spam",defaultMessage:"Spam"},violation:{id:"report.categories.violation",defaultMessage:"Content violates one or more server rules"}});class c extends u.PureComponent{constructor(){super(...arguments);n(this,"handleClick",()=>{const{id:e,disabled:t,onSelect:s}=this.props;t||s(e)})}render(){const{id:e,text:t,disabled:s,selected:a,children:l}=this.props;return o.jsxDEV("div",{tabIndex:0,role:"button",className:p("report-reason-selector__category",{selected:a,disabled:s}),onClick:this.handleClick,children:[a&&o.jsxDEV("input",{type:"hidden",name:"report[category]",value:e},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/admin/ReportReasonSelector.jsx",lineNumber:41,columnNumber:22},this),o.jsxDEV("div",{className:"report-reason-selector__category__label",children:[o.jsxDEV("span",{className:p("poll__input",{active:a,disabled:s})},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/admin/ReportReasonSelector.jsx",lineNumber:44,columnNumber:11},this),t]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/admin/ReportReasonSelector.jsx",lineNumber:43,columnNumber:9},this),a&&l&&o.jsxDEV("div",{className:"report-reason-selector__category__rules",children:l},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/admin/ReportReasonSelector.jsx",lineNumber:49,columnNumber:9},this)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/admin/ReportReasonSelector.jsx",lineNumber:40,columnNumber:7},this)}}class x extends u.PureComponent{constructor(){super(...arguments);n(this,"handleClick",()=>{const{id:e,disabled:t,onToggle:s}=this.props;t||s(e)})}render(){const{id:e,text:t,disabled:s,selected:a}=this.props;return o.jsxDEV("div",{tabIndex:0,role:"button",className:p("report-reason-selector__rule",{selected:a,disabled:s}),onClick:this.handleClick,children:[o.jsxDEV("span",{className:p("poll__input",{checkbox:!0,active:a,disabled:s})},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/admin/ReportReasonSelector.jsx",lineNumber:82,columnNumber:9},this),a&&o.jsxDEV("input",{type:"hidden",name:"report[rule_ids][]",value:e},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/admin/ReportReasonSelector.jsx",lineNumber:83,columnNumber:22},this),t]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/admin/ReportReasonSelector.jsx",lineNumber:81,columnNumber:7},this)}}class f extends u.PureComponent{constructor(){super(...arguments);n(this,"state",{category:this.props.category,rule_ids:this.props.rule_ids||[],rules:[]});n(this,"_save",()=>{const{id:e,disabled:t}=this.props,{category:s,rule_ids:a}=this.state;t||h(!1).put(`/api/v1/admin/reports/${e}`,{category:s,rule_ids:s==="violation"?a:[]}).catch(l=>{console.error(l)})});n(this,"handleSelect",e=>{this.setState({category:e},()=>this._save())});n(this,"handleToggle",e=>{const{rule_ids:t}=this.state;t.includes(e)?this.setState({rule_ids:t.filter(s=>s!==e)},()=>this._save()):this.setState({rule_ids:[...t,e]},()=>this._save())})}componentDidMount(){h(!1).get("/api/v2/instance").then(e=>{this.setState({rules:e.data.rules})}).catch(e=>{console.error(e)})}render(){const{disabled:e,intl:t}=this.props,{rules:s,category:a,rule_ids:l}=this.state;return o.jsxDEV("div",{className:"report-reason-selector",children:[o.jsxDEV(c,{id:"other",text:t.formatMessage(d.other),selected:a==="other",onSelect:this.handleSelect,disabled:e},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/admin/ReportReasonSelector.jsx",lineNumber:153,columnNumber:9},this),o.jsxDEV(c,{id:"legal",text:t.formatMessage(d.legal),selected:a==="legal",onSelect:this.handleSelect,disabled:e},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/admin/ReportReasonSelector.jsx",lineNumber:154,columnNumber:9},this),o.jsxDEV(c,{id:"spam",text:t.formatMessage(d.spam),selected:a==="spam",onSelect:this.handleSelect,disabled:e},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/admin/ReportReasonSelector.jsx",lineNumber:155,columnNumber:9},this),o.jsxDEV(c,{id:"violation",text:t.formatMessage(d.violation),selected:a==="violation",onSelect:this.handleSelect,disabled:e||s.length===0,children:s.map(m=>o.jsxDEV(x,{id:m.id,text:m.text,selected:l.includes(m.id),onToggle:this.handleToggle,disabled:e},m.id,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/admin/ReportReasonSelector.jsx",lineNumber:157,columnNumber:32},this))},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/admin/ReportReasonSelector.jsx",lineNumber:156,columnNumber:9},this)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/admin/ReportReasonSelector.jsx",lineNumber:152,columnNumber:7},this)}}const y=v(f);export{y as default};
//# sourceMappingURL=ReportReasonSelector-CZuC4498.js.map
