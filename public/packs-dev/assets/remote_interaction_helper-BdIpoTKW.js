import{a}from"../index-lj9VQs0f.js";const h=t=>typeof t=="object"&&t!==null&&"rel"in t&&typeof t.rel=="string"&&(!("template"in t)||typeof t.template=="string")&&(!("href"in t)||typeof t.href=="string"),l=(t,e)=>{if(typeof e=="object"&&e!==null&&"links"in e&&e.links instanceof Array)return e.links.find(n=>h(n)&&n.rel===t)},c=t=>{var e;return(e=l("http://ostatus.org/schema/1.0/subscribe",t))==null?void 0:e.template},r=(t,e)=>{window.parent.postMessage({type:"fetchInteractionURL-success",uri_or_domain:t,template:e},window.origin)},i=()=>{window.parent.postMessage({type:"fetchInteractionURL-failure"},window.origin)},u=t=>{if(typeof t!="string")return!1;const e=new URL("https:///path");return e.hostname=t,e.hostname===t},p=t=>{const e=`https://${t}/authorize_interaction?uri={uri}`;a.get(`https://${t}/.well-known/webfinger`,{params:{resource:`https://${t}`}}).then(({data:n})=>{const s=c(n);r(t,s??e)}).catch(()=>{r(t,e)})},w=t=>{const e=new URL(t).host,n=`https://${e}/authorize_interaction?uri={uri}`;a.get(`https://${e}/.well-known/webfinger`,{params:{resource:t}}).then(({data:s})=>{const o=c(s);r(t,o??n)}).catch(()=>{p(e)})},g=t=>{t=t.replace(/^@/,"");const e=t.split("@");if(e.length!==2||!e[0]||!u(e[1])){i();return}const n=e[1],s=`https://${n}/authorize_interaction?uri={uri}`;if(!n){i();return}a.get(`https://${n}/.well-known/webfinger`,{params:{resource:`acct:${t}`}}).then(({data:o})=>{const f=c(o);r(t,f??s)}).catch(()=>{p(n)})},m=t=>{t===""?i():/^https?:\/\//.test(t)?w(t):t.includes("@")?g(t):p(t)};window.addEventListener("message",t=>{!window.origin||window.parent!==t.source||t.origin!==window.origin||t.data&&typeof t.data=="object"&&"type"in t.data&&t.data.type==="fetchInteractionURL"&&"uri_or_domain"in t.data&&typeof t.data.uri_or_domain=="string"&&m(t.data.uri_or_domain)});
//# sourceMappingURL=remote_interaction_helper-BdIpoTKW.js.map
