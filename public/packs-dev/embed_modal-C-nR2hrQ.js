import{j as e}from"./client-BG6VvM0b.js";import{r as a}from"./index-ykyyQSL-.js";import{I as x,u as v,a9 as g}from"./useSelectableClick-DBo53LOf.js";import{a as _}from"./api-uqk9CYtW.js";import{B as N}from"./index-JeRepxZU.js";import{c as j}from"./index-guCj-HqV.js";import{S as E}from"./content_copy-BTldXt3w.js";import{u as y}from"./useTimeout-4PFQwPAD.js";import{M as r}from"./message-Bb0z64dP.js";import"./short_number--sxn3OKQ.js";import"./numbers-CGZQWBYL.js";import"./index-DHslUCy5.js";import"./ready-DpOgoWSg.js";import"./initial_state-BP3UcUr4.js";import"./load_locale-C-B7BkCQ.js";import"./index-lj9VQs0f.js";const B=({value:t})=>{const s=a.useRef(null),[m,o]=a.useState(!1),[l,n]=a.useState(!1),[u]=y(),d=a.useCallback(()=>{o(!1),s.current&&(s.current.focus(),s.current.select(),s.current.setSelectionRange(0,t.length))},[o,t]),c=a.useCallback(b=>{var h;b.stopPropagation(),navigator.clipboard.writeText(t),(h=s.current)==null||h.blur(),o(!0),u(()=>{o(!1)},700)},[o,u,t]),i=a.useCallback(b=>{b.key===" "&&(navigator.clipboard.writeText(t),o(!0),u(()=>{o(!1)},700))},[o,u,t]),p=a.useCallback(()=>{n(!0)},[n]),f=a.useCallback(()=>{n(!1)},[n]);return e.jsxDEV("div",{className:j("copy-paste-text",{copied:m,focused:l}),tabIndex:0,role:"button",onClick:d,onKeyUp:i,children:[e.jsxDEV("textarea",{readOnly:!0,value:t,ref:s,onClick:d,onFocus:p,onBlur:f},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/copy_paste_text.tsx",lineNumber:68,columnNumber:7},void 0),e.jsxDEV("button",{className:"button",onClick:c,children:[e.jsxDEV(x,{id:"copy",icon:E},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/copy_paste_text.tsx",lineNumber:78,columnNumber:9},void 0)," ",m?e.jsxDEV(r,{id:"copypaste.copied",defaultMessage:"Copied"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/copy_paste_text.tsx",lineNumber:80,columnNumber:9},void 0):e.jsxDEV(r,{id:"copypaste.copy_to_clipboard",defaultMessage:"Copy to clipboard"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/copy_paste_text.tsx",lineNumber:82,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/copy_paste_text.tsx",lineNumber:77,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/copy_paste_text.tsx",lineNumber:61,columnNumber:5},void 0)},O=({id:t,onClose:s})=>{const m=a.useRef(null),o=a.useRef(),[l,n]=a.useState(null),u=v();return a.useEffect(()=>{_().get(`/api/web/embeds/${t}`).then(d=>{var p,f;const c=d.data;n(c);const i=(f=(p=m.current)==null?void 0:p.contentWindow)==null?void 0:f.document;return i&&(i.open(),i.write(c.html),i.close(),i.body.style.margin="0px",o.current=setInterval(()=>window.requestAnimationFrame(()=>{m.current&&(m.current.width=`${i.body.scrollWidth}px`,m.current.height=`${i.body.scrollHeight}px`)}),100)),""}).catch(d=>{u(g(d))})},[u,t,n]),a.useEffect(()=>()=>{o.current&&clearInterval(o.current)},[]),e.jsxDEV("div",{className:"modal-root__modal dialog-modal",children:[e.jsxDEV("div",{className:"dialog-modal__header",children:[e.jsxDEV(N,{onClick:s,children:e.jsxDEV(r,{id:"report.close",defaultMessage:"Done"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/ui/components/embed_modal.tsx",lineNumber:76,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/ui/components/embed_modal.tsx",lineNumber:75,columnNumber:9},void 0),e.jsxDEV("span",{className:"dialog-modal__header__title",children:e.jsxDEV(r,{id:"status.embed",defaultMessage:"Get embed code"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/ui/components/embed_modal.tsx",lineNumber:79,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/ui/components/embed_modal.tsx",lineNumber:78,columnNumber:9},void 0),e.jsxDEV(N,{secondary:!0,onClick:s,children:e.jsxDEV(r,{id:"confirmation_modal.cancel",defaultMessage:"Cancel"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/ui/components/embed_modal.tsx",lineNumber:82,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/ui/components/embed_modal.tsx",lineNumber:81,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/ui/components/embed_modal.tsx",lineNumber:74,columnNumber:7},void 0),e.jsxDEV("div",{className:"dialog-modal__content",children:e.jsxDEV("div",{className:"dialog-modal__content__form",children:[e.jsxDEV(r,{id:"embed.instructions",defaultMessage:"Embed this status on your website by copying the code below."},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/ui/components/embed_modal.tsx",lineNumber:91,columnNumber:11},void 0),e.jsxDEV(B,{value:(l==null?void 0:l.html)??""},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/ui/components/embed_modal.tsx",lineNumber:96,columnNumber:11},void 0),e.jsxDEV(r,{id:"embed.preview",defaultMessage:"Here is what it will look like:"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/ui/components/embed_modal.tsx",lineNumber:98,columnNumber:11},void 0),e.jsxDEV("iframe",{frameBorder:"0",ref:m,sandbox:"allow-scripts allow-same-origin",title:"Preview"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/ui/components/embed_modal.tsx",lineNumber:103,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/ui/components/embed_modal.tsx",lineNumber:90,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/ui/components/embed_modal.tsx",lineNumber:89,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/ui/components/embed_modal.tsx",lineNumber:73,columnNumber:5},void 0)};export{O as default};
//# sourceMappingURL=embed_modal-C-nR2hrQ.js.map
