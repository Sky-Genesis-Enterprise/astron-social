var K=Object.defineProperty;var O=(a,i,s)=>i in a?K(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s;var V=(a,i,s)=>O(a,typeof i!="symbol"?i+"":i,s);import{j as e}from"./client-BG6VvM0b.js";import{r,u as R,d as L}from"./index-ykyyQSL-.js";import{H as J}from"./Helmet-D0DLVOv1.js";import{y as Q,z as X,I as w,A as ee,bs as k,bt as D,an as te,d2 as I,o as ae,af as se,d3 as oe,c0 as ie,c1 as ne,a3 as me,b as re,aT as le,H as ue,d4 as P,ae as ce,cF as de,cG as pe,d5 as fe,d6 as he}from"./useSelectableClick-DBo53LOf.js";import{b as ve,S as be,d as Ne}from"./content_warning-ZcoJE_cd.js";import{e as je}from"./streaming-DlYu2k3L.js";import{C as ge}from"./column-CXD4Tnpb.js";import{C as xe}from"./column_header-CtuyYpNB.js";import{S as _e}from"./scrollable_list-DlG-2WSw.js";import{c as q}from"./index-guCj-HqV.js";import{P as De,d as Ee,L as Me}from"./short_number--sxn3OKQ.js";import{i as Ve}from"./index.es-D--CQIAj.js";import{M as E}from"./message-Bb0z64dP.js";import{l as C}from"./initial_state-BP3UcUr4.js";import{R as Be}from"./index-DHslUCy5.js";import{S as Ce}from"./status_content-BS1khha6.js";import{m as ke}from"./index-Ds3K_5LX.js";import"./api-uqk9CYtW.js";import"./index-lj9VQs0f.js";import"./ready-DpOgoWSg.js";import"./load_locale-C-B7BkCQ.js";import"./skeleton-_5CK2hDo.js";import"./scroll-BygYx8ga.js";import"./add-ZanakRnh.js";import"./chevron_left-R_fqLHXp.js";import"./close-DPVxbBbs.js";import"./scroll_container-BQpJ36fQ.js";import"./react-router-scroll-4.es-6ieDtVAa.js";import"./interopRequireDefault-CdiRfGvq.js";import"./schedule_idle_task-CTsEu-tt.js";import"./load_more-BJ-OkDO5.js";import"./loading_indicator-BBuNQ1GS.js";import"./numbers-CGZQWBYL.js";import"./poll-wjP7LpZg.js";const T=a=>r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:24,viewBox:"0 -960 960 960",width:24,...a},r.createElement("path",{d:"M440-280H280q-83 0-141.5-58.5T80-480q0-83 58.5-141.5T280-680h160v80H280q-50 0-85 35t-35 85q0 50 35 85t85 35h160v80ZM320-440v-80h320v80H320Zm200 160v-80h160q50 0 85-35t35-85q0-50-35-85t-85-35H520v-80h160q83 0 141.5 58.5T880-480q0 83-58.5 141.5T680-280H520Z"})),ye=a=>a.split("/").pop().split("#")[0].split("?")[0];class A extends Q{render(){const{media:i,compact:s}=this.props;return e.jsxDEV("div",{className:q("attachment-list",{compact:s}),children:[!s&&e.jsxDEV("div",{className:"attachment-list__icon",children:e.jsxDEV(w,{id:"link",icon:T},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/attachment_list.jsx",lineNumber:29,columnNumber:13},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/attachment_list.jsx",lineNumber:28,columnNumber:9},this),e.jsxDEV("ul",{className:"attachment-list__list",children:i.map(t=>{const o=t.get("remote_url")||t.get("url");return e.jsxDEV("li",{children:e.jsxDEV("a",{href:o,target:"_blank",rel:"noopener",children:[s&&e.jsxDEV(w,{id:"link",icon:T},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/attachment_list.jsx",lineNumber:40,columnNumber:31},this),s&&" ",o?ye(o):e.jsxDEV(E,{id:"attachments_list.unprocessed",defaultMessage:"(unprocessed)"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/attachment_list.jsx",lineNumber:42,columnNumber:56},this)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/attachment_list.jsx",lineNumber:39,columnNumber:17},this)},t.get("id"),!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/attachment_list.jsx",lineNumber:38,columnNumber:15},this)})},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/attachment_list.jsx",lineNumber:33,columnNumber:9},this)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/attachment_list.jsx",lineNumber:26,columnNumber:7},this)}}V(A,"propTypes",{media:X.list.isRequired,compact:De.bool});class $ extends r.PureComponent{renderItem(i,s,t){const{animate:o}=this.props;let d=50,h=100,p="auto",u="auto",n="auto",f="auto";s===1&&(d=100),(s===4||s===3&&t>0)&&(h=50),s===2?t===0?f="1px":u="1px":s===3?(t===0?f="1px":t>0&&(u="1px"),t===1?n="1px":t>1&&(p="1px")):s===4&&((t===0||t===2)&&(f="1px"),(t===1||t===3)&&(u="1px"),t<2?n="1px":p="1px");const m={left:u,top:p,right:f,bottom:n,width:`${d}%`,height:`${h}%`};return e.jsxDEV("div",{style:m,children:e.jsxDEV(ee,{account:i,animate:o},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/avatar_composite.jsx",lineNumber:85,columnNumber:9},this)},i.get("id"),!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/avatar_composite.jsx",lineNumber:84,columnNumber:7},this)}render(){const{accounts:i,size:s}=this.props;return e.jsxDEV("div",{className:"account__avatar-composite",style:{width:`${s}px`,height:`${s}px`},children:[i.take(4).map((t,o)=>this.renderItem(t,Math.min(i.size,4),o)),i.size>4&&e.jsxDEV("span",{className:"account__avatar-composite__label",children:["+",i.size-4]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/avatar_composite.jsx",lineNumber:98,columnNumber:9},this)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/avatar_composite.jsx",lineNumber:94,columnNumber:7},this)}}V($,"defaultProps",{animate:C});const j=L({more:{id:"status.more",defaultMessage:"More"},open:{id:"conversation.open",defaultMessage:"View conversation"},reply:{id:"status.reply",defaultMessage:"Reply"},markAsRead:{id:"conversation.mark_as_read",defaultMessage:"Mark as read"},delete:{id:"conversation.delete",defaultMessage:"Delete conversation"},muteConversation:{id:"status.mute_conversation",defaultMessage:"Mute conversation"},unmuteConversation:{id:"status.unmute_conversation",defaultMessage:"Unmute conversation"}}),Se=te(a=>a.get("accounts"),(a,i)=>i,(a,i)=>i.map(s=>a.get(s))),we=ke(),Ie=({conversation:a,scrollKey:i,onMoveUp:s,onMoveDown:t})=>{const o=a.get("id"),d=a.get("unread"),h=a.get("last_status"),p=a.get("accounts"),u=R(),n=k(),f=Ee(),m=D(c=>we(c,{id:h})),g=D(c=>Se(c,p)),l=r.useCallback(({currentTarget:c})=>{if(C)return;const v=c.querySelectorAll(".custom-emoji");for(var N=0;N<v.length;N++){let _=v[N];_.src=_.getAttribute("data-original")}},[]),x=r.useCallback(({currentTarget:c})=>{if(C)return;const v=c.querySelectorAll(".custom-emoji");for(var N=0;N<v.length;N++){let _=v[N];_.src=_.getAttribute("data-static")}},[]),b=r.useCallback(()=>{d&&n(I(o)),f.push(`/@${m.getIn(["account","acct"])}/${m.get("id")}`)},[n,f,d,o,m]),z=r.useCallback(()=>{n(I(o))},[n,o]),y=r.useCallback(()=>{n((c,v)=>{v().getIn(["compose","text"]).trim().length!==0?n(ae({modalType:"CONFIRM_REPLY",modalProps:{status:m}})):n(se(m))})},[n,m]),U=r.useCallback(()=>{n(oe(o))},[n,o]),F=r.useCallback(()=>{s(o)},[o,s]),G=r.useCallback(()=>{t(o)},[o,t]),W=r.useCallback(()=>{m.get("muted")?n(ie(m.get("id"))):n(ne(m.get("id")))},[n,m]),S=r.useCallback(()=>{n(me(m.get("id")))},[n,m]);if(!m)return null;const M=[{text:u.formatMessage(j.open),action:b},null,{text:u.formatMessage(m.get("muted")?j.unmuteConversation:j.muteConversation),action:W}];d&&(M.push({text:u.formatMessage(j.markAsRead),action:z}),M.push(null)),M.push({text:u.formatMessage(j.delete),action:U});const Z=g.map(c=>e.jsxDEV(Me,{to:`/@${c.get("acct")}`,"data-hover-card-account":c.get("id"),children:e.jsxDEV("bdi",{children:e.jsxDEV("strong",{className:"display-name__html",dangerouslySetInnerHTML:{__html:c.get("display_name_html")}},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/components/conversation.jsx",lineNumber:155,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/components/conversation.jsx",lineNumber:154,columnNumber:7},void 0)},c.get("id"),!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/components/conversation.jsx",lineNumber:153,columnNumber:3},void 0)).reduce((c,v)=>[c,", ",v]),Y={reply:y,open:b,moveUp:F,moveDown:G,toggleHidden:S};return e.jsxDEV(Ve.HotKeys,{handlers:Y,children:e.jsxDEV("div",{className:q("conversation focusable muted",{unread:d}),tabIndex:0,children:[e.jsxDEV("div",{className:"conversation__avatar",onClick:b,role:"presentation",children:e.jsxDEV($,{accounts:g,size:48},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/components/conversation.jsx",lineNumber:175,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/components/conversation.jsx",lineNumber:174,columnNumber:9},void 0),e.jsxDEV("div",{className:"conversation__content",children:[e.jsxDEV("div",{className:"conversation__content__info",children:[e.jsxDEV("div",{className:"conversation__content__relative-time",children:[d&&e.jsxDEV("span",{className:"conversation__unread"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/components/conversation.jsx",lineNumber:181,columnNumber:26},void 0)," ",e.jsxDEV(Be,{timestamp:m.get("created_at")},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/components/conversation.jsx",lineNumber:181,columnNumber:69},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/components/conversation.jsx",lineNumber:180,columnNumber:13},void 0),e.jsxDEV("div",{className:"conversation__content__names",onMouseEnter:l,onMouseLeave:x,children:e.jsxDEV(E,{id:"conversation.with",defaultMessage:"With {names}",values:{names:e.jsxDEV("span",{children:Z},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/components/conversation.jsx",lineNumber:185,columnNumber:103},void 0)}},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/components/conversation.jsx",lineNumber:185,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/components/conversation.jsx",lineNumber:184,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/components/conversation.jsx",lineNumber:179,columnNumber:11},void 0),e.jsxDEV(Ce,{status:m,onClick:b,expanded:!m.get("hidden"),onExpandedToggle:S,collapsible:!0},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/components/conversation.jsx",lineNumber:189,columnNumber:11},void 0),m.get("media_attachments").size>0&&e.jsxDEV(A,{compact:!0,media:m.get("media_attachments")},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/components/conversation.jsx",lineNumber:198,columnNumber:11},void 0),e.jsxDEV("div",{className:"status__action-bar",children:[e.jsxDEV(re,{className:"status__action-bar-button",title:u.formatMessage(j.reply),icon:"reply",iconComponent:le,onClick:y},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/components/conversation.jsx",lineNumber:205,columnNumber:13},void 0),e.jsxDEV("div",{className:"status__action-bar-dropdown",children:e.jsxDEV(ve,{scrollKey:i,status:m,items:M,icon:"ellipsis-h",iconComponent:be,size:18,direction:"right",title:u.formatMessage(j.more)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/components/conversation.jsx",lineNumber:208,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/components/conversation.jsx",lineNumber:207,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/components/conversation.jsx",lineNumber:204,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/components/conversation.jsx",lineNumber:178,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/components/conversation.jsx",lineNumber:173,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/components/conversation.jsx",lineNumber:172,columnNumber:5},void 0)},H=(a,i,s)=>{const t=a.querySelector(`article:nth-of-type(${i+1}) .focusable`);t&&(s&&a.scrollTop>t.offsetTop?t.scrollIntoView(!0):!s&&a.scrollTop+a.clientHeight<t.offsetTop+t.offsetHeight&&t.scrollIntoView(!1),t.focus())},Te=({scrollKey:a,...i})=>{var g;const s=r.useRef(),t=D(l=>l.getIn(["conversations","items"])),o=D(l=>l.getIn(["conversations","isLoading"],!0)),d=D(l=>l.getIn(["conversations","hasMore"],!1)),h=k(),p=(g=t.last())==null?void 0:g.get("last_status"),u=r.useCallback(l=>{const x=t.findIndex(b=>b.get("id")===l)-1;H(s.current.node,x,!0)},[s,t]),n=r.useCallback(l=>{const x=t.findIndex(b=>b.get("id")===l)+1;H(s.current.node,x,!1)},[s,t]),f=r.useMemo(()=>ue(l=>{h(P({maxId:l}))},300,{leading:!0}),[h]),m=r.useCallback(()=>{p&&f(p)},[f,p]);return e.jsxDEV(_e,{...i,scrollKey:a,isLoading:o,showLoading:o&&t.isEmpty(),hasMore:d,onLoadMore:m,ref:s,children:t.map(l=>e.jsxDEV(Ie,{conversation:l,onMoveUp:u,onMoveDown:n,scrollKey:a},l.get("id"),!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/components/conversations_list.jsx",lineNumber:58,columnNumber:7},void 0))},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/components/conversations_list.jsx",lineNumber:56,columnNumber:5},void 0)},B=L({title:{id:"column.direct",defaultMessage:"Private mentions"}}),vt=({columnId:a,multiColumn:i})=>{const s=r.useRef(),t=R(),o=k(),d=!!a,h=r.useCallback(()=>{o(a?ce(a):de("DIRECT",{}))},[o,a]),p=r.useCallback(n=>{o(pe(a,n))},[o,a]),u=r.useCallback(()=>{s.current.scrollTop()},[s]);return r.useEffect(()=>{o(fe()),o(P());const n=o(je());return()=>{o(he()),n()}},[o]),e.jsxDEV(ge,{bindToDocument:!i,ref:s,label:t.formatMessage(B.title),children:[e.jsxDEV(xe,{icon:"at",iconComponent:Ne,title:t.formatMessage(B.title),onPin:h,onMove:p,onClick:u,pinned:d,multiColumn:i},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/index.jsx",lineNumber:59,columnNumber:7},void 0),e.jsxDEV(Te,{trackScroll:!d,scrollKey:`direct_timeline-${a}`,emptyMessage:e.jsxDEV(E,{id:"empty_column.direct",defaultMessage:"You don't have any private mentions yet. When you send or receive one, it will show up here."},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/index.jsx",lineNumber:73,columnNumber:23},void 0),bindToDocument:!i,prepend:e.jsxDEV("div",{className:"follow_requests-unlocked_explanation",children:e.jsxDEV("span",{children:[e.jsxDEV(E,{id:"compose_form.encryption_warning",defaultMessage:"Posts on Mastodon are not end-to-end encrypted. Do not share any dangerous information over Mastodon."},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/index.jsx",lineNumber:75,columnNumber:78},void 0)," ",e.jsxDEV("a",{href:"/terms",target:"_blank",children:e.jsxDEV(E,{id:"compose_form.direct_message_warning_learn_more",defaultMessage:"Learn more"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/index.jsx",lineNumber:75,columnNumber:288},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/index.jsx",lineNumber:75,columnNumber:255},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/index.jsx",lineNumber:75,columnNumber:72},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/index.jsx",lineNumber:75,columnNumber:18},void 0),alwaysPrepend:!0},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/index.jsx",lineNumber:70,columnNumber:7},void 0),e.jsxDEV(J,{children:[e.jsxDEV("title",{children:t.formatMessage(B.title)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/index.jsx",lineNumber:80,columnNumber:9},void 0),e.jsxDEV("meta",{name:"robots",content:"noindex"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/index.jsx",lineNumber:81,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/index.jsx",lineNumber:79,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/direct_timeline/index.jsx",lineNumber:58,columnNumber:5},void 0)};export{vt as default};
//# sourceMappingURL=direct_timeline-index-C53dUZK6.js.map
