var N=Object.defineProperty;var v=(s,o,e)=>o in s?N(s,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[o]=e;var l=(s,o,e)=>v(s,typeof o!="symbol"?o+"":o,e);import{j as m}from"./client-BG6VvM0b.js";import{i as f,r as g,d as y}from"./index-ykyyQSL-.js";import{H as _}from"./Helmet-D0DLVOv1.js";import{j as x,cY as M,aM as D,B as C,ae as E,cF as B,cG as V,cZ as c}from"./useSelectableClick-DBo53LOf.js";import{c as I}from"./content_warning-ZcoJE_cd.js";import{D as R}from"./dismissable_banner-gWE579A1.js";import{d as P}from"./initial_state-BP3UcUr4.js";import{a as h}from"./streaming-DlYu2k3L.js";import{C as S}from"./column-CXD4Tnpb.js";import{C as T}from"./column_header-CtuyYpNB.js";import{S as $}from"./status_list_container-BG44PHcd.js";import{S as b}from"./setting_toggle-j35gvWMe.js";import{M as p}from"./message-Bb0z64dP.js";import"./short_number--sxn3OKQ.js";import"./numbers-CGZQWBYL.js";import"./api-uqk9CYtW.js";import"./index-lj9VQs0f.js";import"./ready-DpOgoWSg.js";import"./index-DHslUCy5.js";import"./load_locale-C-B7BkCQ.js";import"./index-guCj-HqV.js";import"./skeleton-_5CK2hDo.js";import"./close-DPVxbBbs.js";import"./scroll-BygYx8ga.js";import"./add-ZanakRnh.js";import"./chevron_left-R_fqLHXp.js";import"./status_list-DcEuEIsE.js";import"./gif-CQLWVfmH.js";import"./info-C9UTTy-Y.js";import"./follow_button-DdHXSblv.js";import"./index-JeRepxZU.js";import"./loading_indicator-BBuNQ1GS.js";import"./verified_badge-BOKoz3CJ.js";import"./status_quoted-D9176USW.js";import"./domain_blocks-DiDVA5xw.js";import"./reports-BY0N2xif.js";import"./status-D92xLx8p.js";import"./index.es-D--CQIAj.js";import"./card-v59kuVL6.js";import"./avatar_overlay-XCWEKsBg.js";import"./toString-CBWlLvSL.js";import"./status_content-BS1khha6.js";import"./poll-wjP7LpZg.js";import"./permissions-Djze7cmB.js";import"./visibility_icon-B5XmIQZP.js";import"./index-Ds3K_5LX.js";import"./load_gap-B92Gyxe3.js";import"./scrollable_list-DlG-2WSw.js";import"./scroll_container-BQpJ36fQ.js";import"./react-router-scroll-4.es-6ieDtVAa.js";import"./interopRequireDefault-CdiRfGvq.js";import"./schedule_idle_task-CTsEu-tt.js";import"./load_more-BJ-OkDO5.js";import"./index-Bvr20mGV.js";class H extends g.PureComponent{render(){const{settings:o,onChange:e}=this.props;return m.jsxDEV("div",{className:"column-settings",children:m.jsxDEV("section",{children:m.jsxDEV("div",{className:"column-settings__row",children:[m.jsxDEV(b,{settings:o,settingPath:["other","onlyMedia"],onChange:e,label:m.jsxDEV(p,{id:"community.column_settings.media_only",defaultMessage:"Media only"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/public_timeline/components/column_settings.jsx",lineNumber:26,columnNumber:112},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/public_timeline/components/column_settings.jsx",lineNumber:26,columnNumber:13},this),m.jsxDEV(b,{settings:o,settingPath:["other","onlyRemote"],onChange:e,label:m.jsxDEV(p,{id:"community.column_settings.remote_only",defaultMessage:"Remote only"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/public_timeline/components/column_settings.jsx",lineNumber:27,columnNumber:113},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/public_timeline/components/column_settings.jsx",lineNumber:27,columnNumber:13},this)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/public_timeline/components/column_settings.jsx",lineNumber:25,columnNumber:11},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/public_timeline/components/column_settings.jsx",lineNumber:24,columnNumber:9},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/public_timeline/components/column_settings.jsx",lineNumber:23,columnNumber:7},this)}}const L=f(H),U=(s,{columnId:o})=>{const e=o,i=s.getIn(["settings","columns"]),t=i.findIndex(n=>n.get("uuid")===e);return{settings:e&&t>=0?i.get(t).get("params"):s.getIn(["settings","public"])}},w=(s,{columnId:o})=>({onChange(e,i){s(o?M(o,e,i):D(["public",...e],i))}}),F=x(U,w)(L),d=y({title:{id:"column.public",defaultMessage:"Federated timeline"}}),k=(s,{columnId:o})=>{const e=o,i=s.getIn(["settings","columns"]),t=i.findIndex(u=>u.get("uuid")===e),n=o&&t>=0?i.get(t).getIn(["params","other","onlyMedia"]):s.getIn(["settings","public","other","onlyMedia"]),a=o&&t>=0?i.get(t).getIn(["params","other","onlyRemote"]):s.getIn(["settings","public","other","onlyRemote"]),r=s.getIn(["timelines",`public${a?":remote":""}${n?":media":""}`]);return{hasUnread:!!r&&r.get("unread")>0,onlyMedia:n,onlyRemote:a}};class j extends g.PureComponent{constructor(){super(...arguments);l(this,"handlePin",()=>{const{columnId:e,dispatch:i,onlyMedia:t,onlyRemote:n}=this.props;i(e?E(e):B(n?"REMOTE":"PUBLIC",{other:{onlyMedia:t,onlyRemote:n}}))});l(this,"handleMove",e=>{const{columnId:i,dispatch:t}=this.props;t(V(i,e))});l(this,"handleHeaderClick",()=>{this.column.scrollTop()});l(this,"setRef",e=>{this.column=e});l(this,"handleLoadMore",e=>{const{dispatch:i,onlyMedia:t,onlyRemote:n}=this.props;i(c({maxId:e,onlyMedia:t,onlyRemote:n}))})}componentDidMount(){const{dispatch:e,onlyMedia:i,onlyRemote:t}=this.props,{signedIn:n}=this.props.identity;e(c({onlyMedia:i,onlyRemote:t})),n&&(this.disconnect=e(h({onlyMedia:i,onlyRemote:t})))}componentDidUpdate(e){const{signedIn:i}=this.props.identity;if(e.onlyMedia!==this.props.onlyMedia||e.onlyRemote!==this.props.onlyRemote){const{dispatch:t,onlyMedia:n,onlyRemote:a}=this.props;this.disconnect&&this.disconnect(),t(c({onlyMedia:n,onlyRemote:a})),i&&(this.disconnect=t(h({onlyMedia:n,onlyRemote:a})))}}componentWillUnmount(){this.disconnect&&(this.disconnect(),this.disconnect=null)}render(){const{intl:e,columnId:i,hasUnread:t,multiColumn:n,onlyMedia:a,onlyRemote:r}=this.props,u=!!i;return m.jsxDEV(S,{bindToDocument:!n,ref:this.setRef,label:e.formatMessage(d.title),children:[m.jsxDEV(T,{icon:"globe",iconComponent:I,active:t,title:e.formatMessage(d.title),onPin:this.handlePin,onMove:this.handleMove,onClick:this.handleHeaderClick,pinned:u,multiColumn:n,children:m.jsxDEV(F,{columnId:i},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/public_timeline/index.jsx",lineNumber:141,columnNumber:11},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/public_timeline/index.jsx",lineNumber:130,columnNumber:9},this),m.jsxDEV($,{prepend:m.jsxDEV(R,{id:"public_timeline",children:m.jsxDEV(p,{id:"dismissable_banner.public_timeline",defaultMessage:"These are the most recent public posts from people on the fediverse that people on {domain} follow.",values:{domain:P}},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/public_timeline/index.jsx",lineNumber:145,columnNumber:60},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/public_timeline/index.jsx",lineNumber:145,columnNumber:20},this),timelineId:`public${r?":remote":""}${a?":media":""}`,onLoadMore:this.handleLoadMore,trackScroll:!u,scrollKey:`public_timeline-${i}`,emptyMessage:m.jsxDEV(p,{id:"empty_column.public",defaultMessage:"There is nothing here! Write something publicly, or manually follow users from other servers to fill it up"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/public_timeline/index.jsx",lineNumber:150,columnNumber:25},this),bindToDocument:!n},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/public_timeline/index.jsx",lineNumber:144,columnNumber:9},this),m.jsxDEV(_,{children:[m.jsxDEV("title",{children:e.formatMessage(d.title)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/public_timeline/index.jsx",lineNumber:155,columnNumber:11},this),m.jsxDEV("meta",{name:"robots",content:"noindex"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/public_timeline/index.jsx",lineNumber:156,columnNumber:11},this)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/public_timeline/index.jsx",lineNumber:154,columnNumber:9},this)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/public_timeline/index.jsx",lineNumber:129,columnNumber:7},this)}}l(j,"defaultProps",{onlyMedia:!1});const ze=x(k)(C(f(j)));export{ze as default};
//# sourceMappingURL=public_timeline-index-CXdw9xJ5.js.map
