import{j as a}from"./client-BG6VvM0b.js";import{r as s}from"./index-ykyyQSL-.js";import{c as Q}from"./index-guCj-HqV.js";import{L as y}from"./short_number--sxn3OKQ.js";import{b as G,d as U,D as Y,ag as J}from"./content_warning-ZcoJE_cd.js";import{u as K,a as R,bV as X,o as Z,c as ee,V as ae,bW as A,I as te,A as ie}from"./useSelectableClick-DBo53LOf.js";import{F as $}from"./formatted_date-kPcGS90C.js";import{I as se}from"./inline_account-CGFjWL6Y.js";import{R as ne}from"./index-DHslUCy5.js";import{M as d}from"./message-Bb0z64dP.js";import{g as oe,F as me,P as de}from"./status-D92xLx8p.js";import{C as ue,I as le}from"./card-v59kuVL6.js";import re from"./media_gallery-D8AVjLNK.js";import{S as ce}from"./status_content-BS1khha6.js";import{Q as pe}from"./status_quoted-D9176USW.js";import{V as fe}from"./visibility_icon-B5XmIQZP.js";import{s as ge}from"./schedule_idle_task-CTsEu-tt.js";const he=({statusId:e,timestamp:N})=>{const o=K(),l=R(i=>{var m;return(m=i.history.getIn([e,"items"]))==null?void 0:m.toArray()}),r=R(i=>i.history.getIn([e,"loading"])),c=s.useCallback(()=>{o(X(e))},[o,e]),V=s.useCallback((i,m)=>{o(Z({modalType:"COMPARE_HISTORY",modalProps:{index:m,statusId:e}}))},[o,e]),p=s.useCallback(i=>a.jsxDEV(d,{id:"status.edited_x_times",defaultMessage:"Edited {count, plural, one {# time} other {# times}}",values:{count:i.length-1}},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/edited_timestamp/index.tsx",lineNumber:52,columnNumber:7},void 0),[]),B=s.useCallback((i,m,{onClick:f,onKeyUp:g})=>{const n=a.jsxDEV(ne,{timestamp:i.get("created_at"),short:!1},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/edited_timestamp/index.tsx",lineNumber:73,columnNumber:7},void 0),v=a.jsxDEV(se,{accountId:i.get("account")},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/edited_timestamp/index.tsx",lineNumber:79,columnNumber:7},void 0),_=i.get("original")?a.jsxDEV(d,{id:"status.history.created",defaultMessage:"{name} created {date}",values:{name:v,date:n}},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/edited_timestamp/index.tsx",lineNumber:83,columnNumber:7},void 0):a.jsxDEV(d,{id:"status.history.edited",defaultMessage:"{name} edited {date}",values:{name:v,date:n}},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/edited_timestamp/index.tsx",lineNumber:89,columnNumber:7},void 0);return a.jsxDEV("li",{className:"dropdown-menu__item edited-timestamp__history__item",children:a.jsxDEV("button",{"data-index":m,onClick:f,onKeyUp:g,children:_},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/edited_timestamp/index.tsx",lineNumber:101,columnNumber:11},void 0)},i.get("created_at"),!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/edited_timestamp/index.tsx",lineNumber:97,columnNumber:9},void 0)},[]);return a.jsxDEV(G,{items:l,loading:r,renderItem:B,scrollable:!0,renderHeader:p,onOpen:c,onItemClick:V,forceDropdown:!0,children:a.jsxDEV("button",{className:"dropdown-menu__text-button",children:a.jsxDEV(d,{id:"status.edited",defaultMessage:"Edited {date}",values:{date:a.jsxDEV($,{className:"animated-number",value:N,month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/edited_timestamp/index.tsx",lineNumber:127,columnNumber:13},void 0)}},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/edited_timestamp/index.tsx",lineNumber:122,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/edited_timestamp/index.tsx",lineNumber:121,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/edited_timestamp/index.tsx",lineNumber:111,columnNumber:5},void 0)},Re=({status:e,onOpenMedia:N,onOpenVideo:o,onTranslate:l,measureHeight:r,onHeightChange:c,domain:V,showMedia:p,withLogo:B,overrideDisplayName:i,pictureInPicture:m,onToggleMediaVisibility:f,onToggleHidden:g})=>{const n=(e==null?void 0:e.get("reblog"))??e,[v,_]=s.useState(0),[h,k]=s.useState(!1),x=s.useRef(),M=s.useCallback(t=>{const b=e.getIn(["translation","language"])||e.get("language");o&&o(e.getIn(["media_attachments",0]),b,t)},[o,e]),P=s.useCallback(()=>{k(!h)},[h,k]),L=s.useCallback(()=>{g&&g(e)},[g,e]),C=s.useCallback(t=>{r&&x.current&&(ge(()=>{x.current&&_(Math.ceil(x.current.scrollHeight)+1)}),c&&t&&c())},[c,r,_]),q=s.useCallback(t=>{x.current=t,C()},[C]),z=s.useCallback(()=>{l&&l(e)},[l,e]);if(!n)return null;let u,F,j,D;n.get("media_attachments").getIn([0,"type"])==="video"?D=`${n.get("media_attachments").getIn([0,"meta","original","width"])} / ${n.get("media_attachments").getIn([0,"meta","original","height"])}`:n.get("media_attachments").getIn([0,"type"])==="audio"?D="16 / 9":D=n.get("media_attachments").size===1&&n.get("media_attachments").getIn([0,"meta","small","aspect"])?n.get("media_attachments").getIn([0,"meta","small","aspect"]):"3 / 2";const S={boxSizing:"border-box"};r&&(S.height=v);const I=e.getIn(["translation","language"])||e.get("language");if(m.get("inUse"))u=a.jsxDEV(de,{aspectRatio:D},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:160,columnNumber:13},void 0);else if(e.get("media_attachments").size>0){if(["image","gifv","unknown"].includes(e.getIn(["media_attachments",0,"type"]))||e.get("media_attachments").size>1)u=a.jsxDEV(re,{standalone:!0,sensitive:e.get("sensitive"),media:e.get("media_attachments"),lang:I,height:300,onOpenMedia:N,visible:p,onToggleVisibility:f,matchedFilters:e.get("matched_media_filters")},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:169,columnNumber:7},void 0);else if(e.getIn(["media_attachments",0,"type"])==="audio"){const t=e.getIn(["media_attachments",0]),b=t.getIn(["translation","description"])||t.get("description");u=a.jsxDEV(ee,{src:t.get("url"),alt:b,lang:I,poster:t.get("preview_url")||e.getIn(["account","avatar_static"]),duration:t.getIn(["meta","original","duration"],0),backgroundColor:t.getIn(["meta","colors","background"]),foregroundColor:t.getIn(["meta","colors","foreground"]),accentColor:t.getIn(["meta","colors","accent"]),sensitive:e.get("sensitive"),visible:p,blurhash:t.get("blurhash"),onToggleVisibility:f,matchedFilters:e.get("matched_media_filters")},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:188,columnNumber:7},void 0)}else if(e.getIn(["media_attachments",0,"type"])==="video"){const t=e.getIn(["media_attachments",0]),b=t.getIn(["translation","description"])||t.get("description");u=a.jsxDEV(ae,{preview:t.get("preview_url"),frameRate:t.getIn(["meta","original","frame_rate"]),aspectRatio:`${t.getIn(["meta","original","width"])} / ${t.getIn(["meta","original","height"])}`,blurhash:t.get("blurhash"),src:t.get("url"),alt:b,lang:I,onOpenVideo:M,sensitive:e.get("sensitive"),visible:p,onToggleVisibility:f,matchedFilters:e.get("matched_media_filters")},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:214,columnNumber:7},void 0)}}else e.get("card")&&!e.get("quote")&&(u=a.jsxDEV(ue,{sensitive:e.get("sensitive"),onOpenMedia:N,card:e.get("card")},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:232,columnNumber:5},void 0));e.get("application")&&(F=a.jsxDEV(a.Fragment,{children:["·",a.jsxDEV("a",{className:"detailed-status__application",href:e.getIn(["application","website"]),target:"_blank",rel:"noopener noreferrer",children:e.getIn(["application","name"])},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:244,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:242,columnNumber:5},void 0));const T=a.jsxDEV(a.Fragment,{children:["·",a.jsxDEV(fe,{visibility:e.get("visibility")},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:258,columnNumber:8},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:257,columnNumber:3},void 0);["private","direct"].includes(e.get("visibility"))?j="":j=a.jsxDEV(y,{to:`/@${e.getIn(["account","acct"])}/${e.get("id")}/reblogs`,className:"detailed-status__link",children:[a.jsxDEV("span",{className:"detailed-status__reblogs",children:a.jsxDEV(A,{value:e.get("reblogs_count")},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:271,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:270,columnNumber:9},void 0),a.jsxDEV(d,{id:"status.reblogs",defaultMessage:"{count, plural, one {boost} other {boosts}}",values:{count:e.get("reblogs_count")}},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:273,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:266,columnNumber:5},void 0);const W=a.jsxDEV(y,{to:`/@${e.getIn(["account","acct"])}/${e.get("id")}/favourites`,className:"detailed-status__link",children:[a.jsxDEV("span",{className:"detailed-status__favorites",children:a.jsxDEV(A,{value:e.get("favourites_count")},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:288,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:287,columnNumber:7},void 0),a.jsxDEV(d,{id:"status.favourites",defaultMessage:"{count, plural, one {favorite} other {favorites}}",values:{count:e.get("favourites_count")}},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:290,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:283,columnNumber:3},void 0),{statusContentProps:H,hashtagBar:O}=oe(e),E=e.get("matched_filters"),w=(!E||h)&&(!e.get("hidden")||e.get("spoiler_text").length===0);return a.jsxDEV("div",{style:S,children:a.jsxDEV("div",{ref:q,className:Q("detailed-status",{"status--has-quote":!!e.get("quote")}),children:[e.get("visibility")==="direct"&&a.jsxDEV("div",{className:"status__prepend",children:[a.jsxDEV("div",{className:"status__prepend-icon-wrapper",children:a.jsxDEV(te,{id:"at",icon:U,className:"status__prepend-icon"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:319,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:318,columnNumber:13},void 0),a.jsxDEV(d,{id:"status.direct_indicator",defaultMessage:"Private mention"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:325,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:317,columnNumber:9},void 0),a.jsxDEV(y,{to:`/@${e.getIn(["account","acct"])}`,"data-hover-card-account":e.getIn(["account","id"]),className:"detailed-status__display-name",children:[a.jsxDEV("div",{className:"detailed-status__display-avatar",children:a.jsxDEV(ie,{account:e.get("account"),size:46},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:337,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:336,columnNumber:11},void 0),i??a.jsxDEV(Y,{account:e.get("account"),localDomain:V},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:341,columnNumber:11},void 0),B&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"spacer"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:346,columnNumber:15},void 0),a.jsxDEV(le,{},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:347,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:345,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:331,columnNumber:9},void 0),E&&a.jsxDEV(me,{title:E.join(", "),expanded:h,onClick:P},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:353,columnNumber:9},void 0),e.get("spoiler_text").length>0&&(!E||h)&&a.jsxDEV(J,{text:e.getIn(["translation","spoilerHtml"])||e.get("spoilerHtml"),expanded:w,onClick:L},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:362,columnNumber:9},void 0),w&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV(ce,{status:e,onTranslate:z,...H},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:374,columnNumber:13},void 0),u,O,e.get("quote")&&a.jsxDEV(pe,{quote:e.get("quote")},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:384,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:373,columnNumber:9},void 0),a.jsxDEV("div",{className:"detailed-status__meta",children:[a.jsxDEV("div",{className:"detailed-status__meta__line",children:[a.jsxDEV("a",{className:"detailed-status__datetime",href:`/@${e.getIn(["account","acct"])}/${e.get("id")}`,target:"_blank",rel:"noopener noreferrer",children:a.jsxDEV($,{value:new Date(e.get("created_at")),year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:397,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:391,columnNumber:13},void 0),T,F]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:390,columnNumber:11},void 0),e.get("edited_at")&&a.jsxDEV("div",{className:"detailed-status__meta__line",children:a.jsxDEV(he,{statusId:e.get("id"),timestamp:e.get("edited_at")},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:413,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:412,columnNumber:11},void 0),a.jsxDEV("div",{className:"detailed-status__meta__line",children:[j,j&&a.jsxDEV(a.Fragment,{children:"·"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:422,columnNumber:28},void 0),W]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:420,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:389,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:310,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/status/components/detailed_status.tsx",lineNumber:309,columnNumber:5},void 0)};export{Re as D};
//# sourceMappingURL=detailed_status-CwyM3hb_.js.map
