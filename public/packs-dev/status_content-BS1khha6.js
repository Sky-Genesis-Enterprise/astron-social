var j=Object.defineProperty;var x=(r,l,t)=>l in r?j(r,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[l]=t;var u=(r,l,t)=>x(r,typeof l!="symbol"?l+"":l,t);import{j as a}from"./client-BG6VvM0b.js";import{i as M,r as _}from"./index-ykyyQSL-.js";import{c as E}from"./index-guCj-HqV.js";import{B as C,j as k,I as D,aQ as B}from"./useSelectableClick-DBo53LOf.js";import{P as S}from"./poll-wjP7LpZg.js";import{l as N,B as y}from"./initial_state-BP3UcUr4.js";import{w as V}from"./short_number--sxn3OKQ.js";import{M as h}from"./message-Bb0z64dP.js";const L=706;function I(r){return r.getIn(["translation","contentHtml"])||r.get("contentHtml")}class T extends _.PureComponent{render(){const{translation:l,onClick:t}=this.props;if(l){const s=y.find(e=>e[0]===l.get("detected_source_language")),o=s?s[1]:l.get("detected_source_language"),i=l.get("provider");return a.jsxDEV("div",{className:"translate-button",children:[a.jsxDEV("div",{className:"translate-button__meta",children:a.jsxDEV(h,{id:"status.translated_from_with",defaultMessage:"Translated from {lang} using {provider}",values:{lang:o,provider:i}},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/status_content.jsx",lineNumber:47,columnNumber:13},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/status_content.jsx",lineNumber:46,columnNumber:11},this),a.jsxDEV("button",{className:"link-button",onClick:t,children:a.jsxDEV(h,{id:"status.show_original",defaultMessage:"Show original"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/status_content.jsx",lineNumber:51,columnNumber:13},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/status_content.jsx",lineNumber:50,columnNumber:11},this)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/status_content.jsx",lineNumber:45,columnNumber:9},this)}return a.jsxDEV("button",{className:"status__content__translate-button",onClick:t,children:a.jsxDEV(h,{id:"status.translate",defaultMessage:"Translate"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/status_content.jsx",lineNumber:59,columnNumber:9},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/status_content.jsx",lineNumber:58,columnNumber:7},this)}}const A=r=>({languages:r.getIn(["server","translationLanguages","items"])});class w extends _.PureComponent{constructor(){super(...arguments);u(this,"handleMouseEnter",({currentTarget:t})=>{if(N)return;const s=t.querySelectorAll(".custom-emoji");for(var o=0;o<s.length;o++){let i=s[o];i.src=i.getAttribute("data-original")}});u(this,"handleMouseLeave",({currentTarget:t})=>{if(N)return;const s=t.querySelectorAll(".custom-emoji");for(var o=0;o<s.length;o++){let i=s[o];i.src=i.getAttribute("data-static")}});u(this,"onMentionClick",(t,s)=>{this.props.history&&s.button===0&&!(s.ctrlKey||s.metaKey)&&(s.preventDefault(),this.props.history.push(`/@${t.get("acct")}`))});u(this,"onHashtagClick",(t,s)=>{t=t.replace(/^#/,""),this.props.history&&s.button===0&&!(s.ctrlKey||s.metaKey)&&(s.preventDefault(),this.props.history.push(`/tags/${t}`))});u(this,"handleMouseDown",t=>{this.startXY=[t.clientX,t.clientY]});u(this,"handleMouseUp",t=>{if(!this.startXY)return;const[s,o]=this.startXY,[i,e]=[Math.abs(t.clientX-s),Math.abs(t.clientY-o)];let n=t.target;for(;n;){if(n.localName==="button"||n.localName==="a"||n.localName==="label")return;n=n.parentNode}i+e<5&&(t.button===0||t.button===1)&&t.detail>=1&&this.props.onClick&&this.props.onClick(t),this.startXY=null});u(this,"handleTranslate",()=>{this.props.onTranslate()});u(this,"setRef",t=>{this.node=t})}_updateStatusLinks(){const t=this.node;if(!t)return;const{status:s,onCollapsedToggle:o}=this.props,i=t.querySelectorAll("a");let e,n;for(var c=0;c<i.length;++c)e=i[c],!e.classList.contains("status-link")&&(e.classList.add("status-link"),n=this.props.status.get("mentions").find(m=>e.href===m.get("url")),n?(e.addEventListener("click",this.onMentionClick.bind(this,n),!1),e.setAttribute("title",`@${n.get("acct")}`),e.setAttribute("href",`/@${n.get("acct")}`),e.setAttribute("data-hover-card-account",n.get("id"))):e.textContent[0]==="#"||e.previousSibling&&e.previousSibling.textContent&&e.previousSibling.textContent[e.previousSibling.textContent.length-1]==="#"?(e.addEventListener("click",this.onHashtagClick.bind(this,e.text),!1),e.setAttribute("href",`/tags/${e.text.replace(/^#/,"")}`),e.setAttribute("data-menu-hashtag",this.props.status.getIn(["account","id"]))):(e.setAttribute("title",e.href),e.classList.add("unhandled-link")));if(s.get("collapsed",null)===null&&o){const{collapsible:m,onClick:p}=this.props,d=m&&p&&t.clientHeight>L&&s.get("spoiler_text").length===0;o(d)}}componentDidMount(){this._updateStatusLinks()}componentDidUpdate(){this._updateStatusLinks()}render(){var f;const{status:t,intl:s,statusContent:o}=this.props,i=this.props.onClick&&t.get("collapsed"),e=s.locale.replace(/[_-].*/,""),n=(f=this.props.languages)==null?void 0:f.get(t.get("language")||"und"),c=this.props.onTranslate&&this.props.identity.signedIn&&["public","unlisted"].includes(t.get("visibility"))&&t.get("search_index").trim().length>0&&(n==null?void 0:n.includes(e)),m={__html:o??I(t)},p=t.getIn(["translation","language"])||t.get("language"),d=E("status__content",{"status__content--with-action":this.props.onClick&&this.props.history,"status__content--collapsed":i}),v=i&&a.jsxDEV("button",{className:"status__content__read-more-button",onClick:this.props.onClick,children:[a.jsxDEV(h,{id:"status.read_more",defaultMessage:"Read more"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/status_content.jsx",lineNumber:240,columnNumber:9},this),a.jsxDEV(D,{id:"angle-right",icon:B},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/status_content.jsx",lineNumber:240,columnNumber:78},this)]},"read-more",!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/status_content.jsx",lineNumber:239,columnNumber:5},this),g=c&&a.jsxDEV(T,{onClick:this.handleTranslate,translation:t.get("translation")},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/status_content.jsx",lineNumber:245,columnNumber:5},this),b=!!t.get("poll")&&a.jsxDEV(S,{pollId:t.get("poll"),status:t,lang:p},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/status_content.jsx",lineNumber:249,columnNumber:5},this);return this.props.onClick?a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:d,ref:this.setRef,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[a.jsxDEV("div",{className:"status__content__text status__content__text--visible translate",lang:p,dangerouslySetInnerHTML:m},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/status_content.jsx",lineNumber:256,columnNumber:13},this),b,g]},"status-content",!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/status_content.jsx",lineNumber:255,columnNumber:11},this),v]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/status_content.jsx",lineNumber:254,columnNumber:9},this):a.jsxDEV("div",{className:d,ref:this.setRef,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[a.jsxDEV("div",{className:"status__content__text status__content__text--visible translate",lang:p,dangerouslySetInnerHTML:m},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/status_content.jsx",lineNumber:268,columnNumber:11},this),b,g]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/status_content.jsx",lineNumber:267,columnNumber:9},this)}}const F=V(C(k(A)(M(w))));export{F as S,I as g};
//# sourceMappingURL=status_content-BS1khha6.js.map
