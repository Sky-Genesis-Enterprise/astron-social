var U=Object.defineProperty;var q=(t,s,a)=>s in t?U(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a;var D=(t,s,a)=>q(t,typeof s!="symbol"?s+"":s,a);import{j as i}from"./client-BG6VvM0b.js";import{P as r}from"./short_number--sxn3OKQ.js";import{r as m,u as K,d as O}from"./index-ykyyQSL-.js";import{u as Q,dc as y,a as W,bX as P,g as X,I as G,b as R,aQ as J,i as T,j as Y,dd as Z,y as ee,z as ae,f as ie,de as I,aF as te,df as $,aE as A}from"./useSelectableClick-DBo53LOf.js";import{B as oe}from"./bundle_column_error-BUenPHpF.js";import{e as h}from"./initial_state-BP3UcUr4.js";import{g as se}from"./content_warning-ZcoJE_cd.js";import{C as ne,A as re,L as ue}from"./limited_account_hint-BLPLzyiK.js";import{L as me}from"./loading_indicator-BBuNQ1GS.js";import{S as le}from"./status_list-DcEuEIsE.js";import{C as k}from"./column-u9iYs8RL.js";import{R as w}from"./remote_hint-eP09Z2A-.js";import{u as ce}from"./use-gesture-react.esm-D-KUJBjj.js";import{a as de}from"./status_quoted-D9176USW.js";import{S as pe}from"./chevron_left-R_fqLHXp.js";import{S as fe}from"./push_pin-D9Ue0fV1.js";import{M as v}from"./message-Bb0z64dP.js";import"./numbers-CGZQWBYL.js";import"./api-uqk9CYtW.js";import"./index-lj9VQs0f.js";import"./ready-DpOgoWSg.js";import"./index-DHslUCy5.js";import"./load_locale-C-B7BkCQ.js";import"./index-guCj-HqV.js";import"./Helmet-D0DLVOv1.js";import"./index-JeRepxZU.js";import"./column-CXD4Tnpb.js";import"./scroll-BygYx8ga.js";import"./gif-CQLWVfmH.js";import"./skeleton-_5CK2hDo.js";import"./column_header-CtuyYpNB.js";import"./add-ZanakRnh.js";import"./close-DPVxbBbs.js";import"./notifications-CXGd1tL2.js";import"./notifications_active-fill-CAsA_fEC.js";import"./domain_blocks-DiDVA5xw.js";import"./reports-BY0N2xif.js";import"./group-D_XsjWSa.js";import"./person-BiDPmDpQ.js";import"./content_copy-BTldXt3w.js";import"./counters-BuwkZXvq.js";import"./follow_button-DdHXSblv.js";import"./formatted_date-kPcGS90C.js";import"./react-textarea-autosize.browser.development.esm-B_jXmAxZ.js";import"./use-isomorphic-layout-effect.browser.esm-Bg5tPKmX.js";import"./permissions-Djze7cmB.js";import"./avatar_group-CaQvETuJ.js";import"./avatar_overlay-XCWEKsBg.js";import"./info-C9UTTy-Y.js";import"./verified_badge-BOKoz3CJ.js";import"./load_gap-B92Gyxe3.js";import"./scrollable_list-DlG-2WSw.js";import"./scroll_container-BQpJ36fQ.js";import"./react-router-scroll-4.es-6ieDtVAa.js";import"./interopRequireDefault-CdiRfGvq.js";import"./schedule_idle_task-CTsEu-tt.js";import"./load_more-BJ-OkDO5.js";import"./timeline_hint-5iOue1yn.js";import"./status-D92xLx8p.js";import"./index.es-D--CQIAj.js";import"./card-v59kuVL6.js";import"./toString-CBWlLvSL.js";import"./status_content-BS1khha6.js";import"./poll-wjP7LpZg.js";import"./visibility_icon-B5XmIQZP.js";import"./index-Ds3K_5LX.js";function he(t){const s=m.useRef();return m.useEffect(()=>{s.current=t},[t]),s.current}const V=O({previous:{id:"featured_carousel.previous",defaultMessage:"Previous"},next:{id:"featured_carousel.next",defaultMessage:"Next"},slide:{id:"featured_carousel.slide",defaultMessage:"{index} of {total}"}}),be=({accountId:t,tagged:s})=>{var C;const a=K(),o=m.useId(),n=Q();m.useEffect(()=>{t&&n(y(t,{tagged:s}))},[t,n,s]);const e=W(c=>c.timelines.getIn([`account:${t}:pinned${s?`:${s}`:""}`,"items"],P())),[u,d]=m.useState(0),x=m.useRef(null),l=m.useCallback(c=>{d(g=>{var L;const M=e.size-1;let N=g+c;N<0?N=M:N>M&&(N=0);const S=(L=x.current)==null?void 0:L.children[N];return S&&E(S.scrollHeight),N})},[e.size]),[f,E]=m.useState(((C=x.current)==null?void 0:C.scrollHeight)??0),B=he(f),j=m.useRef(new ResizeObserver(()=>{l(0)})),p=X({x:`-${u*100}%`,height:f,immediate:!B});m.useLayoutEffect(()=>{f===0&&l(0)},[f,l]);const b=ce(({swipe:[c]})=>{l(c*-1)}),H=m.useCallback(()=>{l(-1)},[l]),F=m.useCallback(()=>{l(1)},[l]);return!t||e.isEmpty()?null:i.jsxDEV("div",{className:"featured-carousel",...b(),"aria-roledescription":"carousel","aria-labelledby":`${o}-title`,role:"region",children:[i.jsxDEV("div",{className:"featured-carousel__header",children:[i.jsxDEV("h4",{className:"featured-carousel__title",id:`${o}-title`,children:[i.jsxDEV(G,{id:"thumb-tack",icon:fe},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/featured_carousel.tsx",lineNumber:135,columnNumber:11},void 0),i.jsxDEV(v,{id:"featured_carousel.header",defaultMessage:"{count, plural, one {Pinned Post} other {Pinned Posts}}",values:{count:e.size}},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/featured_carousel.tsx",lineNumber:136,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/featured_carousel.tsx",lineNumber:131,columnNumber:9},void 0),e.size>1&&i.jsxDEV(i.Fragment,{children:[i.jsxDEV(R,{title:a.formatMessage(V.previous),icon:"chevron-left",iconComponent:pe,onClick:H},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/featured_carousel.tsx",lineNumber:144,columnNumber:13},void 0),i.jsxDEV("span",{"aria-live":"polite",children:[i.jsxDEV(v,{id:"featured_carousel.post",defaultMessage:"Post",children:c=>i.jsxDEV("span",{className:"sr-only",children:c},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/featured_carousel.tsx",lineNumber:155,columnNumber:28},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/featured_carousel.tsx",lineNumber:151,columnNumber:15},void 0),u+1," / ",e.size]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/featured_carousel.tsx",lineNumber:150,columnNumber:13},void 0),i.jsxDEV(R,{title:a.formatMessage(V.next),icon:"chevron-right",iconComponent:J,onClick:F},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/featured_carousel.tsx",lineNumber:159,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/featured_carousel.tsx",lineNumber:143,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/featured_carousel.tsx",lineNumber:130,columnNumber:7},void 0),i.jsxDEV(T.div,{className:"featured-carousel__slides",ref:x,style:p,"aria-atomic":"false","aria-live":"polite",children:e.map((c,g)=>i.jsxDEV(Ne,{"data-index":g,"aria-label":a.formatMessage(V.slide,{index:g+1,total:e.size}),statusId:c,observer:j.current,active:g===u},`f-${c}`,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/featured_carousel.tsx",lineNumber:176,columnNumber:9},void 0))},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/featured_carousel.tsx",lineNumber:168,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/featured_carousel.tsx",lineNumber:123,columnNumber:5},void 0)},Ne=({statusId:t,active:s,observer:a,...o})=>{const n=m.useCallback(e=>{e&&a.observe(e)},[a]);return i.jsxDEV(T.div,{className:"featured-carousel__slide",inert:s?void 0:"true","aria-roledescription":"slide",role:"group",ref:n,...o,children:i.jsxDEV(de,{id:t,contextType:"account",withCounters:!0},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/featured_carousel.tsx",lineNumber:221,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/featured_carousel.tsx",lineNumber:212,columnNumber:5},void 0)},_=P(),xe=(t,{params:{acct:s,id:a,tagged:o},withReplies:n=!1})=>{const e=a||t.accounts_map[Z(s)];if(e===null)return{isLoading:!1,isAccount:!1,statusIds:_};if(!e)return{isLoading:!0,statusIds:_};const u=n?`${e}:with_replies`:`${e}${o?`:${o}`:""}`;return{accountId:e,isAccount:!!t.getIn(["accounts",e]),statusIds:t.getIn(["timelines",`account:${u}`,"items"],_),isLoading:t.getIn(["timelines",`account:${u}`,"isLoading"]),hasMore:t.getIn(["timelines",`account:${u}`,"hasMore"]),suspended:t.getIn(["accounts",e,"suspended"],!1),hidden:se(t,e),blockedBy:t.getIn(["relationships",e,"blocked_by"],!1)}};class z extends ee{constructor(){super(...arguments);D(this,"handleLoadMore",a=>{this.props.dispatch(I(this.props.accountId,{maxId:a,withReplies:this.props.withReplies,tagged:this.props.params.tagged}))})}_load(){const{accountId:a,withReplies:o,params:{tagged:n},dispatch:e}=this.props;e(ie(a)),o||e(y(a,{tagged:n})),e(I(a,{withReplies:o,tagged:n})),a===h&&e(te(`account:${h}`))}componentDidMount(){const{params:{acct:a},accountId:o,dispatch:n}=this.props;o?this._load():n($(a))}componentDidUpdate(a){const{params:{acct:o,tagged:n},accountId:e,withReplies:u,dispatch:d}=this.props;a.accountId!==e&&e?this._load():a.params.acct!==o?d($(o)):a.params.tagged!==n&&(u||d(y(e,{tagged:n})),d(I(e,{withReplies:u,tagged:n}))),a.accountId===h&&e!==h&&d(A({timeline:`account:${h}`}))}componentWillUnmount(){const{dispatch:a,accountId:o}=this.props;o===h&&a(A({timeline:`account:${h}`}))}render(){const{accountId:a,statusIds:o,isLoading:n,hasMore:e,blockedBy:u,suspended:d,isAccount:x,hidden:l,multiColumn:f,remote:E,remoteUrl:B,params:{tagged:j}}=this.props;if(n&&o.isEmpty())return i.jsxDEV(k,{children:i.jsxDEV(me,{},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_timeline/index.jsx",lineNumber:143,columnNumber:11},this)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_timeline/index.jsx",lineNumber:142,columnNumber:9},this);if(!n&&!x)return i.jsxDEV(oe,{multiColumn:f,errorType:"routing"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_timeline/index.jsx",lineNumber:148,columnNumber:9},this);let p;const b=d||u||l;return d?p=i.jsxDEV(v,{id:"empty_column.account_suspended",defaultMessage:"Account suspended"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_timeline/index.jsx",lineNumber:157,columnNumber:22},this):l?p=i.jsxDEV(ue,{accountId:a},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_timeline/index.jsx",lineNumber:159,columnNumber:22},this):u?p=i.jsxDEV(v,{id:"empty_column.account_unavailable",defaultMessage:"Profile unavailable"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_timeline/index.jsx",lineNumber:161,columnNumber:22},this):E&&o.isEmpty()?p=i.jsxDEV(w,{accountId:a,url:B},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_timeline/index.jsx",lineNumber:163,columnNumber:22},this):p=i.jsxDEV(v,{id:"empty_column.account_timeline",defaultMessage:"No posts found"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_timeline/index.jsx",lineNumber:165,columnNumber:22},this),i.jsxDEV(k,{children:[i.jsxDEV(ne,{},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_timeline/index.jsx",lineNumber:170,columnNumber:9},this),i.jsxDEV(le,{prepend:i.jsxDEV(i.Fragment,{children:[i.jsxDEV(re,{accountId:this.props.accountId,hideTabs:b,tagged:j},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_timeline/index.jsx",lineNumber:175,columnNumber:15},this),!b&&i.jsxDEV(be,{accountId:this.props.accountId,tagged:j},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_timeline/index.jsx",lineNumber:176,columnNumber:36},this)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_timeline/index.jsx",lineNumber:174,columnNumber:11},this),alwaysPrepend:!0,append:i.jsxDEV(w,{accountId:a},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_timeline/index.jsx",lineNumber:180,columnNumber:19},this),scrollKey:"account_timeline",statusIds:b?_:o,isLoading:n,hasMore:!b&&e,onLoadMore:this.handleLoadMore,emptyMessage:p,bindToDocument:!f,timelineId:"account",withCounters:!0},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_timeline/index.jsx",lineNumber:172,columnNumber:9},this)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_timeline/index.jsx",lineNumber:169,columnNumber:7},this)}}D(z,"propTypes",{params:r.shape({acct:r.string,id:r.string,tagged:r.string}).isRequired,accountId:r.string,dispatch:r.func.isRequired,statusIds:ae.list,isLoading:r.bool,hasMore:r.bool,withReplies:r.bool,blockedBy:r.bool,isAccount:r.bool,suspended:r.bool,hidden:r.bool,multiColumn:r.bool});const La=Y(xe)(z);export{La as default};
//# sourceMappingURL=account_timeline-index-BGpNXxCt.js.map
