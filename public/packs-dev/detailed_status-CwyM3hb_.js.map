{"version":3,"file":"detailed_status-CwyM3hb_.js","sources":["../../app/javascript/mastodon/components/edited_timestamp/index.tsx","../../app/javascript/mastodon/features/status/components/detailed_status.tsx"],"sourcesContent":["import { useCallback } from 'react';\n\nimport { FormattedMessage } from 'react-intl';\n\nimport type { Map as ImmutableMap, List as ImmutableList } from 'immutable';\n\nimport { fetchHistory } from 'mastodon/actions/history';\nimport { openModal } from 'mastodon/actions/modal';\nimport { Dropdown } from 'mastodon/components/dropdown_menu';\nimport { FormattedDateWrapper } from 'mastodon/components/formatted_date';\nimport InlineAccount from 'mastodon/components/inline_account';\nimport { RelativeTimestamp } from 'mastodon/components/relative_timestamp';\nimport { useAppDispatch, useAppSelector } from 'mastodon/store';\n\ntype HistoryItem = ImmutableMap<string, unknown>;\n\nexport const EditedTimestamp: React.FC<{\n  statusId: string;\n  timestamp: string;\n}> = ({ statusId, timestamp }) => {\n  const dispatch = useAppDispatch();\n  const items = useAppSelector(\n    (state) =>\n      (\n        state.history.getIn([statusId, 'items']) as\n          | ImmutableList<unknown>\n          | undefined\n      )?.toArray() as HistoryItem[],\n  );\n  const loading = useAppSelector(\n    (state) => state.history.getIn([statusId, 'loading']) as boolean,\n  );\n\n  const handleOpen = useCallback(() => {\n    dispatch(fetchHistory(statusId));\n  }, [dispatch, statusId]);\n\n  const handleItemClick = useCallback(\n    (_item: HistoryItem, index: number) => {\n      dispatch(\n        openModal({\n          modalType: 'COMPARE_HISTORY',\n          modalProps: { index, statusId },\n        }),\n      );\n    },\n    [dispatch, statusId],\n  );\n\n  const renderHeader = useCallback((items: HistoryItem[]) => {\n    return (\n      <FormattedMessage\n        id='status.edited_x_times'\n        defaultMessage='Edited {count, plural, one {# time} other {# times}}'\n        values={{ count: items.length - 1 }}\n      />\n    );\n  }, []);\n\n  const renderItem = useCallback(\n    (\n      item: HistoryItem,\n      index: number,\n      {\n        onClick,\n        onKeyUp,\n      }: {\n        onClick: React.MouseEventHandler;\n        onKeyUp: React.KeyboardEventHandler;\n      },\n    ) => {\n      const formattedDate = (\n        <RelativeTimestamp\n          timestamp={item.get('created_at') as string}\n          short={false}\n        />\n      );\n      const formattedName = (\n        <InlineAccount accountId={item.get('account') as string} />\n      );\n\n      const label = (item.get('original') as boolean) ? (\n        <FormattedMessage\n          id='status.history.created'\n          defaultMessage='{name} created {date}'\n          values={{ name: formattedName, date: formattedDate }}\n        />\n      ) : (\n        <FormattedMessage\n          id='status.history.edited'\n          defaultMessage='{name} edited {date}'\n          values={{ name: formattedName, date: formattedDate }}\n        />\n      );\n\n      return (\n        <li\n          className='dropdown-menu__item edited-timestamp__history__item'\n          key={item.get('created_at') as string}\n        >\n          <button data-index={index} onClick={onClick} onKeyUp={onKeyUp}>\n            {label}\n          </button>\n        </li>\n      );\n    },\n    [],\n  );\n\n  return (\n    <Dropdown<HistoryItem>\n      items={items}\n      loading={loading}\n      renderItem={renderItem}\n      scrollable\n      renderHeader={renderHeader}\n      onOpen={handleOpen}\n      onItemClick={handleItemClick}\n      forceDropdown\n    >\n      <button className='dropdown-menu__text-button'>\n        <FormattedMessage\n          id='status.edited'\n          defaultMessage='Edited {date}'\n          values={{\n            date: (\n              <FormattedDateWrapper\n                className='animated-number'\n                value={timestamp}\n                month='short'\n                day='2-digit'\n                hour='2-digit'\n                minute='2-digit'\n              />\n            ),\n          }}\n        />\n      </button>\n    </Dropdown>\n  );\n};\n","/* eslint-disable @typescript-eslint/no-unsafe-member-access,\n                  @typescript-eslint/no-unsafe-call,\n                  @typescript-eslint/no-explicit-any,\n                  @typescript-eslint/no-unsafe-assignment */\n\nimport type { CSSProperties } from 'react';\nimport { useState, useRef, useCallback } from 'react';\n\nimport { FormattedMessage } from 'react-intl';\n\nimport classNames from 'classnames';\nimport { Link } from 'react-router-dom';\n\nimport AlternateEmailIcon from '@/material-icons/400-24px/alternate_email.svg?react';\nimport { AnimatedNumber } from 'mastodon/components/animated_number';\nimport { Avatar } from 'mastodon/components/avatar';\nimport { ContentWarning } from 'mastodon/components/content_warning';\nimport { DisplayName } from 'mastodon/components/display_name';\nimport { EditedTimestamp } from 'mastodon/components/edited_timestamp';\nimport { FilterWarning } from 'mastodon/components/filter_warning';\nimport { FormattedDateWrapper } from 'mastodon/components/formatted_date';\nimport type { StatusLike } from 'mastodon/components/hashtag_bar';\nimport { getHashtagBarForStatus } from 'mastodon/components/hashtag_bar';\nimport { Icon } from 'mastodon/components/icon';\nimport { IconLogo } from 'mastodon/components/logo';\nimport MediaGallery from 'mastodon/components/media_gallery';\nimport { PictureInPicturePlaceholder } from 'mastodon/components/picture_in_picture_placeholder';\nimport StatusContent from 'mastodon/components/status_content';\nimport { QuotedStatus } from 'mastodon/components/status_quoted';\nimport { VisibilityIcon } from 'mastodon/components/visibility_icon';\nimport { Audio } from 'mastodon/features/audio';\nimport scheduleIdleTask from 'mastodon/features/ui/util/schedule_idle_task';\nimport { Video } from 'mastodon/features/video';\n\nimport Card from './card';\n\ninterface VideoModalOptions {\n  startTime: number;\n  autoPlay?: boolean;\n  defaultVolume: number;\n}\n\nexport const DetailedStatus: React.FC<{\n  status: any;\n  onOpenMedia?: (status: any, index: number, lang: string) => void;\n  onOpenVideo?: (status: any, lang: string, options: VideoModalOptions) => void;\n  onTranslate?: (status: any) => void;\n  measureHeight?: boolean;\n  onHeightChange?: () => void;\n  domain: string;\n  showMedia?: boolean;\n  withLogo?: boolean;\n  overrideDisplayName?: React.ReactNode;\n  pictureInPicture: any;\n  onToggleHidden?: (status: any) => void;\n  onToggleMediaVisibility?: () => void;\n}> = ({\n  status,\n  onOpenMedia,\n  onOpenVideo,\n  onTranslate,\n  measureHeight,\n  onHeightChange,\n  domain,\n  showMedia,\n  withLogo,\n  overrideDisplayName,\n  pictureInPicture,\n  onToggleMediaVisibility,\n  onToggleHidden,\n}) => {\n  const properStatus = status?.get('reblog') ?? status;\n  const [height, setHeight] = useState(0);\n  const [showDespiteFilter, setShowDespiteFilter] = useState(false);\n  const nodeRef = useRef<HTMLDivElement>();\n\n  const handleOpenVideo = useCallback(\n    (options: VideoModalOptions) => {\n      const lang = (status.getIn(['translation', 'language']) ||\n        status.get('language')) as string;\n      if (onOpenVideo)\n        onOpenVideo(status.getIn(['media_attachments', 0]), lang, options);\n    },\n    [onOpenVideo, status],\n  );\n\n  const handleFilterToggle = useCallback(() => {\n    setShowDespiteFilter(!showDespiteFilter);\n  }, [showDespiteFilter, setShowDespiteFilter]);\n\n  const handleExpandedToggle = useCallback(() => {\n    if (onToggleHidden) onToggleHidden(status);\n  }, [onToggleHidden, status]);\n\n  const _measureHeight = useCallback(\n    (heightJustChanged?: boolean) => {\n      if (measureHeight && nodeRef.current) {\n        scheduleIdleTask(() => {\n          if (nodeRef.current)\n            setHeight(Math.ceil(nodeRef.current.scrollHeight) + 1);\n        });\n\n        if (onHeightChange && heightJustChanged) {\n          onHeightChange();\n        }\n      }\n    },\n    [onHeightChange, measureHeight, setHeight],\n  );\n\n  const handleRef = useCallback(\n    (c: HTMLDivElement) => {\n      nodeRef.current = c;\n      _measureHeight();\n    },\n    [_measureHeight],\n  );\n\n  const handleTranslate = useCallback(() => {\n    if (onTranslate) onTranslate(status);\n  }, [onTranslate, status]);\n\n  if (!properStatus) {\n    return null;\n  }\n\n  let media;\n  let applicationLink;\n  let reblogLink;\n  let attachmentAspectRatio;\n\n  if (properStatus.get('media_attachments').getIn([0, 'type']) === 'video') {\n    attachmentAspectRatio = `${properStatus.get('media_attachments').getIn([0, 'meta', 'original', 'width'])} / ${properStatus.get('media_attachments').getIn([0, 'meta', 'original', 'height'])}`;\n  } else if (\n    properStatus.get('media_attachments').getIn([0, 'type']) === 'audio'\n  ) {\n    attachmentAspectRatio = '16 / 9';\n  } else {\n    attachmentAspectRatio =\n      properStatus.get('media_attachments').size === 1 &&\n      properStatus\n        .get('media_attachments')\n        .getIn([0, 'meta', 'small', 'aspect'])\n        ? properStatus\n            .get('media_attachments')\n            .getIn([0, 'meta', 'small', 'aspect'])\n        : '3 / 2';\n  }\n\n  const outerStyle = { boxSizing: 'border-box' } as CSSProperties;\n\n  if (measureHeight) {\n    outerStyle.height = height;\n  }\n\n  const language =\n    status.getIn(['translation', 'language']) || status.get('language');\n\n  if (pictureInPicture.get('inUse')) {\n    media = <PictureInPicturePlaceholder aspectRatio={attachmentAspectRatio} />;\n  } else if (status.get('media_attachments').size > 0) {\n    if (\n      ['image', 'gifv', 'unknown'].includes(\n        status.getIn(['media_attachments', 0, 'type']) as string,\n      ) ||\n      status.get('media_attachments').size > 1\n    ) {\n      media = (\n        <MediaGallery\n          standalone\n          sensitive={status.get('sensitive')}\n          media={status.get('media_attachments')}\n          lang={language}\n          height={300}\n          onOpenMedia={onOpenMedia}\n          visible={showMedia}\n          onToggleVisibility={onToggleMediaVisibility}\n          matchedFilters={status.get('matched_media_filters')}\n        />\n      );\n    } else if (status.getIn(['media_attachments', 0, 'type']) === 'audio') {\n      const attachment = status.getIn(['media_attachments', 0]);\n      const description =\n        attachment.getIn(['translation', 'description']) ||\n        attachment.get('description');\n\n      media = (\n        <Audio\n          src={attachment.get('url')}\n          alt={description}\n          lang={language}\n          poster={\n            attachment.get('preview_url') ||\n            status.getIn(['account', 'avatar_static'])\n          }\n          duration={attachment.getIn(['meta', 'original', 'duration'], 0)}\n          backgroundColor={attachment.getIn(['meta', 'colors', 'background'])}\n          foregroundColor={attachment.getIn(['meta', 'colors', 'foreground'])}\n          accentColor={attachment.getIn(['meta', 'colors', 'accent'])}\n          sensitive={status.get('sensitive')}\n          visible={showMedia}\n          blurhash={attachment.get('blurhash')}\n          onToggleVisibility={onToggleMediaVisibility}\n          matchedFilters={status.get('matched_media_filters')}\n        />\n      );\n    } else if (status.getIn(['media_attachments', 0, 'type']) === 'video') {\n      const attachment = status.getIn(['media_attachments', 0]);\n      const description =\n        attachment.getIn(['translation', 'description']) ||\n        attachment.get('description');\n\n      media = (\n        <Video\n          preview={attachment.get('preview_url')}\n          frameRate={attachment.getIn(['meta', 'original', 'frame_rate'])}\n          aspectRatio={`${attachment.getIn(['meta', 'original', 'width'])} / ${attachment.getIn(['meta', 'original', 'height'])}`}\n          blurhash={attachment.get('blurhash')}\n          src={attachment.get('url')}\n          alt={description}\n          lang={language}\n          onOpenVideo={handleOpenVideo}\n          sensitive={status.get('sensitive')}\n          visible={showMedia}\n          onToggleVisibility={onToggleMediaVisibility}\n          matchedFilters={status.get('matched_media_filters')}\n        />\n      );\n    }\n  } else if (status.get('card') && !status.get('quote')) {\n    media = (\n      <Card\n        sensitive={status.get('sensitive')}\n        onOpenMedia={onOpenMedia}\n        card={status.get('card')}\n      />\n    );\n  }\n\n  if (status.get('application')) {\n    applicationLink = (\n      <>\n        ·\n        <a\n          className='detailed-status__application'\n          href={status.getIn(['application', 'website'])}\n          target='_blank'\n          rel='noopener noreferrer'\n        >\n          {status.getIn(['application', 'name'])}\n        </a>\n      </>\n    );\n  }\n\n  const visibilityLink = (\n    <>\n      ·<VisibilityIcon visibility={status.get('visibility')} />\n    </>\n  );\n\n  if (['private', 'direct'].includes(status.get('visibility') as string)) {\n    reblogLink = '';\n  } else {\n    reblogLink = (\n      <Link\n        to={`/@${status.getIn(['account', 'acct'])}/${status.get('id')}/reblogs`}\n        className='detailed-status__link'\n      >\n        <span className='detailed-status__reblogs'>\n          <AnimatedNumber value={status.get('reblogs_count')} />\n        </span>\n        <FormattedMessage\n          id='status.reblogs'\n          defaultMessage='{count, plural, one {boost} other {boosts}}'\n          values={{ count: status.get('reblogs_count') }}\n        />\n      </Link>\n    );\n  }\n\n  const favouriteLink = (\n    <Link\n      to={`/@${status.getIn(['account', 'acct'])}/${status.get('id')}/favourites`}\n      className='detailed-status__link'\n    >\n      <span className='detailed-status__favorites'>\n        <AnimatedNumber value={status.get('favourites_count')} />\n      </span>\n      <FormattedMessage\n        id='status.favourites'\n        defaultMessage='{count, plural, one {favorite} other {favorites}}'\n        values={{ count: status.get('favourites_count') }}\n      />\n    </Link>\n  );\n\n  const { statusContentProps, hashtagBar } = getHashtagBarForStatus(\n    status as StatusLike,\n  );\n\n  const matchedFilters = status.get('matched_filters');\n\n  const expanded =\n    (!matchedFilters || showDespiteFilter) &&\n    (!status.get('hidden') || status.get('spoiler_text').length === 0);\n\n  return (\n    <div style={outerStyle}>\n      <div\n        ref={handleRef}\n        className={classNames('detailed-status', {\n          'status--has-quote': !!status.get('quote'),\n        })}\n      >\n        {status.get('visibility') === 'direct' && (\n          <div className='status__prepend'>\n            <div className='status__prepend-icon-wrapper'>\n              <Icon\n                id='at'\n                icon={AlternateEmailIcon}\n                className='status__prepend-icon'\n              />\n            </div>\n            <FormattedMessage\n              id='status.direct_indicator'\n              defaultMessage='Private mention'\n            />\n          </div>\n        )}\n        <Link\n          to={`/@${status.getIn(['account', 'acct'])}`}\n          data-hover-card-account={status.getIn(['account', 'id'])}\n          className='detailed-status__display-name'\n        >\n          <div className='detailed-status__display-avatar'>\n            <Avatar account={status.get('account')} size={46} />\n          </div>\n\n          {overrideDisplayName ?? (\n            <DisplayName account={status.get('account')} localDomain={domain} />\n          )}\n\n          {withLogo && (\n            <>\n              <div className='spacer' />\n              <IconLogo />\n            </>\n          )}\n        </Link>\n\n        {matchedFilters && (\n          <FilterWarning\n            title={matchedFilters.join(', ')}\n            expanded={showDespiteFilter}\n            onClick={handleFilterToggle}\n          />\n        )}\n\n        {status.get('spoiler_text').length > 0 &&\n          (!matchedFilters || showDespiteFilter) && (\n            <ContentWarning\n              text={\n                status.getIn(['translation', 'spoilerHtml']) ||\n                status.get('spoilerHtml')\n              }\n              expanded={expanded}\n              onClick={handleExpandedToggle}\n            />\n          )}\n\n        {expanded && (\n          <>\n            <StatusContent\n              status={status}\n              onTranslate={handleTranslate}\n              {...(statusContentProps as any)}\n            />\n\n            {media}\n            {hashtagBar}\n\n            {status.get('quote') && (\n              <QuotedStatus quote={status.get('quote')} />\n            )}\n          </>\n        )}\n\n        <div className='detailed-status__meta'>\n          <div className='detailed-status__meta__line'>\n            <a\n              className='detailed-status__datetime'\n              href={`/@${status.getIn(['account', 'acct'])}/${status.get('id')}`}\n              target='_blank'\n              rel='noopener noreferrer'\n            >\n              <FormattedDateWrapper\n                value={new Date(status.get('created_at') as string)}\n                year='numeric'\n                month='short'\n                day='2-digit'\n                hour='2-digit'\n                minute='2-digit'\n              />\n            </a>\n\n            {visibilityLink}\n            {applicationLink}\n          </div>\n\n          {status.get('edited_at') && (\n            <div className='detailed-status__meta__line'>\n              <EditedTimestamp\n                statusId={status.get('id')}\n                timestamp={status.get('edited_at')}\n              />\n            </div>\n          )}\n\n          <div className='detailed-status__meta__line'>\n            {reblogLink}\n            {reblogLink && <>·</>}\n            {favouriteLink}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n"],"names":["EditedTimestamp","statusId","timestamp","dispatch","useAppDispatch","items","useAppSelector","state","history","getIn","toArray","loading","handleOpen","useCallback","fetchHistory","handleItemClick","_item","index","openModal","modalType","modalProps","renderHeader","jsxDEV","FormattedMessage","count","length","this","renderItem","item","onClick","onKeyUp","formattedDate","RelativeTimestamp","get","formattedName","InlineAccount","label","name","date","Dropdown","FormattedDateWrapper","DetailedStatus","status","onOpenMedia","onOpenVideo","onTranslate","measureHeight","onHeightChange","domain","showMedia","withLogo","overrideDisplayName","pictureInPicture","onToggleMediaVisibility","onToggleHidden","properStatus","height","setHeight","useState","showDespiteFilter","setShowDespiteFilter","nodeRef","useRef","handleOpenVideo","options","lang","handleFilterToggle","handleExpandedToggle","_measureHeight","heightJustChanged","current","scheduleIdleTask","Math","ceil","scrollHeight","handleRef","c","handleTranslate","media","applicationLink","reblogLink","attachmentAspectRatio","size","outerStyle","boxSizing","language","PictureInPicturePlaceholder","includes","MediaGallery","attachment","description","Audio","Video","Card","Fragment","visibilityLink","VisibilityIcon","Link","AnimatedNumber","favouriteLink","statusContentProps","hashtagBar","getHashtagBarForStatus","matchedFilters","expanded","classNames","Icon","AlternateEmailIcon","Avatar","DisplayName","IconLogo","FilterWarning","join","ContentWarning","StatusContent","QuotedStatus","Date"],"mappings":"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"}