{"version":3,"file":"notifications-CXGd1tL2.js","sources":["../../app/javascript/mastodon/hooks/useLinks.ts","../../app/javascript/mastodon/features/account_timeline/hooks/familiar_followers.ts","../../app/javascript/material-icons/400-24px/notifications.svg?react"],"sourcesContent":["import { useCallback } from 'react';\n\nimport { useHistory } from 'react-router-dom';\n\nimport { isFulfilled, isRejected } from '@reduxjs/toolkit';\n\nimport { openURL } from 'mastodon/actions/search';\nimport { useAppDispatch } from 'mastodon/store';\n\nconst isMentionClick = (element: HTMLAnchorElement) =>\n  element.classList.contains('mention');\n\nconst isHashtagClick = (element: HTMLAnchorElement) =>\n  element.textContent?.[0] === '#' ||\n  element.previousSibling?.textContent?.endsWith('#');\n\nexport const useLinks = () => {\n  const history = useHistory();\n  const dispatch = useAppDispatch();\n\n  const handleHashtagClick = useCallback(\n    (element: HTMLAnchorElement) => {\n      const { textContent } = element;\n\n      if (!textContent) return;\n\n      history.push(`/tags/${textContent.replace(/^#/, '')}`);\n    },\n    [history],\n  );\n\n  const handleMentionClick = useCallback(\n    async (element: HTMLAnchorElement) => {\n      const result = await dispatch(openURL({ url: element.href }));\n\n      if (isFulfilled(result)) {\n        if (result.payload.accounts[0]) {\n          history.push(`/@${result.payload.accounts[0].acct}`);\n        } else if (result.payload.statuses[0]) {\n          history.push(\n            `/@${result.payload.statuses[0].account.acct}/${result.payload.statuses[0].id}`,\n          );\n        } else {\n          window.location.href = element.href;\n        }\n      } else if (isRejected(result)) {\n        window.location.href = element.href;\n      }\n    },\n    [dispatch, history],\n  );\n\n  const handleClick = useCallback(\n    (e: React.MouseEvent) => {\n      const target = (e.target as HTMLElement).closest('a');\n\n      if (!target || e.button !== 0 || e.ctrlKey || e.metaKey) {\n        return;\n      }\n\n      if (isMentionClick(target)) {\n        e.preventDefault();\n        void handleMentionClick(target);\n      } else if (isHashtagClick(target)) {\n        e.preventDefault();\n        handleHashtagClick(target);\n      }\n    },\n    [handleMentionClick, handleHashtagClick],\n  );\n\n  return handleClick;\n};\n","import { useEffect } from 'react';\n\nimport { fetchAccountsFamiliarFollowers } from '@/mastodon/actions/accounts_familiar_followers';\nimport { useIdentity } from '@/mastodon/identity_context';\nimport { getAccountFamiliarFollowers } from '@/mastodon/selectors/accounts';\nimport { useAppDispatch, useAppSelector } from '@/mastodon/store';\nimport { me } from 'mastodon/initial_state';\n\nexport const useFetchFamiliarFollowers = ({\n  accountId,\n}: {\n  accountId?: string;\n}) => {\n  const dispatch = useAppDispatch();\n  const familiarFollowers = useAppSelector((state) =>\n    accountId ? getAccountFamiliarFollowers(state, accountId) : null,\n  );\n  const { signedIn } = useIdentity();\n\n  const hasNoData = familiarFollowers === null;\n\n  useEffect(() => {\n    if (hasNoData && signedIn && accountId && accountId !== me) {\n      void dispatch(fetchAccountsFamiliarFollowers({ id: accountId }));\n    }\n  }, [dispatch, accountId, hasNoData, signedIn]);\n\n  return {\n    familiarFollowers: hasNoData ? [] : familiarFollowers,\n    isLoading: hasNoData,\n  };\n};\n","import * as React from \"react\";\nconst SvgNotifications = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", height: 24, viewBox: \"0 -960 960 960\", width: 24, ...props }, /* @__PURE__ */ React.createElement(\"path\", { d: \"M160-200v-80h80v-280q0-83 50-147.5T420-792v-28q0-25 17.5-42.5T480-880q25 0 42.5 17.5T540-820v28q80 20 130 84.5T720-560v280h80v80H160Zm320-300Zm0 420q-33 0-56.5-23.5T400-160h160q0 33-23.5 56.5T480-80ZM320-280h320v-280q0-66-47-113t-113-47q-66 0-113 47t-47 113v280Z\" }));\nexport default SvgNotifications;\n"],"names":["isMentionClick","element","classList","contains","isHashtagClick","textContent","previousSibling","endsWith","useLinks","history","useHistory","dispatch","useAppDispatch","handleHashtagClick","useCallback","push","replace","handleMentionClick","result","openURL","url","href","isFulfilled","payload","accounts","acct","statuses","account","id","window","location","isRejected","e","target","closest","button","ctrlKey","metaKey","preventDefault","useFetchFamiliarFollowers","accountId","familiarFollowers","useAppSelector","state","getAccountFamiliarFollowers","signedIn","useIdentity","hasNoData","useEffect","me","fetchAccountsFamiliarFollowers","isLoading","SvgNotifications","props","React.createElement"],"mappings":"6RASA,MAAMA,EAAkBC,GACtBA,EAAQC,UAAUC,SAAS,SAAS,EAEhCC,EAAkBH,cACtBA,QAAAA,EAAAA,EAAQI,cAARJ,YAAAA,EAAsB,MAAO,OAC7BA,GAAAA,EAAAA,EAAQK,kBAARL,YAAAA,EAAyBI,cAAzBJ,YAAAA,EAAsCM,SAAS,OAEpCC,EAAWA,IAAM,CAC5B,MAAMC,EAAUC,EAAAA,EACVC,EAAWC,EAAAA,EAEXC,EAAqBC,cACxBb,GAA+B,CAC9B,KAAM,CAAEI,YAAAA,CAAAA,EAAgBJ,EAEnBI,GAELI,EAAQM,KAAK,SAASV,EAAYW,QAAQ,KAAM,EAAE,CAAC,EAAE,CAAA,EAEvD,CAACP,CAAO,CACV,EAEMQ,EAAqBH,cACzB,MAAOb,GAA+B,CACpC,MAAMiB,EAAS,MAAMP,EAASQ,EAAQ,CAAEC,IAAKnB,EAAQoB,IAAAA,CAAM,CAAC,EAExDC,EAAYJ,CAAM,EAChBA,EAAOK,QAAQC,SAAS,CAAC,EAC3Bf,EAAQM,KAAK,KAAKG,EAAOK,QAAQC,SAAS,CAAC,EAAEC,IAAI,EAAE,EAC1CP,EAAOK,QAAQG,SAAS,CAAC,EAClCjB,EAAQM,KACN,KAAKG,EAAOK,QAAQG,SAAS,CAAC,EAAEC,QAAQF,IAAI,IAAIP,EAAOK,QAAQG,SAAS,CAAC,EAAEE,EAAE,EAC/E,EAEAC,OAAOC,SAAST,KAAOpB,EAAQoB,KAExBU,EAAWb,CAAM,IAC1BW,OAAOC,SAAST,KAAOpB,EAAQoB,KACjC,EAEF,CAACV,EAAUF,CAAO,CACpB,EAqBA,OAnBoBK,cACjBkB,GAAwB,CACvB,MAAMC,EAAUD,EAAEC,OAAuBC,QAAQ,GAAG,EAEhD,CAACD,GAAUD,EAAEG,SAAW,GAAKH,EAAEI,SAAWJ,EAAEK,UAI5CrC,EAAeiC,CAAM,GACvBD,EAAEM,eAAAA,EACGrB,EAAmBgB,CAAM,GACrB7B,EAAe6B,CAAM,IAC9BD,EAAEM,eAAAA,EACFzB,EAAmBoB,CAAM,GAC3B,EAEF,CAAChB,EAAoBJ,CAAkB,CACzC,CAGF,EChEa0B,EAA4BA,CAAC,CACxCC,UAAAA,CAGF,IAAM,CACJ,MAAM7B,EAAWC,EAAAA,EACX6B,EAAoBC,EAAgBC,GACxCH,EAAYI,EAA4BD,EAAOH,CAAS,EAAI,IAC9D,EACM,CAAEK,SAAAA,CAAAA,EAAaC,EAAAA,EAEfC,EAAYN,IAAsB,KAExCO,OAAAA,EAAAA,UAAU,IAAM,CACVD,GAAaF,GAAYL,GAAaA,IAAcS,GACjDtC,EAASuC,EAA+B,CAAEtB,GAAIY,CAAAA,CAAW,CAAC,CACjE,EACC,CAAC7B,EAAU6B,EAAWO,EAAWF,CAAQ,CAAC,EAEtC,CACLJ,kBAAmBM,EAAY,CAAA,EAAKN,EACpCU,UAAWJ,CAAAA,CAEf,EC9BMK,EAAoBC,GAA0BC,gBAAoB,MAAO,CAAE,MAAO,6BAA8B,OAAQ,GAAI,QAAS,iBAAkB,MAAO,GAAI,GAAGD,CAAK,EAAoBC,EAAAA,cAAoB,OAAQ,CAAE,EAAG,yQAA0Q,CAAC"}