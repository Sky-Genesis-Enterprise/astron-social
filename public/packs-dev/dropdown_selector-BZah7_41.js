import{j as o}from"./client-BG6VvM0b.js";import{r as a}from"./index-ykyyQSL-.js";import{c as A}from"./index-guCj-HqV.js";import{S as L}from"./info-C9UTTy-Y.js";import{I as V,bT as R}from"./useSelectableClick-DBo53LOf.js";const C=R?{passive:!0,capture:!0}:!0,M=({style:B,items:d,value:I,classNamePrefix:i="privacy-dropdown",onClose:r,onChange:f})=>{const t=a.useRef(null),v=a.useRef(null),[m,b]=a.useState(I),s=a.useCallback(e=>{t.current&&e.target instanceof Node&&!t.current.contains(e.target)&&(r(),e.stopPropagation())},[t,r]),p=a.useCallback(e=>{const c=e.currentTarget.getAttribute("data-index");e.preventDefault(),r(),c&&f(c)},[r,f]),y=a.useCallback(e=>{var h,x,N,E,_,g,j,D,k,w;const c=e.currentTarget.getAttribute("data-index"),u=d.findIndex(l=>l.value===c);let n=null;switch(e.key){case"Escape":r();break;case" ":case"Enter":p(e);break;case"ArrowDown":n=((h=t.current)==null?void 0:h.children[u+1])??((x=t.current)==null?void 0:x.firstElementChild);break;case"ArrowUp":n=((N=t.current)==null?void 0:N.children[u-1])??((E=t.current)==null?void 0:E.lastElementChild);break;case"Tab":e.shiftKey?n=((_=t.current)==null?void 0:_.children[u+1])??((g=t.current)==null?void 0:g.firstElementChild):n=((j=t.current)==null?void 0:j.children[u-1])??((D=t.current)==null?void 0:D.lastElementChild);break;case"Home":n=(k=t.current)==null?void 0:k.firstElementChild;break;case"End":n=(w=t.current)==null?void 0:w.lastElementChild;break}if(n&&n instanceof HTMLElement){const l=n.getAttribute("data-index");n.focus(),l&&b(l),e.preventDefault(),e.stopPropagation()}},[t,d,r,p,b]);return a.useEffect(()=>{var e;return document.addEventListener("click",s,{capture:!0}),document.addEventListener("touchend",s,C),(e=v.current)==null||e.focus({preventScroll:!0}),()=>{document.removeEventListener("click",s,{capture:!0}),document.removeEventListener("touchend",s,C)}},[s]),o.jsxDEV("ul",{style:B,role:"listbox",ref:t,children:d.map(e=>o.jsxDEV("li",{role:"option",tabIndex:0,"data-index":e.value,onKeyDown:y,onClick:p,className:A(`${i}__option`,{active:e.value===m}),"aria-selected":e.value===m,ref:e.value===m?v:null,children:[e.icon&&e.iconComponent&&o.jsxDEV("div",{className:`${i}__option__icon`,children:o.jsxDEV(V,{id:e.icon,icon:e.iconComponent},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/dropdown_selector.tsx",lineNumber:164,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/dropdown_selector.tsx",lineNumber:163,columnNumber:9},void 0),o.jsxDEV("div",{className:`${i}__option__content`,children:[o.jsxDEV("strong",{children:e.text},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/dropdown_selector.tsx",lineNumber:169,columnNumber:13},void 0),e.meta]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/dropdown_selector.tsx",lineNumber:168,columnNumber:11},void 0),e.extra&&o.jsxDEV("div",{className:`${i}__option__additional`,title:e.extra,children:o.jsxDEV(V,{id:"info-circle",icon:L},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/dropdown_selector.tsx",lineNumber:178,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/dropdown_selector.tsx",lineNumber:174,columnNumber:9},void 0)]},e.value,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/dropdown_selector.tsx",lineNumber:149,columnNumber:7},void 0))},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/components/dropdown_selector.tsx",lineNumber:147,columnNumber:5},void 0)};export{M as D};
//# sourceMappingURL=dropdown_selector-BZah7_41.js.map
