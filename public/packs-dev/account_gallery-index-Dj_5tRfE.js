import{j as a}from"./client-BG6VvM0b.js";import{r as m}from"./index-ykyyQSL-.js";import{a as x,b4 as $,I as M,bZ as F,u as G,an as O,bX as L,dj as A,o as T}from"./useSelectableClick-DBo53LOf.js";import{C as U,A as z,L as K}from"./limited_account_hint-BLPLzyiK.js";import{R as q}from"./remote_hint-eP09Z2A-.js";import{S as R}from"./scrollable_list-DlG-2WSw.js";import{B as Z}from"./bundle_column_error-BUenPHpF.js";import{C as X}from"./column-u9iYs8RL.js";import{u as Y,a as J}from"./useAccountVisibility-tDQjOCzw.js";import{c as C}from"./index-guCj-HqV.js";import{S as Q}from"./visibility_off-DWOPSbpr.js";import{A as W}from"./alt_text_badge-C63PD6vv.js";import{y as k,z as ee,l as ae}from"./initial_state-BP3UcUr4.js";import{M as w}from"./message-Bb0z64dP.js";import"./short_number--sxn3OKQ.js";import"./numbers-CGZQWBYL.js";import"./api-uqk9CYtW.js";import"./index-lj9VQs0f.js";import"./ready-DpOgoWSg.js";import"./index-DHslUCy5.js";import"./load_locale-C-B7BkCQ.js";import"./column_header-CtuyYpNB.js";import"./add-ZanakRnh.js";import"./chevron_left-R_fqLHXp.js";import"./close-DPVxbBbs.js";import"./Helmet-D0DLVOv1.js";import"./content_warning-ZcoJE_cd.js";import"./skeleton-_5CK2hDo.js";import"./notifications-CXGd1tL2.js";import"./notifications_active-fill-CAsA_fEC.js";import"./domain_blocks-DiDVA5xw.js";import"./reports-BY0N2xif.js";import"./group-D_XsjWSa.js";import"./person-BiDPmDpQ.js";import"./index-JeRepxZU.js";import"./content_copy-BTldXt3w.js";import"./counters-BuwkZXvq.js";import"./follow_button-DdHXSblv.js";import"./loading_indicator-BBuNQ1GS.js";import"./formatted_date-kPcGS90C.js";import"./react-textarea-autosize.browser.development.esm-B_jXmAxZ.js";import"./use-isomorphic-layout-effect.browser.esm-Bg5tPKmX.js";import"./permissions-Djze7cmB.js";import"./avatar_group-CaQvETuJ.js";import"./avatar_overlay-XCWEKsBg.js";import"./timeline_hint-5iOue1yn.js";import"./scroll_container-BQpJ36fQ.js";import"./react-router-scroll-4.es-6ieDtVAa.js";import"./interopRequireDefault-CdiRfGvq.js";import"./schedule_idle_task-CTsEu-tt.js";import"./load_more-BJ-OkDO5.js";import"./column-CXD4Tnpb.js";import"./scroll-BygYx8ga.js";import"./gif-CQLWVfmH.js";const ie=i=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:24,viewBox:"0 -960 960 960",width:24,...i},m.createElement("path",{d:"M360-120H200q-33 0-56.5-23.5T120-200v-280q0-75 28.5-140.5t77-114q48.5-48.5 114-77T480-840q75 0 140.5 28.5t114 77q48.5 48.5 77 114T840-480v280q0 33-23.5 56.5T760-120H600v-320h160v-40q0-117-81.5-198.5T480-760q-117 0-198.5 81.5T200-480v40h160v320Z"})),te=i=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:24,viewBox:"0 -960 960 960",width:24,...i},m.createElement("path",{d:"m160-800 80 160h120l-80-160h80l80 160h120l-80-160h80l80 160h120l-80-160h120q33 0 56.5 23.5T880-720v480q0 33-23.5 56.5T800-160H160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800Z"})),oe=({attachment:i,onOpenMedia:s})=>{const e=x(o=>o.accounts.get(i.getIn(["status","account"]))),[n,u]=m.useState(k!=="hide_all"&&!i.getIn(["status","sensitive"])||k==="show_all"),[f,B]=m.useState(!1),[j,g]=m.useState(!1),p=m.useCallback(()=>{B(!0)},[B]),b=m.useCallback(()=>{g(!0)},[g]),_=m.useCallback(o=>{o.target instanceof HTMLVideoElement&&o.target.play()},[]),D=m.useCallback(o=>{o.target instanceof HTMLVideoElement&&(o.target.pause(),o.target.currentTime=0)},[]),V=m.useCallback(o=>{o.button===0&&!(o.ctrlKey||o.metaKey)&&(o.preventDefault(),n?s(i):u(!0))},[i,n,s,u]),l=i.get("status"),r=i.getIn(["translation","description"])||i.get("description"),v=i.get("preview_url"),t=i.get("url"),h=e==null?void 0:e.avatar_static,d=l.get("language"),E=i.get("blurhash"),I=l.get("id"),c=i.get("type");let N;const y=[];if(r&&r.length>0&&y.push(a.jsxDEV(W,{description:r},"alt",!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/components/media_item.tsx",lineNumber:89,columnNumber:17},void 0)),!n)N=a.jsxDEV("div",{className:"media-gallery__item__overlay",children:a.jsxDEV(M,{id:"eye-slash",icon:Q},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/components/media_item.tsx",lineNumber:95,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/components/media_item.tsx",lineNumber:94,columnNumber:5},void 0);else if(c==="audio")N=a.jsxDEV(a.Fragment,{children:[a.jsxDEV("img",{src:v||h,alt:r,lang:d,onLoad:p,onError:b},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/components/media_item.tsx",lineNumber:101,columnNumber:9},void 0),a.jsxDEV("div",{className:"media-gallery__item__overlay media-gallery__item__overlay--corner",children:a.jsxDEV(M,{id:"music",icon:ie},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/components/media_item.tsx",lineNumber:110,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/components/media_item.tsx",lineNumber:109,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/components/media_item.tsx",lineNumber:100,columnNumber:5},void 0);else if(c==="image"){const o=i.getIn(["meta","focus","x"])||0,S=i.getIn(["meta","focus","y"])||0,P=(o/2+.5)*100,H=(S/-2+.5)*100;N=a.jsxDEV("img",{src:v,alt:r,lang:d,style:{objectPosition:`${P}% ${H}%`},onLoad:p,onError:b},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/components/media_item.tsx",lineNumber:121,columnNumber:5},void 0)}else if(["video","gifv"].includes(c)){const o=i.getIn(["meta","original","duration"]);N=a.jsxDEV("div",{className:"media-gallery__gifv",children:[a.jsxDEV("video",{className:"media-gallery__item-gifv-thumbnail","aria-label":r,lang:d,src:t,onMouseEnter:_,onMouseLeave:D,onLoadedData:p,autoPlay:ae,playsInline:!0,loop:!0,muted:!0},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/components/media_item.tsx",lineNumber:139,columnNumber:9},void 0),c==="video"&&a.jsxDEV("div",{className:"media-gallery__item__overlay media-gallery__item__overlay--corner",children:a.jsxDEV(M,{id:"play",icon:te},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/components/media_item.tsx",lineNumber:155,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/components/media_item.tsx",lineNumber:154,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/components/media_item.tsx",lineNumber:138,columnNumber:5},void 0),c==="gifv"?y.push(a.jsxDEV("span",{className:"media-gallery__alt__label media-gallery__alt__label--non-interactive",children:"GIF"},"gif",!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/components/media_item.tsx",lineNumber:163,columnNumber:9},void 0)):y.push(a.jsxDEV("span",{className:"media-gallery__alt__label media-gallery__alt__label--non-interactive",children:F(Math.floor(o))},"video",!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/components/media_item.tsx",lineNumber:172,columnNumber:9},void 0))}return a.jsxDEV("div",{className:C("media-gallery__item media-gallery__item--square",{"media-gallery__item--error":j}),children:[a.jsxDEV($,{hash:E,className:C("media-gallery__preview",{"media-gallery__preview--hidden":n&&f}),dummy:!ee},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/components/media_item.tsx",lineNumber:188,columnNumber:7},void 0),a.jsxDEV("a",{className:"media-gallery__item-thumbnail",href:`/@${e==null?void 0:e.acct}/${I}`,onClick:V,target:"_blank",rel:"noopener noreferrer",children:N},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/components/media_item.tsx",lineNumber:196,columnNumber:7},void 0),y.length>0&&a.jsxDEV("div",{className:"media-gallery__item__badges",children:y},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/components/media_item.tsx",lineNumber:207,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/components/media_item.tsx",lineNumber:183,columnNumber:5},void 0)},se=O([(i,s)=>i.timelines.getIn([`account:${s}:media`,"items"],L()),i=>i.statuses],(i,s)=>{let e=L();return i.forEach(n=>{const u=s.get(n);u&&(e=e.concat(u.get("media_attachments").map(f=>f.set("status",u))))}),e}),ma=({multiColumn:i})=>{var v;const s=G(),e=Y(),n=x(t=>e?se(t,e):L()),u=x(t=>t.timelines.getIn([`account:${e}:media`,"isLoading"])),f=x(t=>t.timelines.getIn([`account:${e}:media`,"hasMore"])),j=!!x(t=>e?t.accounts.get(e):void 0),{suspended:g,blockedBy:p,hidden:b}=J(e),_=(v=n.last())==null?void 0:v.getIn(["status","id"]);m.useEffect(()=>{e&&j&&s(A(e))},[s,e,j]);const D=m.useCallback(()=>{_&&s(A(e,{maxId:_}))},[s,e,_]),V=m.useCallback(t=>{const h=t.getIn(["status","id"]),d=t.getIn(["status","language"]);if(t.get("type")==="video")s(T({modalType:"VIDEO",modalProps:{media:t,statusId:h,lang:d,options:{autoPlay:!0}}}));else if(t.get("type")==="audio")s(T({modalType:"AUDIO",modalProps:{media:t,statusId:h,lang:d,options:{autoPlay:!0}}}));else{const E=t.getIn(["status","media_attachments"]),I=E.findIndex(c=>c.get("id")===t.get("id"));s(T({modalType:"MEDIA",modalProps:{media:E,index:I,statusId:h,lang:d}}))}},[s]);if(e===null)return a.jsxDEV(Z,{multiColumn:i,errorType:"routing"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/index.tsx",lineNumber:151,columnNumber:12},void 0);let l;e&&(g?l=a.jsxDEV(w,{id:"empty_column.account_suspended",defaultMessage:"Account suspended"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/index.tsx",lineNumber:159,columnNumber:7},void 0):b?l=a.jsxDEV(K,{accountId:e},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/index.tsx",lineNumber:165,columnNumber:22},void 0):p?l=a.jsxDEV(w,{id:"empty_column.account_unavailable",defaultMessage:"Profile unavailable"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/index.tsx",lineNumber:168,columnNumber:7},void 0):n.isEmpty()?l=a.jsxDEV(q,{accountId:e},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/index.tsx",lineNumber:174,columnNumber:22},void 0):l=a.jsxDEV(w,{id:"empty_column.account_timeline",defaultMessage:"No posts found"},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/index.tsx",lineNumber:177,columnNumber:7},void 0));const r=g||p||b;return a.jsxDEV(X,{children:[a.jsxDEV(U,{},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/index.tsx",lineNumber:189,columnNumber:7},void 0),a.jsxDEV(R,{className:"account-gallery__container",prepend:e&&a.jsxDEV(z,{accountId:e,hideTabs:r},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/index.tsx",lineNumber:195,columnNumber:9},void 0),alwaysPrepend:!0,append:e&&a.jsxDEV(q,{accountId:e},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/index.tsx",lineNumber:199,columnNumber:30},void 0),scrollKey:"account_gallery",isLoading:u,hasMore:!r&&f,onLoadMore:D,emptyMessage:l,bindToDocument:!i,children:n.map(t=>a.jsxDEV(oe,{attachment:t,onOpenMedia:V},t.get("id"),!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/index.tsx",lineNumber:208,columnNumber:9},void 0))},void 0,!1,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/index.tsx",lineNumber:191,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/liam-esia/Bureau/github/mastodon/app/javascript/mastodon/features/account_gallery/index.tsx",lineNumber:188,columnNumber:5},void 0)};export{ma as AccountGallery,ma as default};
//# sourceMappingURL=account_gallery-index-Dj_5tRfE.js.map
