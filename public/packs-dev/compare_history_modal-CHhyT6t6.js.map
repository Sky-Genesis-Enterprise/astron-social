{"version":3,"file":"compare_history_modal-CHhyT6t6.js","sources":["../../app/javascript/mastodon/features/ui/components/compare_history_modal.jsx"],"sourcesContent":["import PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\n\nimport { FormattedMessage } from 'react-intl';\n\nimport ImmutablePropTypes from 'react-immutable-proptypes';\nimport { connect } from 'react-redux';\n\nimport escapeTextContentForBrowser from 'escape-html';\n\nimport CloseIcon from '@/material-icons/400-24px/close.svg?react';\nimport { closeModal } from 'mastodon/actions/modal';\nimport { IconButton } from 'mastodon/components/icon_button';\nimport InlineAccount from 'mastodon/components/inline_account';\nimport MediaAttachments from 'mastodon/components/media_attachments';\nimport { RelativeTimestamp } from 'mastodon/components/relative_timestamp';\nimport emojify from 'mastodon/features/emoji/emoji';\n\nconst mapStateToProps = (state, { statusId }) => ({\n  language: state.getIn(['statuses', statusId, 'language']),\n  versions: state.getIn(['history', statusId, 'items']),\n});\n\nconst mapDispatchToProps = dispatch => ({\n\n  onClose() {\n    dispatch(closeModal({\n      modalType: undefined,\n      ignoreFocus: false,\n    }));\n  },\n\n});\n\nclass CompareHistoryModal extends PureComponent {\n\n  static propTypes = {\n    onClose: PropTypes.func.isRequired,\n    index: PropTypes.number.isRequired,\n    statusId: PropTypes.string.isRequired,\n    language: PropTypes.string.isRequired,\n    versions: ImmutablePropTypes.list.isRequired,\n  };\n\n  render () {\n    const { index, versions, language, onClose } = this.props;\n    const currentVersion = versions.get(index);\n\n    const emojiMap = currentVersion.get('emojis').reduce((obj, emoji) => {\n      obj[`:${emoji.get('shortcode')}:`] = emoji.toJS();\n      return obj;\n    }, {});\n\n    const content = { __html: emojify(currentVersion.get('content'), emojiMap) };\n    const spoilerContent = { __html: emojify(escapeTextContentForBrowser(currentVersion.get('spoiler_text')), emojiMap) };\n\n    const formattedDate = <RelativeTimestamp timestamp={currentVersion.get('created_at')} short={false} />;\n    const formattedName = <InlineAccount accountId={currentVersion.get('account')} />;\n\n    const label = currentVersion.get('original') ? (\n      <FormattedMessage id='status.history.created' defaultMessage='{name} created {date}' values={{ name: formattedName, date: formattedDate }} />\n    ) : (\n      <FormattedMessage id='status.history.edited' defaultMessage='{name} edited {date}' values={{ name: formattedName, date: formattedDate }} />\n    );\n\n    return (\n      <div className='modal-root__modal compare-history-modal'>\n        <div className='report-modal__target'>\n          <IconButton className='report-modal__close' icon='times' iconComponent={CloseIcon} onClick={onClose} size={20} />\n          {label}\n        </div>\n\n        <div className='compare-history-modal__container'>\n          <div className='status__content'>\n            {currentVersion.get('spoiler_text').length > 0 && (\n              <>\n                <div className='translate' dangerouslySetInnerHTML={spoilerContent} lang={language} />\n                <hr />\n              </>\n            )}\n\n            <div className='status__content__text status__content__text--visible translate' dangerouslySetInnerHTML={content} lang={language} />\n\n            {!!currentVersion.get('poll') && (\n              <div className='poll'>\n                <ul>\n                  {currentVersion.getIn(['poll', 'options']).map(option => (\n                    <li key={option.get('title')}>\n                      <span className='poll__input disabled' />\n\n                      <span\n                        className='poll__option__text translate'\n                        dangerouslySetInnerHTML={{ __html: emojify(escapeTextContentForBrowser(option.get('title')), emojiMap) }}\n                        lang={language}\n                      />\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            )}\n\n            <MediaAttachments status={currentVersion} lang={language} />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CompareHistoryModal);\n"],"names":["mapStateToProps","state","statusId","language","getIn","versions","mapDispatchToProps","dispatch","onClose","closeModal","modalType","undefined","ignoreFocus","CompareHistoryModal","PureComponent","render","index","props","currentVersion","get","emojiMap","reduce","obj","emoji","toJS","content","__html","emojify","spoilerContent","escapeTextContentForBrowser","formattedDate","RelativeTimestamp","formattedName","jsxDEV","InlineAccount","label","FormattedMessage","name","date","IconButton","CloseIcon","length","Fragment","map","option","MediaAttachments","compare_history_modal","connect"],"mappings":"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"}